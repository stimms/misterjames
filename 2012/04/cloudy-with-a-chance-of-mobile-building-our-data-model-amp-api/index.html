<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Cloudy With a Chance of Mobile: Building Our Data Model &amp; API | They Call Me Mister James</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Interested in having a web site that supports user-specific data? Perfect, use Asp.Net and the built in membership providers. Want to put it in the cloud? Sweet, jump on the Azure bandwagon. Want to e">
<meta property="og:type" content="article">
<meta property="og:title" content="Cloudy With a Chance of Mobile: Building Our Data Model & API">
<meta property="og:url" content="http://jameschambers.com/2012/04/cloudy-with-a-chance-of-mobile-building-our-data-model-amp-api/index.html">
<meta property="og:site_name" content="They Call Me Mister James">
<meta property="og:description" content="Interested in having a web site that supports user-specific data? Perfect, use Asp.Net and the built in membership providers. Want to put it in the cloud? Sweet, jump on the Azure bandwagon. Want to e">
<meta property="og:image" content="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/wlEmoticon-winkingsmile_2.png">
<meta property="og:image" content="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_3.png">
<meta property="og:image" content="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_6.png">
<meta property="og:image" content="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_9.png">
<meta property="og:image" content="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_thumb_3.png">
<meta property="og:image" content="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_thumb_4.png">
<meta property="og:image" content="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_thumb_5.png">
<meta property="og:image" content="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_18.png">
<meta property="og:image" content="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/wlEmoticon-winkingsmile_2.png">
<meta property="og:updated_time" content="2016-01-20T03:26:04.583Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cloudy With a Chance of Mobile: Building Our Data Model & API">
<meta name="twitter:description" content="Interested in having a web site that supports user-specific data? Perfect, use Asp.Net and the built in membership providers. Want to put it in the cloud? Sweet, jump on the Azure bandwagon. Want to e">
<meta name="twitter:creator" content="@CanadianJames">
<meta name="twitter:site" content="CanadianJames">
  
  
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="content/avatar.png">
  
  
 <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
 <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>


  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" type="text/css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-2868185-6', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  

  
  <script src="//load.sumome.com/" data-sumo-site-id="34f480920bcf5ea13ec1605be65d32e86be89fb7177416fb68c2d2f1939aaa04" async="async"></script>
</head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo" style="background-image: url(/content/logo_round.png)"></i><span class="site-title">They Call Me Mister James</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/.">Home</a>
        
          <a class="main-nav-link" href="/about/bootstrapping-mvc.html">Boostrapping MVC</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">Testimonials</a>
        
          <a class="main-nav-link" href="/about/genfu.html">GenFu</a>
        
        <a class="main-nav-link main-nav-link-highlight" href="https://hireme.jameschambers.com" target="_blank">Hire Me</a>
      </nav>
      
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/content/avatar.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
      
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="http://jameschambers.com"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
        
          <td><a class="main-nav-link" href="/.">Home</a></td>
        
          <td><a class="main-nav-link" href="/about/bootstrapping-mvc.html">Boostrapping MVC</a></td>
        
          <td><a class="main-nav-link" href="/archives">Archives</a></td>
        
          <td><a class="main-nav-link" href="/about">Testimonials</a></td>
        
          <td><a class="main-nav-link" href="/about/genfu.html">GenFu</a></td>
        
        <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://jameschambers.com"></form>
        </td>
      </tr>
    </table>
  </div>
</header>

    <div class="outer">
      
        <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <h2 id="name">James Chambers</h2>
      <h3 id="title">Husband, Father, Mentor, Humanitarian &amp; Software Developer</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Canada</span>
      <a id="follow" href="https://twitter.com/canadianjames">FOLLOW</a>
    </div>

    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
          <td><a href="/CanadianJames" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></td>
          
          <td><a href="http://github.com/MisterJames" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
          
          <td><a href="/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
          
          <td><a href="https://ca.linkedin.com/in/canadianjames" target="_blank" title="linkedin"><i class="fa fa-linkedin"></i></a></td>
          
          <td><a href="https://www.youtube.com/user/CodingMisterJames/" target="_blank" title="youtube"><i class="fa fa-youtube"></i></a></td>
          
        </tr>
      </table>
    </div>
    

    <div class="base-info profile-block">
        <a href="http://aspnetmonsters.com" target="_blank"><img src="/content/monster-james.png"></a>      
    </div>

    <div class="base-info profile-block">
        <a href="https://leanpub.com/bootstrappingmvc" onclick="_gaq.push(['_trackEvent', 'outbound-widget', 'https://leanpub.com/bootstrappingmvc', '\n\n']);">
            <img src="https://s3.amazonaws.com/titlepages.leanpub.com/bootstrappingmvc/medium?1425560219" scale="0">
        </a>
    </div>
        
    
  </div>
</aside>

      
      <section id="main"><article id="post-cloudy-with-a-chance-of-mobile-building-our-data-model-amp-api" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Cloudy With a Chance of Mobile: Building Our Data Model &amp; API
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2012/04/cloudy-with-a-chance-of-mobile-building-our-data-model-amp-api/">
      <time datetime="2012-04-20T22:53:00.000Z" itemprop="datePublished">2012-04-20</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <blockquote>
<p>Interested in having a web site that supports user-specific data? Perfect, use Asp.Net and the built in membership providers. Want to put it in the cloud? Sweet, jump on the Azure bandwagon. Want to easily define your data model and store it? No worries, EF Code First will make you cry, you love it so much. Want to access that data from Windows Phone? Well, my friend, you’ve come to the right place. If you want to follow along from the beginning, please check out the <a href="http://oldblog.jameschambers.com/blog/cloudy-with-a-chance-of-mobile-mvc-framework-windows-azure-and-windows-phone" target="_blank" rel="external">first post in the series</a>. </p>
</blockquote>
<p><span style="color: #666666" color="#666666">With my projects roughly set up the way I’d like them to be I can now start building my data model using Entity Framework or “EF”.&nbsp; I’ll use the model definition to quickly scaffold some UI and add some data to my project.</span></p>
<p><span style="color: #666666" color="#666666">I will then expose that data via the new Web API available in Mvc 4.&nbsp; Though I have two solutions set up, I’ll only be working in the Mvc 4 project for this tutorial.&nbsp; A reminder that if you’re opening the IDE to follow along after a break you’ll need to open it up in Administrator mode for the Azure environment to run correctly.</span></p>
<h2 id="Our_Data_Class"><a href="#Our_Data_Class" class="headerlink" title="Our Data Class"></a><span style="color: #666666" color="#666666">Our Data Class</span></h2><p><span style="color: #666666" color="#666666">To keep things simple I’m going to use a single entity class – and ultimately a single table – for this exercise.&nbsp; In the Mvc 4 project, use the Solution Explorer to locate and then right-click on the Models folder to add a new class called PhoneNumberEntry.&nbsp; The class will look like the following:</span></p>
<pre class="csharpcode">    <span class="kwrd">public</span> <span class="kwrd">class</span> PhoneNumberEntry
    {
        <span class="kwrd">public</span> <span class="kwrd">int</span> PhoneNumberEntryId { get; set; }
        <span class="kwrd">public</span> <span class="kwrd">string</span> FirstName { get; set; }
        <span class="kwrd">public</span> <span class="kwrd">string</span> LastName { get; set; }
        <span class="kwrd">public</span> <span class="kwrd">string</span> PhoneNumber { get; set; }
        <span class="kwrd">public</span> <span class="kwrd">string</span> UserName { get; set; }
    }</pre>

<p><span style="color: #666666" color="#666666">Hey, don’t judge. I said I was keeping it simple. <img src="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/wlEmoticon-winkingsmile_2.png" alt="Winking smile"></span></p>
<p><span style="color: #666666" color="#666666">Next, I need to tell EF how to create the database, namely, I have to tell it what tables to create and of which entity. I do this through inheritance and attributes on our classes.&nbsp; You can put this definition in the same file as the PhoneNumberEntry class.&nbsp; Again, it’s very light weight.</span></p>
<pre class="csharpcode">    <span class="kwrd">public</span> <span class="kwrd">class</span> ContactContext: DbContext
    {
        <span class="kwrd">public</span> DbSet&lt;PhoneNumberEntry&gt; PhoneNumberEntries { get; set; }
    }</pre>

<p><span style="color: #666666" color="#666666">Perfect, now I’m rolling. To create the UI, I’m simply going to use the tooling that’s built into the MVC Framework through Visual Studio 2010. In order to fully leverage this, I need to compile my classes so that the IDE can reflect on my project and show me a list of them.&nbsp; I like to use the keyboard shortcut Shift + Ctrl + B to build. </span></p>
<h2 id="Building_the_Views"><a href="#Building_the_Views" class="headerlink" title="Building the Views"></a><span style="color: #666666" color="#666666">Building the Views</span></h2><p><span style="color: #666666" color="#666666">With my project compiled, I right-click on the Controllers folder in Project Explorer and select Add –&gt; Controller. I name my controller appropriately, select my PhoneNumberEntry class and name a new Data Context Class.&nbsp; I choose the Controller with read/write actions and views, using Entity Framework as the template.</span></p>
<p><img src="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_3.png" alt="image" title="image"></p>
<p>The tooling builds my controller and scaffolds out my views for me. </p>
<p>I only want members who have registered to create entries, and I want to each user to have their own list. I created a UserName property on my model, so I now need to deal with that field on my own. In my Create and Edit views, I remove the UserName field. Here’s an example of what that HTML looked like before I removed it:</p>
<p><img src="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_6.png" alt="image" title="image"></p>
<p>With that out of the way (in both Create and Edit) I need to update my controller accordingly. I open PhoneNumberEntryController in the Controllers folder and add the Authorize attribute to my class. </p>
<pre class="csharpcode">    [Authorize]
    <span class="kwrd">public</span> <span class="kwrd">class</span> PhoneNumberEntryController : Controller
    {
        <span class="rem">// ...rest of class here</span>
    }</pre>

<p>By attributing the controller in this way (at the class level), I am telling the Asp.Net runtime that any user who accesses any action on this controller needs to be logged in using the authentication scheme of the site.&nbsp; Now, all users who try to navigate to any of my Phone Numbers pages will first be prompted to log in.</p>
<p><img src="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_9.png" alt="image" title="image"></p>
<h2 id="Driven_By_the_Logged_in_User"><a href="#Driven_By_the_Logged_in_User" class="headerlink" title="Driven By the Logged in User"></a>Driven By the Logged in User</h2><p>Next, I want to make sure that the user only ever sees the phone numbers that they create.&nbsp; The index method needs to be adjusted to only return the appropriate entries.</p>
<pre class="csharpcode">    <span class="kwrd">public</span> ActionResult Index()
    {
        <span class="kwrd">string</span> username = User.Identity.Name;

        var phoneNumbers = db.PhoneNumberEntries
            .Where(p =&gt; p.UserName == username)
            .ToList();

        <span class="kwrd">return</span> View(phoneNumbers);
    }</pre>

<p>In the Create and Edit methods decorated with the HttpPost attribute (these are the methods that accept the PhoneNumberEntry parameters from the form) I add a bit of code to capture the user’s login name and store that in the model.</p>
<pre class="csharpcode">    [HttpPost]
    <span class="kwrd">public</span> ActionResult Create(PhoneNumberEntry phonenumberentry)
    {
        <span class="kwrd">string</span> username = User.Identity.Name;
        phonenumberentry.UserName = username;

        <span class="kwrd">if</span> (ModelState.IsValid)
        {
            db.PhoneNumberEntries.Add(phonenumberentry);
            db.SaveChanges();
            <span class="kwrd">return</span> RedirectToAction(<span class="str">"Index"</span>);
        }

        <span class="kwrd">return</span> View(phonenumberentry);
    }</pre>
> **Important note**: There are many more security considerations to take and I am only demonstrating some bare minimums. In a real-world scenario you would use a repository outside of the controller and would do the appropriate checks to protect your data at various levels of your project. Particularly, any code to retrieve or modify the data should have checks in place to ensure the user is authorized to view or modify the resource in question.&nbsp; As an exercise to the reader, work through the PhoneNumberEntryController and firm up the user access/rights to a better degree.

Everything should be set here to capture some data, but I want to be able to easily access these bits of UI.&nbsp; I open up my _Layout.cshtml file, located in Views\Shared in the Solution Explorer and modify the snippet of code that creates the menu elements.&nbsp; When finished, it looks like so:
<pre class="csharpcode">    &lt;nav&gt;
        &lt;ul id=<span class="str">"menu"</span>&gt;
            &lt;li&gt;@Html.ActionLink(<span class="str">"Home"</span>, <span class="str">"Index"</span>, <span class="str">"Home"</span>)&lt;/li&gt;
            &lt;li&gt;@Html.ActionLink(<span class="str">"About"</span>, <span class="str">"About"</span>, <span class="str">"Home"</span>)&lt;/li&gt;
            &lt;li&gt;@Html.ActionLink(<span class="str">"Phone Numbers"</span>, <span class="str">"Index"</span>, <span class="str">"PhoneNumberEntry"</span>)&lt;/li&gt;
            &lt;li&gt;@Html.ActionLink(<span class="str">"Contact"</span>, <span class="str">"Contact"</span>, <span class="str">"Home"</span>)&lt;/li&gt;
        &lt;/ul&gt;
    &lt;/nav&gt;</pre>

<p>The LI elements are formatted through the default site template and the UL is used as a wrapper to generate the menu at the top of the page. The ActionLink helper method renders an anchor tag for the specified controller/action.</p>
<h2 id="Getting_Some_Data_In_There"><a href="#Getting_Some_Data_In_There" class="headerlink" title="Getting Some Data In There"></a>Getting Some Data In There</h2><p>Before I move onto the API portion of this exercise, I press F5 to run my site and use the newly created Phone Numbers menu to get at the UI the framework generated for me.&nbsp; I add several entries as you can see below.</p>
<p><a href="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_11.png" target="_blank" rel="external"><img src="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_thumb_3.png" alt="image" title="image"></a></p>
<p>Now, I want to go one step further. This is about accessing the data for a specific user, so I want to have some other data in there as well to prove out that we can isolate the data and make use of the Authentication providers in Asp.Net.&nbsp; I create another user and add more entries as I did above, and you can see in the database now how there is data in there for two users. </p>
<p><a href="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_13.png" target="_blank" rel="external"><img src="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_thumb_4.png" alt="image" title="image"></a></p>
<p>I now have data specific to a couple of users and can build out the service piece.</p>
<h2 id="Cutting_a_Web_API_Controller"><a href="#Cutting_a_Web_API_Controller" class="headerlink" title="Cutting a Web API Controller"></a>Cutting a Web API Controller</h2><p>This piece is really easy and uses the tooling and templates from the MVC Framework.&nbsp; I add a new folder called Api to my Controllers folder and then right-click on the Api folder and select Add –&gt; Controller.&nbsp; I name it PhoneNumberEntryController and select the Empty Api controller as the scaffolder. Even though it’s the same name, it ends up in a different namespace so everyone’s happy.</p>
<p><a href="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_15.png" target="_blank" rel="external"><img src="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_thumb_5.png" alt="image" title="image"></a></p>
<p>Much like the controller returning a view, I want the ApiController to only allow authenticated requests, and I want the method to return only phone numbers for the current user.</p>
<pre class="csharpcode">    [Authorize]
    <span class="kwrd">public</span> <span class="kwrd">class</span> PhoneNumberEntryController : ApiController
    {
        <span class="kwrd">private</span> CloudyWebSiteContext db = <span class="kwrd">new</span> CloudyWebSiteContext();

        <span class="kwrd">public</span> ICollection&lt;PhoneNumberEntry&gt; Get()
        {
            <span class="kwrd">string</span> username = ControllerContext.Request.GetUserPrincipal().Identity.Name;

            var phoneNumbers = db.PhoneNumberEntries
                .Where(p =&gt; p.UserName == username)
                .ToList();

            <span class="kwrd">return</span> phoneNumbers;

        }
    }</pre>

<p>There’s one more thing I want to do: I want to suppress the Xml formatter that is on by default in WebAPI.&nbsp; By turning it off, the only remaining default serializer is Json.&nbsp; Glenn Block <a href="http://codebetter.com/glennblock/2012/02/26/disabling-the-xml-formatter-in-asp-net-web-apithe-easy-way-2/" target="_blank" rel="external">shows us</a> the most performant way to do this in our Global.asax’s Application_Start menthod:</p>
<blockquote>
<pre class="csharpcode">GlobalConfiguration.Configuration.Formatters.XmlFormatter.SupportedMediaTypes.Clear();</pre>

</blockquote>
<p>People. We are now awesomely rocking.&nbsp; I will coin the term “awesrocking” because of the awesomeness here.</p>
<h2 id="Testing_Out_the_Api"><a href="#Testing_Out_the_Api" class="headerlink" title="Testing Out the Api"></a><img src="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/image_18.png" alt="image" title="image">Testing Out the Api</h2><p>This is the part where I could start to hit some roadblocks if I didn’t have the right tools. I love Fiddler and use it first whenever I’m, uh…fiddling around, but I can’t use Fiddler to poke around the API because I <em>need</em> a user to see what I’m doing and authentication is forms based in this context. I can’t use IE efficiently because every time I get a Json document returned it prompts me to open the file of an unknown file type. I could use Notepad here (or a <a href="http://stackoverflow.com/questions/2483771/how-can-i-convince-ie-to-simply-display-application-json-rather-than-offer-to-do" target="_blank" rel="external">registry hack</a>), I know, but it’s a pain and I like to see my data all nicely formatted <img src="http://oldblog.jameschambers.com/Media/Default/Windows-Live-Writer/Cloudy-With-a-Chance-of-Mobile-Building-_DC61/wlEmoticon-winkingsmile_2.png" alt="Winking smile">.</p>
<p>FireFox to the rescue, along with a little helper plugin called JsonView.&nbsp; In Visual Studio 11 this will be even easier because I can choose the browser to launch, rather than launching a separate browser or setting the OS default.&nbsp; Regardless, I run the app in FireFox, log in to my site, then I hit <a href="http://127.0.0.1:81/api/phonenumberentry" target="_blank" rel="external">http://127.0.0.1:81/api/phonenumberentry</a> to see the data. JsonView takes over and I see my phone numbers as we expect.</p>
<p>You can see the result in the image to the right.</p>
<h2 id="Wrapping_Up_and_Next_Steps"><a href="#Wrapping_Up_and_Next_Steps" class="headerlink" title="Wrapping Up and Next Steps"></a>Wrapping Up and Next Steps</h2><p>Okay, here’s the quick breakdown for the steps we have taken to this point:</p>
<ol>
<li>Added our model (class)</li><li>Added our data context</li><li>Scaffolded our views</li><li>Secured our views</li><li>Tied the data entry and loading to specific users</li><li>Added some data</li><li>Created a Web API controller</li><li>Secured the controller and started returning the correct data</li>
</ol>
<p>&nbsp;</p>
<p>With these things in place, I can now start work on my phone client. Our project is already set, so we can get to the heavy lifting right away! Stay tuned for the next post where I’ll get the phone client lined up to consume the data and display it.&nbsp; Later on we’ll talk about some things we can do to better improve the code and get us closer to best practices.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2012/04/cloudy-with-a-chance-of-mobile-building-our-data-model-amp-api/" data-id="cijnopntf00mzdsyyeqaxjnmt" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2012/04/cloudy-with-a-chance-of-mobile-building-our-data-model-amp-api/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Entity-Framework/">Entity Framework</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JSON/">JSON</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Windows-Phone/">Windows Phone</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2012/05/removing-tracked-files-after-adding-a-rule-to-gitignore/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Removing Tracked Files After Adding A Rule to .gitignore
        
      </div>
    </a>
  
  
    <a href="/2012/04/cloudy-with-a-chance-of-mobile-mvc-framework-windows-azure-and-windows-phone/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Cloudy With a Chance of Mobile: Mvc Framework, Windows Azure and Windows Phone</div>
    </a>
  
</nav>


  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">recent</h3>
    <div class="widget">
      <ul id="recent-post" class="no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/01/Configuration-in-ASP-NET-Core-MVC/" class="title">Configuration in ASP.NET Core MVC</a></p>
              <p class="item-date"><time datetime="2016-01-21T02:27:23.000Z" itemprop="datePublished">2016-01-20</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/01/2106-01-17-Everything-You-Need-To-Know-About-Band-2-Battery-Life/" class="title">Everything You Need To Know About Microsoft Band 2 Battery Life</a></p>
              <p class="item-date"><time datetime="2016-01-18T02:44:01.000Z" itemprop="datePublished">2016-01-17</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/01/work-is-not-life/" class="title">Your Work and Your Life are Not Intricately Intertwined</a></p>
              <p class="item-date"><time datetime="2016-01-11T02:24:09.000Z" itemprop="datePublished">2016-01-10</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2015/11/the-humanitarian-toolbox-allready-code-a-thon/" class="title">The Humanitarian Toolbox AllReady Code-a-Thon</a></p>
              <p class="item-date"><time datetime="2015-11-18T15:22:00.000Z" itemprop="datePublished">2015-11-18</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2015/11/apicontroller-in-asp-net-5-nopesauce/" class="title">ApiController in ASP.NET 5? Nopesauce.</a></p>
              <p class="item-date"><time datetime="2015-11-03T04:39:31.000Z" itemprop="datePublished">2015-11-02</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Buy me a coffee?</h3>
    <div class="widget">
        <a href="https://www.paypal.me/jameschambers/3.5usd" target="_blank"><img src="/content/coffee.png"></a>
    </div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">tag cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/30DaysMvcBootstrap/" style="font-size: 17.86px;">30DaysMvcBootstrap</a> <a href="/tags/8DaysOfTableStorage/" style="font-size: 11.43px;">8DaysOfTableStorage</a> <a href="/tags/ASP-NET/" style="font-size: 15px;">ASP.NET</a> <a href="/tags/ASP-NET-5/" style="font-size: 10px;">ASP.NET 5</a> <a href="/tags/ASP-NET-Core/" style="font-size: 10px;">ASP.NET Core</a> <a href="/tags/ActionFilters/" style="font-size: 10px;">ActionFilters</a> <a href="/tags/Android/" style="font-size: 10.71px;">Android</a> <a href="/tags/AngelaSmith/" style="font-size: 10px;">AngelaSmith</a> <a href="/tags/Asp-Net-MVC/" style="font-size: 20px;">Asp.Net MVC</a> <a href="/tags/Authentication/" style="font-size: 10px;">Authentication</a> <a href="/tags/Azure/" style="font-size: 17.14px;">Azure</a> <a href="/tags/Azure-Web-Apps/" style="font-size: 10px;">Azure Web Apps</a> <a href="/tags/Azure-Websites/" style="font-size: 13.57px;">Azure Websites</a> <a href="/tags/BUILD/" style="font-size: 10px;">BUILD</a> <a href="/tags/BitBucket/" style="font-size: 10px;">BitBucket</a> <a href="/tags/Bootstrap/" style="font-size: 15.71px;">Bootstrap</a> <a href="/tags/CTT-NUG/" style="font-size: 10px;">CTT .NUG</a> <a href="/tags/Calgary/" style="font-size: 10px;">Calgary</a> <a href="/tags/Cisco-VPN/" style="font-size: 10px;">Cisco VPN</a> <a href="/tags/ClearMeasure/" style="font-size: 10.71px;">ClearMeasure</a> <a href="/tags/CodeProject/" style="font-size: 11.43px;">CodeProject</a> <a href="/tags/Conferences/" style="font-size: 10.71px;">Conferences</a> <a href="/tags/CouchDb/" style="font-size: 10px;">CouchDb</a> <a href="/tags/DNX/" style="font-size: 10px;">DNX</a> <a href="/tags/Dojo/" style="font-size: 10px;">Dojo</a> <a href="/tags/Email/" style="font-size: 10px;">Email</a> <a href="/tags/Entity-Framework/" style="font-size: 13.57px;">Entity Framework</a> <a href="/tags/Extension-Methods/" style="font-size: 10px;">Extension Methods</a> <a href="/tags/FontAwesome/" style="font-size: 10.71px;">FontAwesome</a> <a href="/tags/GenFu/" style="font-size: 10px;">GenFu</a> <a href="/tags/GetManifestResourceStream/" style="font-size: 10px;">GetManifestResourceStream</a> <a href="/tags/Git/" style="font-size: 11.43px;">Git</a> <a href="/tags/HTML5/" style="font-size: 10px;">HTML5</a> <a href="/tags/HackAThon/" style="font-size: 10px;">HackAThon</a> <a href="/tags/HtmlHelper/" style="font-size: 10px;">HtmlHelper</a> <a href="/tags/IIS/" style="font-size: 10px;">IIS</a> <a href="/tags/JSON/" style="font-size: 10.71px;">JSON</a> <a href="/tags/Keynote/" style="font-size: 10px;">Keynote</a> <a href="/tags/Life-Hack/" style="font-size: 10px;">Life Hack</a> <a href="/tags/Life-Hacking/" style="font-size: 10.71px;">Life Hacking</a> <a href="/tags/Life-Hacks/" style="font-size: 12.14px;">Life Hacks</a> <a href="/tags/Linq/" style="font-size: 10px;">Linq</a> <a href="/tags/MIX11/" style="font-size: 10px;">MIX11</a> <a href="/tags/MVA/" style="font-size: 10.71px;">MVA</a> <a href="/tags/MVC/" style="font-size: 19.29px;">MVC</a> <a href="/tags/MVC5/" style="font-size: 18.57px;">MVC5</a> <a href="/tags/MVC6/" style="font-size: 13.57px;">MVC6</a> <a href="/tags/MVP/" style="font-size: 10px;">MVP</a> <a href="/tags/Make-Code-Not-War/" style="font-size: 10px;">Make Code Not War</a> <a href="/tags/MeasureUp/" style="font-size: 10px;">MeasureUp</a> <a href="/tags/Metro/" style="font-size: 10px;">Metro</a> <a href="/tags/Microsoft/" style="font-size: 10px;">Microsoft</a> <a href="/tags/Microsoft-Band/" style="font-size: 12.14px;">Microsoft Band</a> <a href="/tags/Mobile/" style="font-size: 10px;">Mobile</a> <a href="/tags/Mobile-Services/" style="font-size: 10px;">Mobile Services</a> <a href="/tags/Motivate/" style="font-size: 10px;">Motivate</a> <a href="/tags/MvcScaffolding/" style="font-size: 11.43px;">MvcScaffolding</a> <a href="/tags/Not-Coding-At-All/" style="font-size: 10px;">Not Coding At All</a> <a href="/tags/NuGet/" style="font-size: 15px;">NuGet</a> <a href="/tags/OData/" style="font-size: 10px;">OData</a> <a href="/tags/PayPal/" style="font-size: 10px;">PayPal</a> <a href="/tags/PostSharp/" style="font-size: 10px;">PostSharp</a> <a href="/tags/Practice/" style="font-size: 10.71px;">Practice</a> <a href="/tags/Practice-of-Awesome/" style="font-size: 10px;">Practice of Awesome</a> <a href="/tags/PrairieDevCon/" style="font-size: 16.43px;">PrairieDevCon</a> <a href="/tags/Queues/" style="font-size: 10px;">Queues</a> <a href="/tags/REST/" style="font-size: 10px;">REST</a> <a href="/tags/Radio/" style="font-size: 10px;">Radio</a> <a href="/tags/Razor/" style="font-size: 10.71px;">Razor</a> <a href="/tags/Real-Life/" style="font-size: 10px;">Real Life</a> <a href="/tags/Regina/" style="font-size: 10.71px;">Regina</a> <a href="/tags/Remote-Work/" style="font-size: 10.71px;">Remote Work</a> <a href="/tags/Resolve/" style="font-size: 10px;">Resolve</a> <a href="/tags/Rock-Paper-Scissors/" style="font-size: 10px;">Rock Paper Scissors</a> <a href="/tags/Routing/" style="font-size: 10px;">Routing</a> <a href="/tags/Ruby-on-Rails/" style="font-size: 10px;">Ruby on Rails</a> <a href="/tags/SDEC/" style="font-size: 10px;">SDEC</a> <a href="/tags/SOAP/" style="font-size: 10px;">SOAP</a> <a href="/tags/SQL-Server/" style="font-size: 10px;">SQL Server</a> <a href="/tags/ServiceBus/" style="font-size: 10px;">ServiceBus</a> <a href="/tags/SignalR/" style="font-size: 11.43px;">SignalR</a> <a href="/tags/Speaking/" style="font-size: 11.43px;">Speaking</a> <a href="/tags/TFS/" style="font-size: 10px;">TFS</a> <a href="/tags/Table-Storage/" style="font-size: 10.71px;">Table Storage</a> <a href="/tags/TypeScript/" style="font-size: 10px;">TypeScript</a> <a href="/tags/Unit-Testing/" style="font-size: 10px;">Unit Testing</a> <a href="/tags/Visual-Studio/" style="font-size: 10.71px;">Visual Studio</a> <a href="/tags/Visual-Studio-11/" style="font-size: 11.43px;">Visual Studio 11</a> <a href="/tags/Visual-Studio-2010/" style="font-size: 16.43px;">Visual Studio 2010</a> <a href="/tags/Visual-Studio-2012/" style="font-size: 12.86px;">Visual Studio 2012</a> <a href="/tags/Visual-Studio-2013/" style="font-size: 10.71px;">Visual Studio 2013</a> <a href="/tags/Visual-Studio-2015/" style="font-size: 14.29px;">Visual Studio 2015</a> <a href="/tags/WCF/" style="font-size: 10.71px;">WCF</a> <a href="/tags/Web-API/" style="font-size: 10.71px;">Web API</a> <a href="/tags/Web-Development/" style="font-size: 10px;">Web Development</a> <a href="/tags/Web-Services/" style="font-size: 10.71px;">Web Services</a> <a href="/tags/Windows-8/" style="font-size: 11.43px;">Windows 8</a> <a href="/tags/Windows-Azure/" style="font-size: 10px;">Windows Azure</a> <a href="/tags/Windows-Phone/" style="font-size: 14.29px;">Windows Phone</a> <a href="/tags/Windws-Live-Writer/" style="font-size: 10px;">Windws Live Writer</a> <a href="/tags/Winnipeg/" style="font-size: 10.71px;">Winnipeg</a> <a href="/tags/c/" style="font-size: 11.43px;">c#</a> <a href="/tags/compiling/" style="font-size: 10px;">compiling</a> <a href="/tags/jQuery/" style="font-size: 12.14px;">jQuery</a> <a href="/tags/jQuery-UI/" style="font-size: 10.71px;">jQuery UI</a> <a href="/tags/node/" style="font-size: 10px;">node</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/open-source/" style="font-size: 10.71px;">open source</a> <a href="/tags/reflection/" style="font-size: 10px;">reflection</a> <a href="/tags/seed-data/" style="font-size: 10px;">seed data</a> <a href="/tags/testing/" style="font-size: 10px;">testing</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/">2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/">2015</a><span class="archive-list-count">36</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/">2014</a><span class="archive-list-count">42</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/">2013</a><span class="archive-list-count">17</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/">2012</a><span class="archive-list-count">41</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/">2011</a><span class="archive-list-count">36</span></li></ul>
    </div>
  </div>

  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 1999 - 2016 James Chambers<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script>
  var disqus_shortname = 'jameschambers';
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



 <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>




  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>