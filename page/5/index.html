<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>They Call Me Mister James</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This is the blog of James Chambers, a senior developer on the .NET stack">
<meta property="og:type" content="website">
<meta property="og:title" content="They Call Me Mister James">
<meta property="og:url" content="http://jameschambers.com/page/5/index.html">
<meta property="og:site_name" content="They Call Me Mister James">
<meta property="og:description" content="This is the blog of James Chambers, a senior developer on the .NET stack">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="They Call Me Mister James">
<meta name="twitter:description" content="This is the blog of James Chambers, a senior developer on the .NET stack">
<meta name="twitter:creator" content="@CanadianJames">
<meta name="twitter:site" content="CanadianJames">
  
  
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="content/avatar.png">
  
  
 <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
 <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>


  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" type="text/css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-2868185-6', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  

  
  <script src="//load.sumome.com/" data-sumo-site-id="34f480920bcf5ea13ec1605be65d32e86be89fb7177416fb68c2d2f1939aaa04" async="async"></script>
</head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo" style="background-image: url(/content/logo_round.png)"></i><span class="site-title">They Call Me Mister James</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/.">Home</a>
        
          <a class="main-nav-link" href="/about/bootstrapping-mvc.html">Boostrapping MVC</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">Testimonials</a>
        
          <a class="main-nav-link" href="/about/genfu.html">GenFu</a>
        
        <a class="main-nav-link main-nav-link-highlight" href="https://hireme.jameschambers.com" target="_blank">Hire Me</a>
      </nav>
      
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/content/avatar.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
      
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="http://jameschambers.com"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
        
          <td><a class="main-nav-link" href="/.">Home</a></td>
        
          <td><a class="main-nav-link" href="/about/bootstrapping-mvc.html">Boostrapping MVC</a></td>
        
          <td><a class="main-nav-link" href="/archives">Archives</a></td>
        
          <td><a class="main-nav-link" href="/about">Testimonials</a></td>
        
          <td><a class="main-nav-link" href="/about/genfu.html">GenFu</a></td>
        
        <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://jameschambers.com"></form>
        </td>
      </tr>
    </table>
  </div>
</header>

    <div class="outer">
      
        <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <h2 id="name">James Chambers</h2>
      <h3 id="title">Husband, Father, Mentor, Humanitarian &amp; Software Developer</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Canada</span>
      <a id="follow" href="https://twitter.com/canadianjames">FOLLOW</a>
    </div>

    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
          <td><a href="/CanadianJames" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></td>
          
          <td><a href="http://github.com/MisterJames" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
          
          <td><a href="/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
          
          <td><a href="https://ca.linkedin.com/in/canadianjames" target="_blank" title="linkedin"><i class="fa fa-linkedin"></i></a></td>
          
          <td><a href="https://www.youtube.com/user/CodingMisterJames/" target="_blank" title="youtube"><i class="fa fa-youtube"></i></a></td>
          
        </tr>
      </table>
    </div>
    

    <div class="base-info profile-block">
        <a href="http://aspnetmonsters.com" target="_blank"><img src="/content/monster-james.png"></a>      
    </div>

    <div class="base-info profile-block">
        <a href="https://leanpub.com/bootstrappingmvc" onclick="_gaq.push(['_trackEvent', 'outbound-widget', 'https://leanpub.com/bootstrappingmvc', '\n\n']);">
            <img src="https://s3.amazonaws.com/titlepages.leanpub.com/bootstrappingmvc/medium?1425560219" scale="0">
        </a>
    </div>
        
    
  </div>
</aside>

      
      <section id="main">
      <article id="post-upgrading-a-real-world-mvc-5-application-to-mvc-6" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/upgrading-a-real-world-mvc-5-application-to-mvc-6/">Upgrading a Real-World MVC 5 Application to MVC 6</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/07/upgrading-a-real-world-mvc-5-application-to-mvc-6/">
      <time datetime="2015-07-24T00:19:13.000Z" itemprop="datePublished">2015-07-23</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/MVC6-Conversion/">MVC6 Conversion</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>These are exciting times for web development on the Microsoft stack, but perhaps a little confusing as well. For many years the cycle of moving from one solution and project system to the next hasn’t been overly complex. Sure, there have been breaking changes, I’ve felt those pains myself, but provided the framework you were using continued to live on, there was a reasonable migration path.</p>
<p>Moving to MVC 6 is going to be a big shift for a lot of development teams, but that doesn’t mean it needs to be scary, complicated or introduce instability into your project.</p>
<p>It does, however, mean that you’re going to need an attitude of learning, that you’ll pick up some new tooling, you’ll have to brush up on your JavaScript and work with some new concepts.</p>
<h2 id="Let_u2019s_Make_it_Happen"><a href="#Let_u2019s_Make_it_Happen" class="headerlink" title="Let’s Make it Happen"></a>Let’s Make it Happen</h2><p>I’m super excited to now be part of the excellent crew at <a href="http://clear-measure.com/" target="_blank" rel="external">Clear Measure</a>, where this type of attitude seems to be fostered, encouraged and embodied by other members of the team and, more importantly, the management.</p>
<p>We’re now undertaking the process of converting from MVC5 =&gt; MVC6 with our <a href="https://github.com/ClearMeasureLabs/ClearMeasureBootcamp" target="_blank" rel="external">Bootcamp workshop project</a> and I have the privilege of blogging my experience with it as I go. <a href="https://jcblogimages.blob.core.windows.net/img/2015/07/image7.png" target="_blank" rel="external"><img src="https://jcblogimages.blob.core.windows.net/img/2015/07/image_thumb2.png" alt="image" title="image"></a>We’re going to keep the project building and operable as we go, such that at an point it can be shipped to production or branched for feature development.&nbsp; We’ll be using GitFlow, feature branches, continuous integration and continuous deployment.&nbsp; Our check-ins will be code that builds cleanly with passing tests.</p>
<p><strong>And,</strong> for those of you who come join in our our MVC Masters Bootcamp sessions, you’ll also get to work on this code base with all the tools, exposure to pair programming, a dedicated product owner and 3 days of intense coding.</p>
<p><a href="http://clear-measure.com/" target="_blank" rel="external"><img src="https://jcblogimages.blob.core.windows.net/img/2015/07/image8.png" alt="image" title="image"></a><strong>Shameless plug</strong>: If you want to level up your team of developers, please reach out to <a href="mailto:gina@clear-measure.com??Subject=MVC%20Masters%20Bootcamp" target="_blank" rel="external">Gina Hollis</a> at Clear Measure to plan an on- or off-site event. We promise to melt your minds.</p>
<h2 id="How_We_u2019re_Getting_There"><a href="#How_We_u2019re_Getting_There" class="headerlink" title="How We’re Getting There"></a>How We’re Getting There</h2><p><a href="https://jcblogimages.blob.core.windows.net/img/2015/07/image9.png" target="_blank" rel="external"><img src="https://jcblogimages.blob.core.windows.net/img/2015/07/image_thumb3.png" alt="image" title="image"></a>Well, to start it off, we’re beginning with our initial commit as the MVC 5 project <a href="https://twitter.com/jeffreypalermo" target="_blank" rel="external">Jeffrey Palermo’s</a> been using in the Masters Bootcamp for some time.</p>
<p>The application is hosted on <a href="https://github.com/ClearMeasureLabs/ClearMeasureBootcamp" target="_blank" rel="external">GitHub</a> and you can <a href="https://github.com/ClearMeasureLabs/ClearMeasureBootcamp/issues/" target="_blank" rel="external">see the issues</a> that we’re identifying and working through. We’re doing the whole thing as open source in hopes that other teams can learn from what we learn in the process.</p>
<p>And, as I knock items off the issue list I’ll be posting about them here, covering the challenges, pitfalls and wins we encounter along the way. You can bookmark this post for updates in the project. Feel free to ask questions on the issues in the repository, or ping me on Twitter (<a href="https://twitter.com/CanadianJames/" target="_blank" rel="external">@CanadianJames</a>).</p>
<p>Stay tuned!</p>
<ul>
<li>Part 1: <a href="http://jameschambers.com/2015/07/moving-to-vs-2015-from-vs-2013/">Moving to VS2015 from VS2013</a></li>
<li>Part 2: <a href="http://jameschambers.com/2015/07/getting-your-build-server-ready-for-vs-2015/">Getting Your Build Server Ready for VS2015</a></li>
<li>Part 3: <a href="http://jameschambers.com/2015/07/upgrading-projects-to-net-4-6/">Retargeting Projects to .NET 4.6</a></li>
<li>Part 4: <a href="http://jameschambers.com/2015/08/converting-net-4-6-projects-to-the-vs-2015-project-system/">Multitargeting Projects with VS2015 Projects</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2015/07/upgrading-a-real-world-mvc-5-application-to-mvc-6/" data-id="civfcz33r003nyoyybs6e5vgj" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2015/07/upgrading-a-real-world-mvc-5-application-to-mvc-6/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ClearMeasure/">ClearMeasure</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC5/">MVC5</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC6/">MVC6</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-workaround-nuget-packages-failing-to-download-in-visual-studio-2015-rtm" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/workaround-nuget-packages-failing-to-download-in-visual-studio-2015-rtm/">Workaround: NuGet Packages Failing to Download in Visual Studio 2015 RTM</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/07/workaround-nuget-packages-failing-to-download-in-visual-studio-2015-rtm/">
      <time datetime="2015-07-23T19:59:39.000Z" itemprop="datePublished">2015-07-23</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Uncategorized/">Uncategorized</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>I haven’t figured out a common theme yet, but certain packages are failing to restore when you attempt to install them from the NuGet primary feed via the project.json file in Visual Studio 2015. Thanks to <a href="https://twitter.com/BrockLAllen" target="_blank" rel="external">Brock Allen</a> for confirming I wasn’t going insane.</p>
<p>A couple of things I’ve discovered:</p>
<ul>
<li>This seems to be more common for prerelease packages</li>
<li>It seems to work if the package has a previous release version (not in pre)</li>
</ul>
<p>As a workaround, you can add the packages manually via the dialog in Visual Studio, just make sure you hit that pre-release flag:</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2015/07/image3.png" alt="image" title="image"></p>
<p>If that doesn’t work for you – sometimes I’m not seeing the package above in my feed – if you have it you can add another NuGet feed to an alternate package source, like I’ve done here with AutoFac’s nightly build feed:</p>
<p><a href="https://jcblogimages.blob.core.windows.net/img/2015/07/image4.png" target="_blank" rel="external"><img src="https://jcblogimages.blob.core.windows.net/img/2015/07/image_thumb1.png" alt="image" title="image"></a></p>
<p>The other thing is that once you get it installed in your system cache, it will resolve it from there, which I imagine makes it harder to triage for anyone trying to figure out what’s going on.</p>
<p>I’m seeing various confirmations of this on Twitter:</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2015/07/image5.png" alt="image" title="image"></p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2015/07/image6.png" alt="image" title="image"></p>
<p>With NuGet 3 being release (and part of VS 2015) I think some package authors are unsure if it’s their problem or what the case may be. Depending on the method you come at it, it’s possible that you can still get the package, but I would say it seems unpredictable right now.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2015/07/workaround-nuget-packages-failing-to-download-in-visual-studio-2015-rtm/" data-id="civfcz31e000pyoyyp2quszjo" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2015/07/workaround-nuget-packages-failing-to-download-in-visual-studio-2015-rtm/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>



    
      <article id="post-response-from-postsharp-net-is-not-a-valid-nuget-v2-service-response" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/response-from-postsharp-net-is-not-a-valid-nuget-v2-service-response/">Response from Postsharp.net is not a Valid Nuget v2 Service Response</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/07/response-from-postsharp-net-is-not-a-valid-nuget-v2-service-response/">
      <time datetime="2015-07-22T07:05:22.000Z" itemprop="datePublished">2015-07-22</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>After installing PostSharp.net on my machine for a project (I did the MSI install) I started getting errors during the package restore that ended up blocking my builds. They looked a lot like this:</p>
<blockquote>
<p>Error: FindPackagesById: EntityFramework.Core Response from <a href="https://www.postsharp.net/nuget/packages/FindPackagesById(" target="_blank" rel="external">https://www.postsharp.net/nuget/packages/FindPackagesById()?id=’EntityFramework.Core’</a>?id=) is not a valid NuGet v2 service response.</p>
</blockquote>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2015/07/image1.png" alt="image" title="image"></p>
<p>Now, an important note here: I’m on a machine that’s seen various updates and changes to VS 2015, and this was a version of PostSharp that wasn’t originally built for the RTM version of Visual Studio. So…this may be entirely circumstantial, but it’s what I ran into.</p>
<p>And it wasn’t just on that one package (others would give the same result) and it wasn’t just on one project. I tried to isolate this, but couldn’t find the source. Why was PostSharp getting in the way of my package restore? Even using DNU from the command line, <strong><em>after</em></strong> I explicitly uninstalled it? I started setting compiler variables to block PostSharp on those projects, but that got frustrating quickly, so I resorted to uninstalling everything I could find of it.</p>
<p>After the uninstall, I still was stumped, same errors all over again. With the help of my friend <a href="https://twitter.com/dbelcham" target="_blank" rel="external">Donald Belcham</a>, I was able to find traces of PostSharp still on my machine, located in the system-wide NuGet package source feed configuration:</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2015/07/image2.png" alt="image" title="image"></p>
<p>Unchecking that box above does the trick.</p>
<p>Might be an edge case if you run into this, but if you do, and this helps, consider buying Don a scotch! </p>
<p>Happy coding. <img src="https://jcblogimages.blob.core.windows.net/img/2015/07/wlEmoticon-smile1.png" alt="Smile"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2015/07/response-from-postsharp-net-is-not-a-valid-nuget-v2-service-response/" data-id="civfcz37w0087yoyyvvfobiq8" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2015/07/response-from-postsharp-net-is-not-a-valid-nuget-v2-service-response/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NuGet/">NuGet</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PostSharp/">PostSharp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/compiling/">compiling</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-day-3-extracting-a-service-to-interact-with-azure-table-storage" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/day-3-extracting-a-service-to-interact-with-azure-table-storage/">Day 3 – Extracting a Service to Interact with Azure Table Storage</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/07/day-3-extracting-a-service-to-interact-with-azure-table-storage/">
      <time datetime="2015-07-18T19:32:58.000Z" itemprop="datePublished">2015-07-18</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Uncategorized/">Uncategorized</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p><em>In <a href="http://jameschambers.com/2015/01/day-0-8-days-of-working-with-azure-table-storage-from-asp-net-mvc-5/">this series</a> we are looking at the basic mechanics of interacting with cloud-based Table Storage from an MVC 5 Application, using the Visual Studio 2013 IDE and Microsoft Azure infrastructure.</em></p>
<p>Our controllers are not supposed to be about anything more than getting models together so that our views have something to present. When we start mixing concerns, our application starts to become very difficult to test, controllers start getting quite complex and the difficulty in maintaining our application can skyrocket. </p>
<p>Let’s avoid that.</p>
<p>If you want to follow along, please <a href="http://www.microsoft.com/click/services/Redirect2.ashx?CR_CC=200575119" target="_blank" rel="external">pop into Azure</a> and make sure you’ve got an account ready to go. The trial is free, so get at it!</p>
<h2 id="Defining_Our_Service"><a href="#Defining_Our_Service" class="headerlink" title="Defining Our Service"></a>Defining Our Service</h2><p>Let’s look at the operations we’re going to need, from what we’ve already implemented, and knowing what we’re planning from <a href="http://jameschambers.com/2015/01/day-0-8-days-of-working-with-azure-table-storage-from-asp-net-mvc-5/">our outline</a>:</p>
<ul>
<li>Insert a record  </li><li>Get a filtered set of records  </li><li>Update a record  </li><li>Deleting a record </li>
</ul>
<p>Cool beans. At first blush it seems like we’ve got a pretty simple set of concerns, but notice that I didn’t include things like “connecting to Azure”, “creating table references” or “reading configuration information”, as those are all separate concerns that our controller doesn’t actually care about.&nbsp; Remember, we’re trying to isolate our concerns. </p>
<p>Hrm…so, manipulating records, adding, deleting, filtering, separating concerns from our business logic…this is starting to sound familiar, right?&nbsp; </p>
<blockquote>
<p>Use a <strong>repository</strong> to separate the logic that retrieves the data and maps it to the entity model from the business logic that acts on the model. The business logic should be agnostic to the type of data that comprises the data source layer. Source: <a href="https://msdn.microsoft.com/en-us/library/ff649690.aspx" target="_blank" rel="external">MSDN</a>. </p>
</blockquote>
<p>So, we’re going to want to build something using the repository pattern. We’ll use that repository here in our application’s controllers, but in a larger project you might go even further to have an application services layer where you map between the domain models and the view models that we have in our views. All in, our interface might look like the following:</p>
<p><pre class="csharpcode"><span class="kwrd">public</span> <span class="kwrd">interface</span> ITableStorageRepository&lt;T&gt; <span class="kwrd">where</span> T : TableEntity<br>{<br>    <span class="kwrd">void</span> Insert(T entity);<br>    <span class="kwrd">void</span> Update(T entity);<br>    <span class="kwrd">void</span> Delete(T entity);<br>    IEnumerable&lt;T&gt; GetByPartition(<span class="kwrd">string</span> partitionKey);<br>}</pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>The public interface simply gives us a way to do our CRUD operations and treat a filtered result set <a href="http://martinfowler.com/eaaCatalog/repository.html" target="_blank" rel="external">as a collection</a> in order to minimize duplicate constructs and operations related to table queries. You can think of the CloudTableClient and TableQueries from the Azure SDK as part of a <a href="http://martinfowler.com/eaaCatalog/dataMapper.html" target="_blank" rel="external">Data Mapper</a> layer that enables us to build this abstraction.</p>
<p>Note: For the purpose of illustration, I’m going to continue to use TableEntity here, which doesn’t completely abstract the Azure Table Storage concern away from my controller. I understand that; in a real-world scenario, I would typically have a view model that is used in the MVC application and an intermediary service would handle mapping as required.</p>
<h2 id="Implementing_the_Service"><a href="#Implementing_the_Service" class="headerlink" title="Implementing the Service"></a>Implementing the Service</h2><p>Leveraging this is going to be awesome, but we need to move some of the heavy-lifting out of our controller first.&nbsp; Let’s start by creating a Repositories folder and adding a class called KittehRepository, which will of course implement ITableStorageRepository&lt;KittehEntity&gt;.</p>
<p><strong>Don’t peak!</strong> As an exercise for the reader, you can use the interface noted above to implement the class. Use the interface above to craft your KittehRepository class. You should be able to find all the bits you need by exploring the objects already in use in the controller.</p>
<p>When you’re ready, here’s my version of the solution below:</p>
<p><pre class="csharpcode"><span class="kwrd">public</span> <span class="kwrd">class</span> KittehRepository : ITableStorageRepository&lt;KittehEntity&gt;<br>{<br>    <span class="kwrd">private</span> <span class="kwrd">readonly</span> CloudTableClient _client;</pre></p>
<pre><code>&lt;span class=&quot;kwrd&quot;&gt;public&lt;/span&gt; KittehRepository()
{
    var storageAccount = CloudStorageAccount.Parse(CloudConfigurationManager.GetSetting(&lt;span class=&quot;str&quot;&gt;&quot;StorageConnectionString&quot;&lt;/span&gt;));
    _client = storageAccount.CreateCloudTableClient();
}

&lt;span class=&quot;kwrd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kwrd&quot;&gt;void&lt;/span&gt; Insert(KittehEntity entity)
{
    var kittehTable = _client.GetTableReference(&lt;span class=&quot;str&quot;&gt;&quot;PicturesOfKittehs&quot;&lt;/span&gt;);
    var insert = TableOperation.Insert(entity);
    kittehTable.Execute(insert);
}

&lt;span class=&quot;kwrd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kwrd&quot;&gt;void&lt;/span&gt; Update(KittehEntity entity)
{
    var kittehTable = _client.GetTableReference(&lt;span class=&quot;str&quot;&gt;&quot;PicturesOfKittehs&quot;&lt;/span&gt;);
    var insert = TableOperation.Replace(entity);
    kittehTable.Execute(insert);
}

&lt;span class=&quot;kwrd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kwrd&quot;&gt;void&lt;/span&gt; Delete(KittehEntity entity)
{
    var kittehTable = _client.GetTableReference(&lt;span class=&quot;str&quot;&gt;&quot;PicturesOfKittehs&quot;&lt;/span&gt;);
    var insert = TableOperation.Delete(entity);
    kittehTable.Execute(insert);
}

&lt;span class=&quot;kwrd&quot;&gt;public&lt;/span&gt; IEnumerable&amp;lt;KittehEntity&amp;gt; GetByPartition(&lt;span class=&quot;kwrd&quot;&gt;string&lt;/span&gt; partitionKey)
{
    var kittehTable = _client.GetTableReference(&lt;span class=&quot;str&quot;&gt;&quot;PicturesOfKittehs&quot;&lt;/span&gt;);
    var kittehQuery = &lt;span class=&quot;kwrd&quot;&gt;new&lt;/span&gt; TableQuery&amp;lt;KittehEntity&amp;gt;()
                    .Where(TableQuery.GenerateFilterCondition(&lt;span class=&quot;str&quot;&gt;&quot;PartitionKey&quot;&lt;/span&gt;, QueryComparisons.Equal, partitionKey));
    var kittehs = kittehTable.ExecuteQuery(kittehQuery).ToList();

    &lt;span class=&quot;kwrd&quot;&gt;return&lt;/span&gt; kittehs;
}
</code></pre><p>}<style type="text/css">.csharpcode, .csharpcode pre<br>{<br>    font-size: small;<br>    color: black;<br>    font-family: consolas, “Courier New”, courier, monospace;<br>    background-color: #ffffff;<br>    /<em>white-space: pre;</em>/<br>}<br>.csharpcode pre { margin: 0em; }<br>.csharpcode .rem { color: #008000; }<br>.csharpcode .kwrd { color: #0000ff; }<br>.csharpcode .str { color: #006080; }<br>.csharpcode .op { color: #0000c0; }<br>.csharpcode .preproc { color: #cc6633; }<br>.csharpcode .asp { background-color: #ffff00; }<br>.csharpcode .html { color: #800000; }<br>.csharpcode .attr { color: #ff0000; }<br>.csharpcode .alt<br>{<br>    background-color: #f4f4f4;<br>    width: 100%;<br>    margin: 0em;<br>}<br>.csharpcode .lnum { color: #606060; }<br></style></p>
<p>One thing to note is that I’ve pushed <em>most</em> of the initialization up to the constructor, and I’ve not implemented any kind of seeding code. The table seeding that I illustrated in <a href="http://jameschambers.com/2015/01/day-1-the-basics-of-the-basics-with-azure-table-storage/">Day 1</a> is a concern that should be implemented outside of a repository, likely as part of a process that starts up the application in first-run scenarios, or something that would be run as part of a deployment to a test/QA environment.</p>
<h2 id="Cleaning_up_Our_Controller"><a href="#Cleaning_up_Our_Controller" class="headerlink" title="Cleaning up Our Controller"></a>Cleaning up Our Controller</h2><p>I love this. The controller can now do what we need it to do. Here’s the complete class, with an added constructor that accepts a reference to the repository (we’ll wire that up shortly):</p>
<p><pre class="csharpcode"><span class="kwrd">public</span> <span class="kwrd">class</span> HomeController : Controller<br>{<br>    <span class="kwrd">private</span> <span class="kwrd">readonly</span> ITableStorageRepository&lt;KittehEntity&gt; _kittehRepository;</pre></p>
<pre><code>&lt;span class=&quot;kwrd&quot;&gt;public&lt;/span&gt; HomeController(ITableStorageRepository&amp;lt;KittehEntity&amp;gt; kittehRepository)
{
    _kittehRepository = kittehRepository;
}

&lt;span class=&quot;kwrd&quot;&gt;public&lt;/span&gt; ActionResult Index()
{
    var kittehs = _kittehRepository.GetByPartition(&lt;span class=&quot;str&quot;&gt;&quot;FunnyKittehs&quot;&lt;/span&gt;);
    &lt;span class=&quot;kwrd&quot;&gt;return&lt;/span&gt; View(kittehs);
}

[HttpPost]
&lt;span class=&quot;kwrd&quot;&gt;public&lt;/span&gt; ActionResult Index(KittehEntity entity)
{
    _kittehRepository.Insert(entity);
    &lt;span class=&quot;kwrd&quot;&gt;return&lt;/span&gt; RedirectToAction(&lt;span class=&quot;str&quot;&gt;&quot;Index&quot;&lt;/span&gt;);
}

&lt;span class=&quot;kwrd&quot;&gt;public&lt;/span&gt; ActionResult About()
{
    ViewBag.Message = &lt;span class=&quot;str&quot;&gt;&quot;Your application description page.&quot;&lt;/span&gt;;

    &lt;span class=&quot;kwrd&quot;&gt;return&lt;/span&gt; View();
}

&lt;span class=&quot;kwrd&quot;&gt;public&lt;/span&gt; ActionResult Contact()
{
    ViewBag.Message = &lt;span class=&quot;str&quot;&gt;&quot;Your contact page.&quot;&lt;/span&gt;;

    &lt;span class=&quot;kwrd&quot;&gt;return&lt;/span&gt; View();
}
</code></pre><p>}<br><style type="text/css">.csharpcode, .csharpcode pre<br>{<br>    font-size: small;<br>    color: black;<br>    font-family: consolas, “Courier New”, courier, monospace;<br>    background-color: #ffffff;<br>    /<em>white-space: pre;</em>/<br>}<br>.csharpcode pre { margin: 0em; }<br>.csharpcode .rem { color: #008000; }<br>.csharpcode .kwrd { color: #0000ff; }<br>.csharpcode .str { color: #006080; }<br>.csharpcode .op { color: #0000c0; }<br>.csharpcode .preproc { color: #cc6633; }<br>.csharpcode .asp { background-color: #ffff00; }<br>.csharpcode .html { color: #800000; }<br>.csharpcode .attr { color: #ff0000; }<br>.csharpcode .alt<br>{<br>    background-color: #f4f4f4;<br>    width: 100%;<br>    margin: 0em;<br>}<br>.csharpcode .lnum { color: #606060; }<br></style></p>
<p>Notice how we’ve reduce the amount of code in this class <em>significantly</em>, to the point that anyone should be able to read it – with little or no exposure to Azure Table Storage – and still have a sense of what’s going on. We’ve taken our controller from over 50 lines of code (non-cruft/whitespace) to about 5. </p>
<p>Just to see how much more clear we’ve made things, do a “remove and sort” on your usings. You’ll notice that everything to do with Azure has all but disappeared; our repository has served it’s purpose!</p>
<p>Okay, so the repository is in place, and our controller is dramatically simplified. Now we need to do a bit of wiring to let the MVC Framework know that we’d like an instance of the class when the controller fires up. Here’s how.</p>
<h2 id="Adding_Dependency_Injection"><a href="#Adding_Dependency_Injection" class="headerlink" title="Adding Dependency Injection"></a>Adding Dependency Injection</h2><p>First, open the Package Manager Console (View –&gt; Other Windows –&gt; Package Manager Console) and type the following:</p>
<p><pre class="csharpcode">install-package Ninject.MVC5</pre><style type="text/css">.csharpcode, .csharpcode pre<br>{<br>    font-size: small;<br>    color: black;<br>    font-family: consolas, “Courier New”, courier, monospace;<br>    background-color: #ffffff;<br>    /<em>white-space: pre;</em>/<br>}<br>.csharpcode pre { margin: 0em; }<br>.csharpcode .rem { color: #008000; }<br>.csharpcode .kwrd { color: #0000ff; }<br>.csharpcode .str { color: #006080; }<br>.csharpcode .op { color: #0000c0; }<br>.csharpcode .preproc { color: #cc6633; }<br>.csharpcode .asp { background-color: #ffff00; }<br>.csharpcode .html { color: #800000; }<br>.csharpcode .attr { color: #ff0000; }<br>.csharpcode .alt<br>{<br>    background-color: #f4f4f4;<br>    width: 100%;<br>    margin: 0em;<br>}<br>.csharpcode .lnum { color: #606060; }<br></style></p>
<p>The Ninject packages required for interoperation with the MVC Framework are installed, and you get a new class in _AppStart called NinjectWebCommon. This class contains an assembly-level attribute that allows it to properly wire dependency injection up in your application at startup, you’ll see this at the top of the file.</p>
<p>What happens now is quite interesting: when the MVC Framework tries to create an instance of a controller (i.e., when someone makes a request to your application), it looks for a constructor with no parameters. This no longer exists on our controller because we require the ITableStorageRepository&lt;KittehEntity&gt; parameter.&nbsp; Ninject will now step in for us and say, “Oh, you want something that looks like that? Here’s one I made for you!”</p>
<p>To get that kind of injection love, you need to go into the NinjectWebCommon class and update the RegisterServices method to include this line of code:</p>
<p><pre class="csharpcode">kernel.Bind&lt;ITableStorageRepository&lt;KittehEntity&gt;&gt;().To&lt;KittehRepository&gt;();</pre><style type="text/css">.csharpcode, .csharpcode pre<br>{<br>    font-size: small;<br>    color: black;<br>    font-family: consolas, “Courier New”, courier, monospace;<br>    background-color: #ffffff;<br>    /<em>white-space: pre;</em>/<br>}<br>.csharpcode pre { margin: 0em; }<br>.csharpcode .rem { color: #008000; }<br>.csharpcode .kwrd { color: #0000ff; }<br>.csharpcode .str { color: #006080; }<br>.csharpcode .op { color: #0000c0; }<br>.csharpcode .preproc { color: #cc6633; }<br>.csharpcode .asp { background-color: #ffff00; }<br>.csharpcode .html { color: #800000; }<br>.csharpcode .attr { color: #ff0000; }<br>.csharpcode .alt<br>{<br>    background-color: #f4f4f4;<br>    width: 100%;<br>    margin: 0em;<br>}<br>.csharpcode .lnum { color: #606060; }<br></style></p>
<p>This simply says, “When someone asks for that interface, give them this concrete class.</p>
<p>So at this point, the wiring is done, and you can run your app! It will have the exact same functionality and user experience, but it will be much more technically sound.</p>
<h2 id="Notes_and_Improvements"><a href="#Notes_and_Improvements" class="headerlink" title="Notes and Improvements"></a>Notes and Improvements</h2><p>Just a few things to note:</p>
<ul>
<li>I’ve kept things simple and omitted ViewModels</li>
<li>You’d likely want to have a layer between your controller and repository class in most real-word scenarios</li>
<li>The repository class should have it’s dependencies injected as well, namely, the configuration information it needs to connect to Azure. A proper configuration helper class would do the trick and, once registered with Ninject, could also be accepted as a parameter on the constructor</li>
</ul>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>With the repository in place we can now lighten the load on the controller and more easily implement features with our concerns more clearly separated. In the next couple of posts, we’re going to start allowing the user to manipulate the entities in the table.</p>
<p>Happy coding! <img src="https://jcblogimages.blob.core.windows.net/img/2015/07/wlEmoticon-smile.png" alt="Smile"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2015/07/day-3-extracting-a-service-to-interact-with-azure-table-storage/" data-id="civfcz3k000i8yoyyxi41d199" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2015/07/day-3-extracting-a-service-to-interact-with-azure-table-storage/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>



    
      <article id="post-three-types-of-relationships-you-need-to-survive-as-a-remote-worker" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/three-types-of-relationships-you-need-to-survive-as-a-remote-worker/">Three Types of Relationships You Need to Survive as a Remote Worker</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/07/three-types-of-relationships-you-need-to-survive-as-a-remote-worker/">
      <time datetime="2015-07-14T17:02:00.000Z" itemprop="datePublished">2015-07-14</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Uncategorized/">Uncategorized</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>Getting through your work day on your own is easy enough.&nbsp; Over the long run, though,&nbsp; you’re going to need to have some solid relationships in your life to help get you through the rough patches and pick you up from the falls, but more importantly, to be there when it’s time to celebrate the wins.</p>
<p>While these are going to seem obvious at first, I want to make the point that they’re by no means effortless. In fact, some of the closest connections in your life can be the most affected by your choice to have your home serve also as your place of work.</p>
<h2 id="Your_Co-Workers"><a href="#Your_Co-Workers" class="headerlink" title="Your Co-Workers"></a>Your Co-Workers</h2><p><a href="https://jcblogimages.blob.core.windows.net/img/2015/07/office_relationships.jpg" target="_blank" rel="external"><img src="https://jcblogimages.blob.core.windows.net/img/2015/07/office_relationships_thumb.jpg" alt="office_relationships" title="office_relationships"></a>In the movie <em>Office Space</em>, the main character Peter Gibbons pines that his motivation to work, or rather, to “work just hard enough not to get fired,” stems from unhealthy relationships with management. This <strong>cannot</strong> be your reality as a remote worker, and you need to make efforts to establish (and maintain) trust with your boss and teammates.</p>
<p>I have worked in blended environments where there was a head office with regular staff, but many remote workers and many office workers who had the option to work from home as they elected to do so. Being a permanent remote with very little office time (averaging about a day a month in the office) it was harder to get to know folks, but I knew it was really on me to own it.</p>
<p>Before you start at a company as a remote worker, or before you start working from home, talk to the management and other staff that already work remotely to see what it is like. If the atmosphere supports it, flying solo can be a great experience, but you still need the support of ground control. If you work as the only remote worker, or if management doesn’t trust or understand how productivity can work remotely, it may not be the right time for you to engage in flight.</p>
<h2 id="Fellow_Remote_Workers"><a href="#Fellow_Remote_Workers" class="headerlink" title="Fellow Remote Workers"></a>Fellow Remote Workers</h2><p>These ones are pretty important, especially in a company where there is a block of folks that work full-time at the office and a group that works remotely. Why are these folks good to know?</p>
<p>Because they <em>get ya</em>. They’re on the Skypes. They’re on the Slack. </p>
<p>They are trying to do the same things that you are doing and likely face the same challenges as you do. They look for solutions and have found tools that help them avoid the pitfalls. You’ve likely had to work through something that they haven’t yet, you have it figured out and it’s great to be able to share that with them. </p>
<p>Don’t be afraid to share your failures or ask for help! Being a good remote worker means mentoring and being mentored by other remote workers so that collectively we can all be really good at it. </p>
<h2 id="People_With_Absolutely_Nothing_to_do_with_Work"><a href="#People_With_Absolutely_Nothing_to_do_with_Work" class="headerlink" title="People With Absolutely Nothing to do with Work"></a>People With Absolutely Nothing to do with Work</h2><p>Ahhh…five o’clock, am I right? It’s that time when you disconnect from work and start to enjoy the more meaningful things in life. Of course, that means that you have be successful in leaving work in the first place, which can be tricky, but <a href="http://jameschambers.com/2015/03/working-from-home-and-walking-to-work-surviving-remote-work/">isn’t impossible to do</a>, especially if you’ve <a href="http://jameschambers.com/2015/03/wake-up-and-get-st-done-a-practice-of-awesome/">put in a good day</a>.</p>
<p>There a measure of counter-intuitiveness here that you’ll find. For example, keeping strong relationships in your own household is actually more about defining and maintaining boundaries during the workday than you might imagine. For example, if your office door is open as you’re working and your spouse, kids or roommates feel free to come and chat, you’re going to be less productive than you’d like to be. Over time, that loss of focus and reduced ability to create tangible outputs are going to start to turn into stress. Allowing the non-work relationships to bleed into your day can be a form of long term toxin that will erode your success as a remote worker.</p>
<p>Likewise, allowing your work day to bleed into your evenings and weekends will rob you of the best part of your day. Maybe you’re married with kids, fiancéed, or perhaps single, but the fact holds true regardless of your situation: marginalizing your family and friends to try to improve things at work will yield exactly zero positive results for your personal life. If you don’t agree with that statement, it’s simply because Dr. Seuss got the idea of the Grinch’s heart being two sizes too small from your life story. </p>
<p>There will be exceptions, where some rule-bending and time-bleeding will occur, but your job as a remote is to maintain that balance and be honest with yourself about how you’re doing in that regard.</p>
<h2 id="An_Old_Adage"><a href="#An_Old_Adage" class="headerlink" title="An Old Adage"></a>An Old Adage</h2><p>I do have to admit that I’m quite fortunate in this regard, as I’ve been able to align with an employer who is very much accustomed to and accepting of remote work. Working remotely, while becoming more common, isn’t yet universally accepted and I know from personal experience that if the culture isn’t there in the company, it can’t work on the long term.</p>
<p>It’s long and often been said that <strong>it takes a village to raise a child</strong>, and the reality of that statement is that at some point we have to grow up and be part of the village. As a remote worker, you need to remember that <strong>community isn’t going to just happen for you</strong>. Sure, you may not be raising kids, but the outcomes of your work efforts can only be best realized if you’re able to establish some great relationships along the way.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2015/07/three-types-of-relationships-you-need-to-survive-as-a-remote-worker/" data-id="civfcz33z004iyoyytisbf8di" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2015/07/three-types-of-relationships-you-need-to-survive-as-a-remote-worker/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Life-Hacks/">Life Hacks</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Remote-Work/">Remote Work</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-rethinking-our-practices-with-the-mvc-framework" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/06/rethinking-our-practices-with-the-mvc-framework/">Rethinking our Practices with the MVC Framework</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/06/rethinking-our-practices-with-the-mvc-framework/">
      <time datetime="2015-06-14T07:52:59.000Z" itemprop="datePublished">2015-06-14</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Beyond-Code/">Beyond Code</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Beyond-Code/Code-Dive/">Code Dive</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Beyond-Code/Code-Dive/Develop-Meta/">Develop Meta</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>We get set in our ways, don’t we? It’s funny how the sharper and more confident we get with our frameworks and the tooling we employ to work with them, we also get a little more attached to our way of doing things. And then along comes a major version change, ripe with breaking changes and new bits to twiddle and we’re left saying, “But, that’s not how we’ve always done it!”.</p>
<p>Case in point: <strong>service injection into views</strong>. In ASP.NET’s MVC Framework 6 we get this new concept which, if we’re going to accept, requires that we relax on our thinking of how we’ve always done things.</p>
<p>My friends <a href="https://twitter.com/dave_paquette" target="_blank" rel="external">Dave Paquette</a>, <a href="https://twitter.com/stimms" target="_blank" rel="external">Simon Timms</a> and <a href="https://twitter.com/canadianjames" target="_blank" rel="external">myself</a> have been ruffling through a few of these types of changes, and Simon did a great job of illustrating how we used to get data into our views, and how we might do it in <a href="http://blog.simontimms.com/2015/06/09/getting-lookup-data-into-you-view/" target="_blank" rel="external">tomorrow’s MVC</a>.  For a walkthrough of service injection I highly recommend his article on it.</p>
<p>How does it work? The new inject feature gives us the ability to asynchronously invoke methods on classes that are dynamically created and given to our view. It’s IoC for your UI.</p>
<p>Personally, I’d been wrestling with a good use case here because we had a way to do it, and it seems an obvious one (illustrated by Simon) had been missing my thought stream, likely because it’s been clouded for a few years with ViewBag. In all reality, the idea of using the ViewBag – a dynamic object that is double-blind, easily forgotten about and easily polluted – to push bits of data to the view has always kind of bugged me, no less than using filters did, but we didn’t have an elegant, framework-driven mechanism to make it happen more gracefully.  We do now.</p>
<p>Also, let’s not confuse things here: In more cases than not, your ViewModel is going to be the correct place to put your data, and where I’ve put my data for most things – like drop down lists – but this type of feature is exciting because it opens the door to explore new options in building views and experiences for our users.</p>
<h2 id="But_2C_doesn_u2019t_it_break_the_design_of_MVC_3F"><a href="#But_2C_doesn_u2019t_it_break_the_design_of_MVC_3F" class="headerlink" title="But, doesn’t it break the design of MVC?"></a>But, doesn’t it break the design of MVC?</h2><p>[caption id=”attachment_6491” align=”alignright” width=”300”]<a href="https://jcblogimages.blob.core.windows.net/img/2015/06/nuke.jpg" target="_blank" rel="external"><img src="https://jcblogimages.blob.core.windows.net/img/2015/06/nuke-300x188.jpg" alt="Source: http://www.nv.doe.gov/library/photos/"></a> Sometimes things blow up when you try them out, but you still gotta try.[/caption]</p>
<p>Perhaps. Maybe, if you want to say, “The only definition valid for any framework is the original definition.” But we have more tools today to do our job, and in particular for this case dependency injection which has become a first-class citizen in ASP.NET. So, let’s rewind a bit and ask, why is it a bad practice to give a component the pieces it needs to do its work?</p>
<p>Let’s think of the type of problem that we’re trying to solve here, as Simon did in his article: a view needs to populate a dropdown list. It doesn’t need to access the database, and it shouldn’t have it. It doesn’t need to know a connection string, or if data is coming from a cache, a web service or otherwise, it just needs the data. Giving it an interface by which to look it up, well, to me that seems like a good idea.</p>
<p>If instead you favor the approach of using the controller to populate the ViewBag or use filters (or other techniques) you inherently introduce coupling to a specific view in the controller by forcing it to look up data to populate a dropdown box. <em>You are still injecting data into the view.</em> In my mind, the controller should know as little as possible about the view.  Why should I have to change my controller if I need to change my view?</p>
<p>I want to make a clear distinction here, though, as I do believe the controller answers very specific concerns, namely, those that deal with a particular entity. But the PersonController shouldn’t have to know the list of Canadian Provinces, should it?</p>
<h2 id="Don_u2019t_need_to_know_where_I_u2019m_going_2C_just_need_to_know_where_I_u2019ve_been"><a href="#Don_u2019t_need_to_know_where_I_u2019m_going_2C_just_need_to_know_where_I_u2019ve_been" class="headerlink" title="Don’t need to know where I’m going, just need to know where I’ve been"></a>Don’t need to know where I’m going, just need to know where I’ve been</h2><p>The assumption that the controller provides everything the view needs is guided by past pretence. It was true in MVC5 and earlier because it was what we had to work with. My point is that in MVC6 we now have a construct that allows:</p>
<ul>
<li>Separation of concern/single responsibility</li>
<li>Testability</li>
<li>Type safety</li>
<li>Injectable dependencies<br>In my mind, the controller is just a component. So is the view. The controller’s concerns are related to the entity in question. The view is required to render correct UI such that a form can be filled out in a way that satisfies the requirements of the view model. Again, why use a person controller to retrieve details about countries and states?</li>
</ul>
<p>I don’t see controllers as any more important than any other component. They have things they need, and they should have those things injected. My controllers don’t talk to the database, they talk to command objects and query objects via interface and those are injected from an IoC container.</p>
<p>I think now, with views as first-class components, that we can look at views in the same way.</p>
<h2 id="But_what_about_ViewBag_3F"><a href="#But_what_about_ViewBag_3F" class="headerlink" title="But what about ViewBag?"></a>But what about ViewBag?</h2><p>With ViewBag (and filters) we have a problem that we’re not really talking about in the best interest of not upsetting anyone. The fact that my controller has to do the lifting for the combo boxes is awkward and doesn’t really help us out too much with maintaining SRP. But we didn’t previously have a good way to address this.</p>
<p>We also tend to overlook the fact that Views are effectively code. Why can’t our principles apply to them as well? Of course I shouldn’t access the database from the view, but why can’t I know about an interface that does (and have it injected)?</p>
<p>This is a great use case of this new feature, and one that demonstrates that “not changing for the sake of not changing” isn’t a good mantra. If my view code/class/script is responsible for rendering the view, I see no problem injecting into it the things it needs to do so.</p>
<p>After all, isn’t that what you’re doing with ViewBag? Just injecting things into the view through the Dynamic? Except, with ViewBag, no one sees type problems and everyone has to cast. Now we’ve got run time errors.</p>
<p>There is the argument that says that even if we’re abstracting away the data access, we’re introducing the ability for the view to call the database. Again, I don’t think the view is any less important a component in the scheme of things, and there is a level of appropriateness with which we must use the feature. Will it be abused? Likely. You don’t want to be injecting database change-capable components into the view, but that is more a case of bad choices in implementation. You can completely destroy the maintainability of a project and wreak havoc on your users with service injection, but that doesn’t mean you should avoid it. I’ve seen people write 1,000 lines of code in a method, but that doesn’t mean I don’t use methods any more.</p>
<p><strong>When changes come to frameworks, I think it’s okay to rethink our best practices</strong>. Taking Simon’s approach we have:</p>
<ul>
<li>Interface-based injection</li>
<li>Abstraction from underlying data access strategy (db, cache, text file, whatever)</li>
<li>Testable components</li>
<li>Maintaining SRP in our controller and view</li>
<li>No casting from dynamic to proper types<br>I’m okay with this approach and will be using this approach in MVC 6 projects.</li>
</ul>
<p>I highly encourage you to do your own reading on this and explore the feature in greater detail. Here are a few links for your consideration.</p>
<ul>
<li>View components and Inject in <a href="http://www.asp.net/vnext/overview/aspnet-vnext/vc" target="_blank" rel="external">ASP.NET MVC 6</a></li>
<li>Simon Timms: <a href="http://blog.simontimms.com/2015/06/09/getting-lookup-data-into-you-view/" target="_blank" rel="external">Getting Lookup Data Into You View ASP.net MVC 6 Version</a></li>
<li>The ASP.NET <a href="https://github.com/aspnet/Mvc" target="_blank" rel="external">MVC 6 repo on GitHub</a><br>Happy coding! <img src="https://jcblogimages.blob.core.windows.net/img/2015/06/wlEmoticon-smile.png" alt="Smile"></li>
</ul>
<p><span style="color: #999999;"><em>Image credit: <a href="http://www.nv.doe.gov/library/photos/" target="_blank" rel="external">http://www.nv.doe.gov/library/photos/</a></em></span></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2015/06/rethinking-our-practices-with-the-mvc-framework/" data-id="civfcz37s007zyoyyz8s5ewz4" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2015/06/rethinking-our-practices-with-the-mvc-framework/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC6/">MVC6</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/page/4/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/31/">31</a><a class="extend next" rel="next" href="/page/6/">Next &raquo;</a>
      </nav>
    </section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">recent</h3>
    <div class="widget">
      <ul id="recent-post" class="no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/11/Five-Days-of-Azure-Functions/" class="title">Five Days of Azure Functions</a></p>
              <p class="item-date"><time datetime="2016-11-11T21:03:50.000Z" itemprop="datePublished">2016-11-11</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/09/Bending-ASP-NET-MVC-Core-To-Your-Will/" class="title">Bending ASP.NET Core MVC To Your Will</a></p>
              <p class="item-date"><time datetime="2016-09-09T17:46:34.000Z" itemprop="datePublished">2016-09-09</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/04/github-authentication-asp-net-core/" class="title">GitHub Authentication with ASP.NET Core</a></p>
              <p class="item-date"><time datetime="2016-04-26T12:12:54.000Z" itemprop="datePublished">2016-04-26</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/03/If-You-Want-to-Get-Into-OSS-Consider-This-Project/" class="title">If You Want to Get Into OSS, Consider This Project</a></p>
              <p class="item-date"><time datetime="2016-03-13T00:24:44.000Z" itemprop="datePublished">2016-03-12</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/03/these-people-are-monsters/" class="title">These People are Monsters! Here&#39;s Some Great Videos Covering ASP.NET Core and Core MVC</a></p>
              <p class="item-date"><time datetime="2016-03-11T02:48:38.000Z" itemprop="datePublished">2016-03-10</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Buy me a coffee?</h3>
    <div class="widget">
        <a href="https://www.paypal.me/jameschambers/3.5usd" target="_blank"><img src="/content/coffee.png"></a>
    </div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">tag cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/30DaysMvcBootstrap/" style="font-size: 17.86px;">30DaysMvcBootstrap</a> <a href="/tags/8DaysOfTableStorage/" style="font-size: 11.43px;">8DaysOfTableStorage</a> <a href="/tags/ASP-NET/" style="font-size: 15px;">ASP.NET</a> <a href="/tags/ASP-NET-5/" style="font-size: 10.71px;">ASP.NET 5</a> <a href="/tags/ASP-NET-Core/" style="font-size: 12.86px;">ASP.NET Core</a> <a href="/tags/ASP-NET-Core-MVC/" style="font-size: 10px;">ASP.NET Core MVC</a> <a href="/tags/ActionFilters/" style="font-size: 10px;">ActionFilters</a> <a href="/tags/AllReady/" style="font-size: 10px;">AllReady</a> <a href="/tags/Android/" style="font-size: 10.71px;">Android</a> <a href="/tags/AngelaSmith/" style="font-size: 10px;">AngelaSmith</a> <a href="/tags/Asp-Net-MVC/" style="font-size: 20px;">Asp.Net MVC</a> <a href="/tags/Authentication/" style="font-size: 10.71px;">Authentication</a> <a href="/tags/Azure/" style="font-size: 17.14px;">Azure</a> <a href="/tags/Azure-Functions/" style="font-size: 10px;">Azure Functions</a> <a href="/tags/Azure-Web-Apps/" style="font-size: 10px;">Azure Web Apps</a> <a href="/tags/Azure-Websites/" style="font-size: 13.57px;">Azure Websites</a> <a href="/tags/BUILD/" style="font-size: 10px;">BUILD</a> <a href="/tags/BitBucket/" style="font-size: 10px;">BitBucket</a> <a href="/tags/Bootstrap/" style="font-size: 15.71px;">Bootstrap</a> <a href="/tags/CTT-NUG/" style="font-size: 10px;">CTT .NUG</a> <a href="/tags/Calgary/" style="font-size: 10px;">Calgary</a> <a href="/tags/Cisco-VPN/" style="font-size: 10px;">Cisco VPN</a> <a href="/tags/ClearMeasure/" style="font-size: 10.71px;">ClearMeasure</a> <a href="/tags/CodeProject/" style="font-size: 11.43px;">CodeProject</a> <a href="/tags/Conferences/" style="font-size: 10.71px;">Conferences</a> <a href="/tags/CouchDb/" style="font-size: 10px;">CouchDb</a> <a href="/tags/DNX/" style="font-size: 10px;">DNX</a> <a href="/tags/Dojo/" style="font-size: 10px;">Dojo</a> <a href="/tags/Email/" style="font-size: 10px;">Email</a> <a href="/tags/Entity-Framework/" style="font-size: 13.57px;">Entity Framework</a> <a href="/tags/Extension-Methods/" style="font-size: 10px;">Extension Methods</a> <a href="/tags/FontAwesome/" style="font-size: 10.71px;">FontAwesome</a> <a href="/tags/GenFu/" style="font-size: 10px;">GenFu</a> <a href="/tags/GetManifestResourceStream/" style="font-size: 10px;">GetManifestResourceStream</a> <a href="/tags/Git/" style="font-size: 11.43px;">Git</a> <a href="/tags/HTML5/" style="font-size: 10px;">HTML5</a> <a href="/tags/HackAThon/" style="font-size: 10px;">HackAThon</a> <a href="/tags/HtmlHelper/" style="font-size: 10px;">HtmlHelper</a> <a href="/tags/IIS/" style="font-size: 10px;">IIS</a> <a href="/tags/JSON/" style="font-size: 10.71px;">JSON</a> <a href="/tags/Keynote/" style="font-size: 10px;">Keynote</a> <a href="/tags/Life-Hack/" style="font-size: 10px;">Life Hack</a> <a href="/tags/Life-Hacking/" style="font-size: 10.71px;">Life Hacking</a> <a href="/tags/Life-Hacks/" style="font-size: 12.86px;">Life Hacks</a> <a href="/tags/Linq/" style="font-size: 10px;">Linq</a> <a href="/tags/MIX11/" style="font-size: 10px;">MIX11</a> <a href="/tags/MVA/" style="font-size: 10.71px;">MVA</a> <a href="/tags/MVC/" style="font-size: 19.29px;">MVC</a> <a href="/tags/MVC5/" style="font-size: 18.57px;">MVC5</a> <a href="/tags/MVC6/" style="font-size: 13.57px;">MVC6</a> <a href="/tags/MVP/" style="font-size: 10px;">MVP</a> <a href="/tags/Make-Code-Not-War/" style="font-size: 10px;">Make Code Not War</a> <a href="/tags/MeasureUp/" style="font-size: 10px;">MeasureUp</a> <a href="/tags/Metro/" style="font-size: 10px;">Metro</a> <a href="/tags/Microsoft/" style="font-size: 10px;">Microsoft</a> <a href="/tags/Microsoft-Band/" style="font-size: 12.14px;">Microsoft Band</a> <a href="/tags/Mobile/" style="font-size: 10px;">Mobile</a> <a href="/tags/Mobile-Services/" style="font-size: 10px;">Mobile Services</a> <a href="/tags/Motivate/" style="font-size: 10px;">Motivate</a> <a href="/tags/MvcScaffolding/" style="font-size: 11.43px;">MvcScaffolding</a> <a href="/tags/Not-Coding-At-All/" style="font-size: 10px;">Not Coding At All</a> <a href="/tags/NuGet/" style="font-size: 15px;">NuGet</a> <a href="/tags/OData/" style="font-size: 10px;">OData</a> <a href="/tags/PayPal/" style="font-size: 10px;">PayPal</a> <a href="/tags/PostSharp/" style="font-size: 10px;">PostSharp</a> <a href="/tags/Practice/" style="font-size: 10.71px;">Practice</a> <a href="/tags/Practice-of-Awesome/" style="font-size: 10px;">Practice of Awesome</a> <a href="/tags/PrairieDevCon/" style="font-size: 16.43px;">PrairieDevCon</a> <a href="/tags/Queues/" style="font-size: 10px;">Queues</a> <a href="/tags/REST/" style="font-size: 10px;">REST</a> <a href="/tags/Radio/" style="font-size: 10px;">Radio</a> <a href="/tags/Razor/" style="font-size: 10.71px;">Razor</a> <a href="/tags/Real-Life/" style="font-size: 10px;">Real Life</a> <a href="/tags/Regina/" style="font-size: 10.71px;">Regina</a> <a href="/tags/Remote-Work/" style="font-size: 11.43px;">Remote Work</a> <a href="/tags/Resolve/" style="font-size: 10px;">Resolve</a> <a href="/tags/Rock-Paper-Scissors/" style="font-size: 10px;">Rock Paper Scissors</a> <a href="/tags/Routing/" style="font-size: 10px;">Routing</a> <a href="/tags/Ruby-on-Rails/" style="font-size: 10px;">Ruby on Rails</a> <a href="/tags/SDEC/" style="font-size: 10px;">SDEC</a> <a href="/tags/SOAP/" style="font-size: 10px;">SOAP</a> <a href="/tags/SQL-Server/" style="font-size: 10px;">SQL Server</a> <a href="/tags/ServiceBus/" style="font-size: 10px;">ServiceBus</a> <a href="/tags/SignalR/" style="font-size: 11.43px;">SignalR</a> <a href="/tags/Speaking/" style="font-size: 11.43px;">Speaking</a> <a href="/tags/TFS/" style="font-size: 10px;">TFS</a> <a href="/tags/Table-Storage/" style="font-size: 10.71px;">Table Storage</a> <a href="/tags/TypeScript/" style="font-size: 10px;">TypeScript</a> <a href="/tags/Unit-Testing/" style="font-size: 10px;">Unit Testing</a> <a href="/tags/Visual-Studio/" style="font-size: 10.71px;">Visual Studio</a> <a href="/tags/Visual-Studio-11/" style="font-size: 11.43px;">Visual Studio 11</a> <a href="/tags/Visual-Studio-2010/" style="font-size: 16.43px;">Visual Studio 2010</a> <a href="/tags/Visual-Studio-2012/" style="font-size: 12.86px;">Visual Studio 2012</a> <a href="/tags/Visual-Studio-2013/" style="font-size: 10.71px;">Visual Studio 2013</a> <a href="/tags/Visual-Studio-2015/" style="font-size: 15.71px;">Visual Studio 2015</a> <a href="/tags/WCF/" style="font-size: 10.71px;">WCF</a> <a href="/tags/Web-API/" style="font-size: 11.43px;">Web API</a> <a href="/tags/Web-Development/" style="font-size: 10px;">Web Development</a> <a href="/tags/Web-Services/" style="font-size: 10.71px;">Web Services</a> <a href="/tags/Windows-8/" style="font-size: 11.43px;">Windows 8</a> <a href="/tags/Windows-Azure/" style="font-size: 10px;">Windows Azure</a> <a href="/tags/Windows-Phone/" style="font-size: 14.29px;">Windows Phone</a> <a href="/tags/Windws-Live-Writer/" style="font-size: 10px;">Windws Live Writer</a> <a href="/tags/Winnipeg/" style="font-size: 10.71px;">Winnipeg</a> <a href="/tags/c/" style="font-size: 12.14px;">c#</a> <a href="/tags/compiling/" style="font-size: 10px;">compiling</a> <a href="/tags/jQuery/" style="font-size: 12.14px;">jQuery</a> <a href="/tags/jQuery-UI/" style="font-size: 10.71px;">jQuery UI</a> <a href="/tags/node/" style="font-size: 10px;">node</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/open-source/" style="font-size: 10.71px;">open source</a> <a href="/tags/reflection/" style="font-size: 10px;">reflection</a> <a href="/tags/seed-data/" style="font-size: 10px;">seed data</a> <a href="/tags/testing/" style="font-size: 10px;">testing</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/">2016</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/">2015</a><span class="archive-list-count">36</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/">2014</a><span class="archive-list-count">42</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/">2013</a><span class="archive-list-count">17</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/">2012</a><span class="archive-list-count">41</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/">2011</a><span class="archive-list-count">36</span></li></ul>
    </div>
  </div>

  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 1999 - 2016 James Chambers<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script>
  var disqus_shortname = 'jameschambers';
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



 <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>




  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>