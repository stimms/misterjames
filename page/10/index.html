<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>They Call Me Mister James</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This is the blog of James Chambers, a senior developer on the .NET stack">
<meta property="og:type" content="website">
<meta property="og:title" content="They Call Me Mister James">
<meta property="og:url" content="http://jameschambers.com/page/10/index.html">
<meta property="og:site_name" content="They Call Me Mister James">
<meta property="og:description" content="This is the blog of James Chambers, a senior developer on the .NET stack">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="They Call Me Mister James">
<meta name="twitter:description" content="This is the blog of James Chambers, a senior developer on the .NET stack">
<meta name="twitter:creator" content="@CanadianJames">
<meta name="twitter:site" content="CanadianJames">
  
  
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="content/avatar.png">
  
  
 <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
 <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>


  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" type="text/css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-2868185-6', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  

  
  <script src="//load.sumome.com/" data-sumo-site-id="34f480920bcf5ea13ec1605be65d32e86be89fb7177416fb68c2d2f1939aaa04" async="async"></script>
</head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo" style="background-image: url(/content/logo_round.png)"></i><span class="site-title">They Call Me Mister James</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/.">Home</a>
        
          <a class="main-nav-link" href="/about/bootstrapping-mvc.html">Boostrapping MVC</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">Testimonials</a>
        
          <a class="main-nav-link" href="/about/genfu.html">GenFu</a>
        
        <a class="main-nav-link main-nav-link-highlight" href="https://hireme.jameschambers.com" target="_blank">Hire Me</a>
      </nav>
      
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/content/avatar.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
      
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="http://jameschambers.com"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
        
          <td><a class="main-nav-link" href="/.">Home</a></td>
        
          <td><a class="main-nav-link" href="/about/bootstrapping-mvc.html">Boostrapping MVC</a></td>
        
          <td><a class="main-nav-link" href="/archives">Archives</a></td>
        
          <td><a class="main-nav-link" href="/about">Testimonials</a></td>
        
          <td><a class="main-nav-link" href="/about/genfu.html">GenFu</a></td>
        
        <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://jameschambers.com"></form>
        </td>
      </tr>
    </table>
  </div>
</header>

    <div class="outer">
      
        <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <h2 id="name">James Chambers</h2>
      <h3 id="title">Husband, Father, Mentor, Humanitarian &amp; Software Developer</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Canada</span>
      <a id="follow" href="https://twitter.com/canadianjames">FOLLOW</a>
    </div>

    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
          <td><a href="/CanadianJames" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></td>
          
          <td><a href="http://github.com/MisterJames" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
          
          <td><a href="/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
          
          <td><a href="https://ca.linkedin.com/in/canadianjames" target="_blank" title="linkedin"><i class="fa fa-linkedin"></i></a></td>
          
          <td><a href="https://www.youtube.com/user/CodingMisterJames/" target="_blank" title="youtube"><i class="fa fa-youtube"></i></a></td>
          
        </tr>
      </table>
    </div>
    

    <div class="base-info profile-block">
        <a href="http://aspnetmonsters.com" target="_blank"><img src="/content/monster-james.png"></a>      
    </div>

    <div class="base-info profile-block">
        <a href="https://leanpub.com/bootstrappingmvc" onclick="_gaq.push(['_trackEvent', 'outbound-widget', 'https://leanpub.com/bootstrappingmvc', '\n\n']);">
            <img src="https://s3.amazonaws.com/titlepages.leanpub.com/bootstrappingmvc/medium?1425560219" scale="0">
        </a>
    </div>
        
    
  </div>
</aside>

      
      <section id="main">
      <article id="post-day-30-loading-bootstrap-modal-content-via-ajax" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/day-30-loading-bootstrap-modal-content-via-ajax/">Day 30: Loading Bootstrap Modal Content via AJAX</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2014/07/day-30-loading-bootstrap-modal-content-via-ajax/">
      <time datetime="2014-07-20T10:58:00.000Z" itemprop="datePublished">2014-07-20</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>This is <strong>the final</strong> installment in a 30 day series on Bootstrap and the MVC Framework. To see the rest of the series be sure to check out <a href="http://jameschambers.com/2014/06/day-0-boothstrapping-mvc-for-the-next-30-days/">Day 0 for an index</a>. I hope you have enjoyed following along! <img src="https://jcblogimages.blob.core.windows.net/img/2014/07/wlEmoticon-smile1.png" alt="Smile"></p>
<p>Here in our last post in the series we’re going to revisit our modal dialog confirmation box that pops up when a user tries to delete a record. At this point, regardless of the notification selected for delete, the user will see the same static dialog.</p>
<h2 id="Loading_Remote_Content_With_Bootstrap_u2019s_Modal"><a href="#Loading_Remote_Content_With_Bootstrap_u2019s_Modal" class="headerlink" title="Loading Remote Content With Bootstrap’s Modal"></a>Loading Remote Content With Bootstrap’s Modal</h2><p>There is built-in support for Bootstrap to load content into a modal, but there are some limitations. First, Bootstrap loads the content the first time the constructor is called on the modal. Secondly, the modal’s constructor is only ever called once, meaning, you can’t refresh the content without some extra script.</p>
<p>Rather than trying to put a square peg in a round hole, we can take the simpler approach of just loading the content with jQuery. After all, it’s clean, easy to understand, and at the end of the day the modal is just HTML.</p>
<p>This approach will work better for us for the following use case:</p>
<ul>
<li>User selects to delete a notification</li>
<li>They cancel out of the dialog</li>
<li>The select a different notification to delete </li>
</ul>
<p>At this point, the remote loading capabilities of Bootstrap’s modal break down and we’d have to get into hacky stuff that may not survive a minor version upgrade. Pass! In my opinion, the modal should have an overload that accepts a ‘remote url’ parameter.</p>
<p>If, however, you have a use case that doesn’t involve refreshing the dialog, I encourage you to check out <a href="http://getbootstrap.com/javascript/#modals-usage" target="_blank" rel="external">the docs</a> for using the built-in functionality.</p>
<h2 id="Improving_our_Delete_Confirmation"><a href="#Improving_our_Delete_Confirmation" class="headerlink" title="Improving our Delete Confirmation"></a>Improving our Delete Confirmation</h2><p>Rather than just giving a generic message, we’re going to instead load some content via AJAX. This will give us a chance to put a visual preview of the data that will be deleted in front of the user.</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image14.png" alt="image" title="image"></p>
<p>To accomplish this we’re going to need to make small change to our modal markup (in Views\Account_RenderNotifications.Modal.cshtml), as follows:</p>
<p><pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">=”modal-body”</span> <span class="attr">id</span><span class="kwrd">=”notificationPreview”</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span>Loading content…<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span><br><span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>What I’ve done here is removed the content from the modal-body section of the markup and replaced it with a loading message.&nbsp; I’ve also given the DIV an ID so that we can address it from JavaScript more directly.&nbsp; Also, revisit your Views\Account_RenderNotifications.js.cshtml and update the confirmDelete method, as we’re now going to clear the contents and load the text dynamically.</p>
<p><pre class="csharpcode"><span class="kwrd">function</span> confirmDelete(id) {<br>    currentNotificationId = id;<br>    previewContainer.html(<span class="str">‘&lt;p&gt;Loading content…&lt;/p&gt;’</span>);<br>    previewContainer.load(confirmUrl, { id: currentNotificationId });<br>    $(<span class="str">‘#deleteConfirmModal’</span>).modal(<span class="str">‘show’</span>);<br>}</pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>To pull that all together we need a couple more variable declarations at the top of the script. Here’s my final list of vars:</p>
<p><pre class="csharpcode"><span class="kwrd">var</span> readUrl = <span class="str">‘@Url.Action(“MarkNotificationAsRead”)’</span>;<br><span class="kwrd">var</span> deleteUrl = <span class="str">‘@Url.Action(“Delete”)’</span>;<br><span class="kwrd">var</span> confirmUrl = <span class="str">‘@Url.Action(“GetNotification”)’</span>;<br><span class="kwrd">var</span> previewContainer = $(<span class="str">‘#deleteConfirmModal #notificationPreview’</span>);<br><span class="kwrd">var</span> currentNotificationId;</pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>You’ll notice that I have added a confirm URL and captured the element (in previewContainer) that we are using for the confirm. This saves me from having to requery the DOM on each display of the dialog.</p>
<h2 id="Adding_the_Controller_Action"><a href="#Adding_the_Controller_Action" class="headerlink" title="Adding the Controller Action"></a>Adding the Controller Action</h2><p>We’re going to use that same pattern for loading up the notification for the confirmation that we used for modifying and deleting. Let’s add a GetNotification method to our AccountController that has the following code:</p>
<p><pre class="csharpcode"><span class="kwrd">public</span> ActionResult GetNotification(<span class="kwrd">int</span> id)<br>{<br>    var userNotification = GetUserNotifications().FirstOrDefault(n =&gt; n.NotificationId == id);</pre></p>
<pre><code>&lt;span class=&quot;kwrd&quot;&gt;if&lt;/span&gt; (userNotification == &lt;span class=&quot;kwrd&quot;&gt;null&lt;/span&gt;)
{
    &lt;span class=&quot;kwrd&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kwrd&quot;&gt;new&lt;/span&gt; HttpNotFoundResult();
}

&lt;span class=&quot;kwrd&quot;&gt;return&lt;/span&gt; PartialView(&lt;span class=&quot;str&quot;&gt;&quot;_RenderNotifications.ModalPreview&quot;&lt;/span&gt;, userNotification);
</code></pre><p>}<br></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>This time, we’ll be returning a partial view, as indicated in the code above, that will help us render the relevant content for the user to make their choice.</p>
<p>But hey…that code to load a single notification for the logged in user is <em>crying</em> for some refactoring, am I right?</p>
<h2 id="Adding_the_Partial_View"><a href="#Adding_the_Partial_View" class="headerlink" title="Adding the Partial View"></a>Adding the Partial View</h2><p>The controller is wired to pass the single notification to a partial view, which will essentially have the same information we had in the content section of the modal markup, but now we’ll also render in some notification-specific information. You can use your imagination on how this could be further extended with more complex objects in your own project.</p>
<p>Here are the contents of _RenderNotifications.ModalPreview.cshtml, which you should put into Views\Account:</p>
<p><pre class="csharpcode">@model SimpleSite.Models.Notification</pre></p>
<p><span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span>You have selected to delete this notification.<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span><br><span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">=”panel panel-warning”</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">=”panel-heading”</span><span class="kwrd">&gt;</span><br>            <span class="kwrd">&lt;</span><span class="html">h4</span><span class="kwrd">&gt;</span>@Model.Title<span class="kwrd">&lt;/</span><span class="html">h4</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">=”panel-body”</span><span class="kwrd">&gt;</span><br>            If this was the action that you wanted to do,<br>            please confirm your choice, or cancel and return<br>            to the page.<br>        <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span><br><span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<h2 id="Next_Steps"><a href="#Next_Steps" class="headerlink" title="Next Steps"></a>Next Steps</h2><p>Wow! Thirty days of Bootstrap and MVC! It’s been a long 30 days…50 days actually, but no one could have foreseen the passing of my Grandma, my three-day fever of 103 degrees or the fact that this would end up running into my vacation for my 14th wedding anniversary and <em>a most excellent trip</em> to Seattle with my high school sweetheart (to whom I am married).</p>
<p>I have a few more things to add to this series, but for now we’ll call it a wrap. Thanks for your questions, suggestions, feedback and comments along the way!</p>
<p>Happy coding! <img src="https://jcblogimages.blob.core.windows.net/img/2014/07/wlEmoticon-smile1.png" alt="Smile"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2014/07/day-30-loading-bootstrap-modal-content-via-ajax/" data-id="civiom2gv00i2bwyyd0m9oszk" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2014/07/day-30-loading-bootstrap-modal-content-via-ajax/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/30DaysMvcBootstrap/">30DaysMvcBootstrap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC5/">MVC5</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-day-29-confirmation-dialogs-for-delete-actions" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/day-29-confirmation-dialogs-for-delete-actions/">Day 29: Confirmation Dialogs for Delete Actions</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2014/07/day-29-confirmation-dialogs-for-delete-actions/">
      <time datetime="2014-07-20T03:57:00.000Z" itemprop="datePublished">2014-07-19</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>This is an installment in a 30 day series on Bootstrap and the MVC Framework. To see more, check out <a href="http://jameschambers.com/2014/06/day-0-boothstrapping-mvc-for-the-next-30-days/">Day 0 for an index</a>.</p>
<p>We just gave our users the ability to delete a record from the database in <a href="http://jameschambers.com/2014/07/day-28-doing-more-interesting-things-with-buttons/">Day 28</a>, but a single click does the deed without confirmation. It would likely be better to at least give them a little prompt to confirm that this is what they were trying to do in the first place.</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image11.png" alt="image" title="image"></p>
<p>Let’s first talk about how dialogs are composed and how to display them in a page.</p>
<h2 id="Bootstrap_Modal_Dialogs"><a href="#Bootstrap_Modal_Dialogs" class="headerlink" title="Bootstrap Modal Dialogs"></a>Bootstrap Modal Dialogs</h2><p>Modals are made up of a wrapper, an outer and inner container and three common sections that provide default styling and handle proper rendering: the header, the body and the footer. You can represent the basic structure of the modal as follows:</p>
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="modal"</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="modal-dialog"</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="modal-content"</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="modal-header"</span><span class="kwrd">&gt;</span>...<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="modal-body"</span><span class="kwrd">&gt;</span>...<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="modal-footer"</span><span class="kwrd">&gt;</span>...<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

You can show a dialog by using a button with an attribute that Bootstrap is aware of:
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">button</span> <span class="attr">class</span><span class="kwrd">="btn"</span> <span class="attr">data-toggle</span><span class="kwrd">="modal"</span> <span class="attr">data-target</span><span class="kwrd">="#theModal"</span><span class="kwrd">&gt;</span>
  Show my modal
<span class="kwrd">&lt;/</span><span class="html">button</span><span class="kwrd">&gt;</span></pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

Or you can invoke the modal by calling it from JavaScript:
<pre class="csharpcode">$(<span class="str">'#deleteConfirmModal'</span>).modal(<span class="str">'show'</span>);</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

For other events, defaults and other JavaScript method calls that are available, be sure to check out the docs on the [Bootstrap site](http://getbootstrap.com/javascript/#modals).

When using modals you’ll want as little interference as possible with the styles and layout of the elements being used, so the recommendation is to put the container for the modal as close to the root of the document structure as possible. 

One thing that I’ve run into when using the button approach is the need to have the CSS selector on the data-target attribute (see the code above). I’m not sure why this is the approach, but if you forget that you need the hashtag as a prefix to the ID, your modal won’t display. Regardless, we’re going to be using JavaScript to do our work today, but keep that tip in mind as you start working with this on&nbsp; your own.

## The Game Plan

For this exercise we’re going to hit a couple of areas of the project, so here’s a quick checklist if you want to follow along. We’re going to:

*   Clean up our JavaScript and put it in a separate file
*   Add an optionally rendered section to our _Layout page
*   Add a partial view for the markup needed for our dialog
*   Update the Manage view to include our new bits

## Some Cleanup, Some JavaScript

We’re going to start growing our client-side scripts on the view that renders notifications a little and one thing I like to do is to keep those bits organized. The JavaScript we have so far to give some UX for notifications is in our _RenderNotifications partial view, which presents some limitations as to when script can execute and whether or not jQuery has been loaded. 

One easy way to keep these things straight, and organized in our project, is to add a __**PartialViewName**_.js.cshtml file to our project in the same folder as our view. We can then consider the JavaScript related to the view as another asset that needs to be loaded on the full view.

So let’s do that. Add a new view to the Views\Account folder called _RenderNotificationsjs. If you use the scaffolding tools, you’ll notice that you can’t properly name it (it complains about invalid characters), so add it as I’ve shown, then rename it to _RenderNotifications.js.cshtml once the file is there.&nbsp; Next, remove the old JavaScript from the _RenderNotifications.cshtml and put it in the new .js.cshtml file.
<pre class="csharpcode">&lt;script type=<span class="str">"text/javascript"</span>&gt;

    <span class="kwrd">var</span> readUrl = <span class="str">'@Url.Action("MarkNotificationAsRead")'</span>;
    <span class="kwrd">var</span> deleteUrl = <span class="str">'@Url.Action("Delete")'</span>;
    <span class="kwrd">var</span> currentNotificationId;

    <span class="kwrd">function</span> updateNotification(id, action) {
        $(<span class="str">"#notificationFormItemId"</span>).val(id);
        <span class="kwrd">switch</span> (action) {
        <span class="kwrd">case</span> <span class="str">'read'</span>:
            $(<span class="str">"#notificationForm"</span>).attr(<span class="str">'action'</span>, readUrl).submit();
            <span class="kwrd">break</span>;
        <span class="kwrd">case</span> <span class="str">'delete'</span>:
            $(<span class="str">"#notificationForm"</span>).attr(<span class="str">'action'</span>, deleteUrl).submit();
            <span class="kwrd">break</span>;
        <span class="kwrd">default</span>:
            console.debug(<span class="str">'Unknown action '</span> + action);
        }
    }

    <span class="kwrd">function</span> confirmDelete(id) {
        currentNotificationId = id;
        $(<span class="str">'#deleteConfirmModal'</span>).modal(<span class="str">'show'</span>);
    }

    $(<span class="kwrd">function</span>() {
        $(<span class="str">"#deleteConfirmModal"</span>).on(<span class="str">'click'</span>, <span class="str">"#deleteConfirm"</span>, <span class="kwrd">function</span>() {
            updateNotification(currentNotificationId, <span class="str">'delete'</span>);
        });
    });

&lt;/script&gt;</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

Remember that .cshtml gives us a little more power than just a straight .js file. We can do things like interact with the ViewBag or the page Model, write code that is parsed by Razor and make use of Html helper methods, all of which can be quite handy.

There’s not too much more going on here than there was before, except that now we capture the ID of the notification in our confirmDelete method, and we are wiring up a click handler for the modal dialog that we’re going to implement.

One final thing to do on our partial is to update the Delete button (the A tag) to call our new JavaScript method as follows:
<pre class="csharpcode">&lt;a href=<span class="str">"javascript:confirmDelete(@notification.NotificationId)"</span>&gt;Delete&lt;/a&gt;</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

## Rendering at the Root Using Optional Sections in our Layout

Remember the note about keeping the modal as close to the document root as possible? Well, there’s a problem there when we’re down at the view or partial view layer, stuck inside our other “main content” area of the page. We’re inside all these other containers already and we can’t break out without a little help from the MVC Framework.&nbsp; What we want to do is to add another optional section, much like the scripts section. We can call this topLevel for now, though you’d likely want it to be more meaningful in a real project.&nbsp; Add the following code to your _Layout file.
<pre class="csharpcode">@RenderSection(<span class="str">"topLevel"</span>, required: <span class="kwrd">false</span>)</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

It should appear right after the BODY tag, first thing in the document, like this.

![image](https://jcblogimages.blob.core.windows.net/img/2014/07/image12.png "image")

Now, whenever you have something that will be injected from a view into the page in this topLevel section, you will be able to put elements directly into the root of the document.

## Create the Modal Partial

Next up, we’re going to create a _RenderNotification.Modal.cshtml partial view that has the HTML for our modal in it. This will help to keep our core view simple, and keep our related files together in our project.&nbsp; The markup for the modal follows the same basic structure I highlighted above and adds a few other elements to the mix.
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="modal fade"</span> <span class="attr">id</span><span class="kwrd">="deleteConfirmModal"</span> <span class="attr">tabindex</span><span class="kwrd">="-1"</span> <span class="attr">role</span><span class="kwrd">="dialog"</span> <span class="attr">aria-labelledby</span><span class="kwrd">="deleteLabel"</span> <span class="attr">aria-hidden</span><span class="kwrd">="true"</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="modal-dialog"</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="modal-content"</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="modal-header"</span><span class="kwrd">&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">h4</span> <span class="attr">class</span><span class="kwrd">="modal-title"</span> <span class="attr">id</span><span class="kwrd">="deleteLabel"</span><span class="kwrd">&gt;</span>Deleting a Notification<span class="kwrd">&lt;/</span><span class="html">h4</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="modal-body"</span><span class="kwrd">&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span>You have selected to delete this notification.<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span>
                    If this was the action that you wanted to do,
                    please confirm your choice, or cancel and return
                    to the page.
                <span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="modal-footer"</span><span class="kwrd">&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">button</span> <span class="attr">type</span><span class="kwrd">="button"</span> <span class="attr">class</span><span class="kwrd">="btn btn-success"</span> <span class="attr">data-dismiss</span><span class="kwrd">="modal"</span><span class="kwrd">&gt;</span>Cancel<span class="kwrd">&lt;/</span><span class="html">button</span><span class="kwrd">&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">button</span> <span class="attr">type</span><span class="kwrd">="button"</span> <span class="attr">class</span><span class="kwrd">="btn btn-danger"</span> <span class="attr">id</span><span class="kwrd">="deleteConfirm"</span><span class="kwrd">&gt;</span>Delete Notification<span class="kwrd">&lt;/</span><span class="html">button</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

There’s a class ‘fade’ in there that tells bootstrap to slide and fade the modal in from the top. There are a few ARIA attributes in there for accessibility.&nbsp; I’ve added a title to the header, content in the body and buttons to either dismiss the dialog (cancelling the delete) or to confirm the operation when the user elects to delete the notification.

Perhaps the most interesting bit in there is the data-dismiss attribute on the cancel button, which tells Bootstrap that this dialog can be hidden when the button is clicked.

## Updating Our View

Finally, we update our view, adding the modal to the page and including the JavaScript that we need to pull it all together.

At the bottom of Manage.cshtml in Views\Account we add the topLevel section to the view and in it we render the modal markup from the partial view we created. 
<pre class="csharpcode">@section topLevel{

    @{ Html.RenderPartial(<span class="str">"_RenderNotifications.Modal"</span>); }

}
</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

Immediately after that, we update our scripts section to include the JS we need and created above.
<pre class="csharpcode">@section Scripts { 

    @Scripts.Render(<span class="str">"~/bundles/jqueryval"</span>) 
    @{ Html.RenderPartial(<span class="str">"_RenderNotifications.js"</span>); }

}</pre>

<p>Because we’ve kept things fairly organized along the way, changes to our view are minimal but at the same time we’re able to improve the user experience a fair bit. We’ve added an easy way to get content into the root of our document and simplified our partial views. And look…</p>
<p><a href="https://jcblogimages.blob.core.windows.net/img/2014/07/image13.png" target="_blank" rel="external"><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image_thumb3.png" alt="image" title="image"></a></p>
<p>…we even managed to keep our related files in one place in the solution explorer.&nbsp; <style type="text/css">.csharpcode, .csharpcode pre<br>{<br>    font-size: small;<br>    color: black;<br>    font-family: consolas, “Courier New”, courier, monospace;<br>    background-color: #ffffff;<br>    /<em>white-space: pre;</em>/<br>}<br>.csharpcode pre { margin: 0em; }<br>.csharpcode .rem { color: #008000; }<br>.csharpcode .kwrd { color: #0000ff; }<br>.csharpcode .str { color: #006080; }<br>.csharpcode .op { color: #0000c0; }<br>.csharpcode .preproc { color: #cc6633; }<br>.csharpcode .asp { background-color: #ffff00; }<br>.csharpcode .html { color: #800000; }<br>.csharpcode .attr { color: #ff0000; }<br>.csharpcode .alt<br>{<br>    background-color: #f4f4f4;<br>    width: 100%;<br>    margin: 0em;<br>}<br>.csharpcode .lnum { color: #606060; }<br></style></p>
<h2 id="Next_Steps"><a href="#Next_Steps" class="headerlink" title="Next Steps"></a>Next Steps</h2><p>Our delete is now protected by the dialog, but we’d like to give the user a better picture of what it is they are deleting from the database. Tomorrow, in our last post in the series, we’ll look at wiring up the dialog box to load contents via AJAX. </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2014/07/day-29-confirmation-dialogs-for-delete-actions/" data-id="civiom2h800igbwyyige311im" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2014/07/day-29-confirmation-dialogs-for-delete-actions/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/30DaysMvcBootstrap/">30DaysMvcBootstrap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC5/">MVC5</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-day-28-doing-more-interesting-things-with-buttons" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/day-28-doing-more-interesting-things-with-buttons/">Day 28: Doing More Interesting Things With Buttons</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2014/07/day-28-doing-more-interesting-things-with-buttons/">
      <time datetime="2014-07-19T03:25:00.000Z" itemprop="datePublished">2014-07-18</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>This is an installment in a 30 day series on Bootstrap and the MVC Framework. To see more, check out <a href="http://jameschambers.com/2014/06/day-0-boothstrapping-mvc-for-the-next-30-days/">Day 0 for an index</a>.</p>
<p>Using the styling of Bootstrap or a replacement theme is a great way to make your site stand out, and buttons are a great example of making the UI more rich and friendly to users. They are likely the first thing you’d write some CSS for if you were starting from scratch on your site, so the tweaks and highlights they offer out-of-box are quite welcome.</p>
<h2 id="Basic_Buttons"><a href="#Basic_Buttons" class="headerlink" title="Basic Buttons"></a>Basic Buttons</h2><p>If you don’t style your buttons, they’re going to kinda suck. Well…it’s not that they won’t work or anything, but you will just get the boring old browser-styled version of a button.</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image6.png" alt="image" title="image"></p>
<p>And because each browser has it’s own default stylesheet, you can’t be guaranteed that any user will see the same font, layout or spacing. Thankfully, enforcing these attributes across clients is only an attribute away.</p>
<p><pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">button</span> <span class="attr">type</span><span class="kwrd">=”button”</span> <span class="attr">class</span><span class="kwrd">=”btn btn-primary btn-sm”</span><span class="kwrd">&gt;</span>A button<span class="kwrd">&lt;/</span><span class="html">button</span><span class="kwrd">&gt;</span><br><span class="kwrd">&lt;</span><span class="html">button</span> <span class="attr">type</span><span class="kwrd">=”button”</span> <span class="attr">class</span><span class="kwrd">=”btn btn-success btn-sm”</span><span class="kwrd">&gt;</span>Another button<span class="kwrd">&lt;/</span><span class="html">button</span><span class="kwrd">&gt;</span><br></pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>You’ll notice that I used the btn-sm class in the source above, there are large (btn-lg), regular (no class needed), small (btn-sm) and extra-small (btn-xs) to choose from. And now my buttons look like so, in every browser:</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image7.png" alt="image" title="image"></p>
<p>If I want them to be the same width, I can also use the grid system for sizing, dropping, say, a col-md-4 into the class attribute to get the following result:</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image8.png" alt="image" title="image"></p>
<h2 id="Grouping_Things_Together"><a href="#Grouping_Things_Together" class="headerlink" title="Grouping Things Together"></a>Grouping Things Together</h2><p>The buttons look better now, but they’re bumping up against each other. They’d look better still if they looked like they were part of the same control group. We can assemble buttons into groups by providing a touch more markup to the elements, as seen below, with a simple DIV wrapper.</p>
<p><pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">=”btn-group”</span><span class="kwrd">&gt;</span><br>    <span class="rem">&lt;!– buttons here –&gt;</span><br><span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span><br></pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image9.png" alt="image" title="image"></p>
<p>I changed the text here because this is the code that I’ll be working into my partial for the notifications.&nbsp; I also made the buttons the same color – from a design stand point I think it looks better (and, heck, I’m even color blind) – and I removed the grid sizing on the buttons to allow them to group properly without having to add custom CSS styles. </p>
<h2 id="Putting_Some_Fancy_On"><a href="#Putting_Some_Fancy_On" class="headerlink" title="Putting Some Fancy On"></a>Putting Some Fancy On</h2><p>Chances are we could get away here with the two buttons side-by-each, but in the event that we need to add more actions the page is going to start to get a little wide. An improvement we can make here is to give the users a default action, but then to put the rest of the less-commonly accessed actions into a dropdown to look like this:</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image10.png" alt="image" title="image"></p>
<p>This is called a split button dropdown, where a clickable action is available and additional commands are tucked into the drop down. Rather than wrapping the buttons in just a DIV, we also introduce a caret for the dropdown and have a UL to act as a container for the non-visible actions.</p>
<p><pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">=”btn-group”</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">button</span> <span class="attr">type</span><span class="kwrd">=”button”</span> <span class="attr">class</span><span class="kwrd">=”btn btn-success btn-sm”</span><span class="kwrd">&gt;</span>Mark as Read<span class="kwrd">&lt;/</span><span class="html">button</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">button</span> <span class="attr">type</span><span class="kwrd">=”button”</span> <span class="attr">class</span><span class="kwrd">=”btn btn-success btn-sm dropdown-toggle”</span> <span class="attr">data-toggle</span><span class="kwrd">=”dropdown”</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">span</span> <span class="attr">class</span><span class="kwrd">=”caret”</span><span class="kwrd">&gt;&lt;/</span><span class="html">span</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">span</span> <span class="attr">class</span><span class="kwrd">=”sr-only”</span><span class="kwrd">&gt;</span>Toggle Dropdown<span class="kwrd">&lt;/</span><span class="html">span</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;/</span><span class="html">button</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">ul</span> <span class="attr">class</span><span class="kwrd">=”dropdown-menu”</span> <span class="attr">role</span><span class="kwrd">=”menu”</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">=”#”</span><span class="kwrd">&gt;</span>Delete<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">=”#”</span><span class="kwrd">&gt;</span>Send SMS<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">=”#”</span><span class="kwrd">&gt;</span>Make cheese<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">li</span> <span class="attr">class</span><span class="kwrd">=”divider”</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">=”#”</span><span class="kwrd">&gt;</span>Baz<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;/</span><span class="html">ul</span><span class="kwrd">&gt;</span><br><span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span><br></pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>I’ve added in the correct attributes on the caret button element – namely the data toggle – so that it plays properly with the framework. Per <a href="http://getbootstrap.com/getting-started/#accessibility" target="_blank" rel="external">the documentation</a>, I’ve also added an sr-only class that allows screen readers to make sense of the control grouping. The inner commands are now simply anchor tags and don’t require any of the button classes.</p>
<p>So, there all-of-a-sudden seems to be a lot going on there, but let’s break down the basic structure:</p>
<ul>
<li>A DIV to group everything together</li>
<li>A BUTTON for the main action</li>
<li>A BUTTON for the caret (dropdown)</li>
<li>A UL with a list of LIs for the additional commands.</li>
</ul>
<p>The skeleton looks like this:</p>
<p><pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">=”btn-group”</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">button</span> <span class="attr">type</span><span class="kwrd">=”button”</span> <span class="attr">class</span><span class="kwrd">=”btn”</span><span class="kwrd">&gt;</span>Primary Action<span class="kwrd">&lt;/</span><span class="html">button</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">button</span> <span class="attr">type</span><span class="kwrd">=”button”</span> <span class="attr">class</span><span class="kwrd">=”btn dropdown-toggle”</span> <span class="attr">data-toggle</span><span class="kwrd">=”dropdown”</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">span</span> <span class="attr">class</span><span class="kwrd">=”caret”</span><span class="kwrd">&gt;&lt;/</span><span class="html">span</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">span</span> <span class="attr">class</span><span class="kwrd">=”sr-only”</span><span class="kwrd">&gt;</span>Toggle Dropdown<span class="kwrd">&lt;/</span><span class="html">span</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;/</span><span class="html">button</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">ul</span> <span class="attr">class</span><span class="kwrd">=”dropdown-menu”</span> <span class="attr">role</span><span class="kwrd">=”menu”</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">=”#”</span><span class="kwrd">&gt;</span>…<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">=”#”</span><span class="kwrd">&gt;</span>…<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;/</span><span class="html">ul</span><span class="kwrd">&gt;</span><br><span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>One final note: You would correctly assume, were you the assuming type, that the drop down functionality requires the JS library to work (which is already included in our web site bundle and layout).</p>
<h2 id="Updating_our_View"><a href="#Updating_our_View" class="headerlink" title="Updating our View"></a>Updating our View</h2><p>Now, forget what we’ve done so far in the TD for our actions. We’re going to change it up a bit and get things properly in line for some real-world action.</p>
<p>Since we’re going to be changing data we are going to want to do a POST back to the server, so we have the option of using the Html.BeginForm helper.&nbsp; But generating a series of forms representing all actions for all notifications could get complicated quite quickly (in other words, we don’t want a form for each action, for each notification). Instead, we need to decorate our split buttons with the appropriate IDs, then put together a bit of JavaScript to do the submit for us on a single, static form. The form contains a hidden input for the ID and will be at the end of the document in _RenderNotifications, followed by the related JavaScript:</p>
<p><pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">form</span> <span class="attr">id</span><span class="kwrd">=”notificationForm”</span> <span class="attr">method</span><span class="kwrd">=”POST”</span><span class="kwrd">&gt;&lt;</span><span class="html">input</span> <span class="attr">type</span><span class="kwrd">=”hidden”</span> <span class="attr">name</span><span class="kwrd">=”id”</span> <span class="attr">id</span><span class="kwrd">=”notificationFormItemId”</span> <span class="kwrd">/&gt;&lt;/</span><span class="html">form</span><span class="kwrd">&gt;</span></pre></p>
<p><span class="kwrd">&lt;</span><span class="html">script</span> <span class="attr">type</span><span class="kwrd">=”text/javascript”</span><span class="kwrd">&gt;</span></p>
<pre><code>&lt;span class=&quot;kwrd&quot;&gt;var&lt;/span&gt; readUrl = &lt;span class=&quot;str&quot;&gt;&apos;@Url.Action(&quot;MarkNotificationAsRead&quot;)&apos;&lt;/span&gt;;
&lt;span class=&quot;kwrd&quot;&gt;var&lt;/span&gt; deleteUrl = &lt;span class=&quot;str&quot;&gt;&apos;@Url.Action(&quot;Delete&quot;)&apos;&lt;/span&gt;;

&lt;span class=&quot;kwrd&quot;&gt;function&lt;/span&gt; updateNotification(id, action) {
    $(&lt;span class=&quot;str&quot;&gt;&quot;#notificationFormItemId&quot;&lt;/span&gt;).val(id);
    &lt;span class=&quot;kwrd&quot;&gt;switch&lt;/span&gt; (action) {
        &lt;span class=&quot;kwrd&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;str&quot;&gt;&apos;read&apos;&lt;/span&gt;:
            $(&lt;span class=&quot;str&quot;&gt;&quot;#notificationForm&quot;&lt;/span&gt;).attr(&lt;span class=&quot;str&quot;&gt;&apos;action&apos;&lt;/span&gt;, readUrl).submit();
            &lt;span class=&quot;kwrd&quot;&gt;break&lt;/span&gt;;
        &lt;span class=&quot;kwrd&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;str&quot;&gt;&apos;delete&apos;&lt;/span&gt;:
            $(&lt;span class=&quot;str&quot;&gt;&quot;#notificationForm&quot;&lt;/span&gt;).attr(&lt;span class=&quot;str&quot;&gt;&apos;action&apos;&lt;/span&gt;, deleteUrl).submit();
            &lt;span class=&quot;kwrd&quot;&gt;break&lt;/span&gt;;
        &lt;span class=&quot;kwrd&quot;&gt;default&lt;/span&gt;:
            console.debug(&lt;span class=&quot;str&quot;&gt;&apos;Unknown action &apos;&lt;/span&gt; + action);
    }
}
</code></pre><p><span class="kwrd">&lt;/</span><span class="html">script</span><span class="kwrd">&gt;</span></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>Here we are using the URL helper method to resolve the URLs needed for read and delete actions.&nbsp; The JavaScript simply accepts the ID and an action parameter, then sets up the form correctly and submits it. </p>
<p>Next, skip back up the document a little to the TD that contains our split button. We’ll replace the entire contents of the TD with the following:</p>
<p><pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">=”btn-group”</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">a</span> <span class="attr">class</span><span class="kwrd">=”btn btn-success btn-sm”</span> <span class="attr">href</span><span class="kwrd">=”javascript:updateNotification(@notification.NotificationId, ‘read’)”</span><span class="kwrd">&gt;</span>Mark as Read<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">button</span> <span class="attr">type</span><span class="kwrd">=”button”</span> <span class="attr">class</span><span class="kwrd">=”btn btn-success btn-sm dropdown-toggle”</span> <span class="attr">data-toggle</span><span class="kwrd">=”dropdown”</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">span</span> <span class="attr">class</span><span class="kwrd">=”caret”</span><span class="kwrd">&gt;&lt;/</span><span class="html">span</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">span</span> <span class="attr">class</span><span class="kwrd">=”sr-only”</span><span class="kwrd">&gt;</span>Toggle Dropdown<span class="kwrd">&lt;/</span><span class="html">span</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;/</span><span class="html">button</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">ul</span> <span class="attr">class</span><span class="kwrd">=”dropdown-menu”</span> <span class="attr">role</span><span class="kwrd">=”menu”</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;</span><br>            <span class="kwrd">&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">=”javascript:updateNotification(@notification.NotificationId, ‘delete’)”</span><span class="kwrd">&gt;</span>Delete<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">=”#”</span><span class="kwrd">&gt;</span>Send SMS<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">=”#”</span><span class="kwrd">&gt;</span>Make cheese<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">li</span> <span class="attr">class</span><span class="kwrd">=”divider”</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">=”#”</span><span class="kwrd">&gt;</span>Baz<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;/</span><span class="html">ul</span><span class="kwrd">&gt;</span><br><span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>You’ll notice that our A tags are now just invoking our JavaScript method, passing in the notification ID of the current record (remember that we’re in that outer foreach loop here). We can continue to develop new methods by wiring up the A tag and extending the switch statement should we like.</p>
<h2 id="A_Couple_of_Controller_Methods"><a href="#A_Couple_of_Controller_Methods" class="headerlink" title="A Couple of Controller Methods"></a>A Couple of Controller Methods</h2><p>Finally we’re going to need to wire up our controller to catch those user actions and do the dirty bits. Marking the notification as viewed will be first. We’ll use the DB context to retrieve, update and save the selected record, so we’ll make a small change to the way we initiate the DB context and move it to a class-level declaration as such: </p>
<p><pre class="csharpcode"><span class="kwrd">private</span> <span class="kwrd">readonly</span> SiteDataContext _context = <span class="kwrd">new</span> SiteDataContext();</pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>Remember to remove the following line of code from the GetUserNotifications method and update all occurrences of context to _context (your code won’t compile if you don’t).</p>
<p><pre class="csharpcode">[HttpPost]<br><span class="kwrd">public</span> ActionResult MarkNotificationAsRead(<span class="kwrd">int</span> id)<br>{<br>    var userNotification = GetUserNotifications().FirstOrDefault(n=&gt;n.NotificationId == id);</pre></p>
<pre><code>&lt;span class=&quot;kwrd&quot;&gt;if&lt;/span&gt; (userNotification == &lt;span class=&quot;kwrd&quot;&gt;null&lt;/span&gt;)
{
    &lt;span class=&quot;kwrd&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kwrd&quot;&gt;new&lt;/span&gt; HttpNotFoundResult();
}

userNotification.IsDismissed = &lt;span class=&quot;kwrd&quot;&gt;true&lt;/span&gt;;
_context.SaveChanges();

&lt;span class=&quot;kwrd&quot;&gt;return&lt;/span&gt; RedirectToAction(&lt;span class=&quot;str&quot;&gt;&quot;Manage&quot;&lt;/span&gt;);
</code></pre><p>}<br></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>Similarly, the code for the delete action will use the same DB context to delete the requested record.</p>
<p><pre class="csharpcode">[HttpPost]<br><span class="kwrd">public</span> ActionResult Delete(<span class="kwrd">int</span> id)<br>{<br>    var userNotification = GetUserNotifications().FirstOrDefault(n =&gt; n.NotificationId == id);</pre></p>
<pre><code>&lt;span class=&quot;kwrd&quot;&gt;if&lt;/span&gt; (userNotification == &lt;span class=&quot;kwrd&quot;&gt;null&lt;/span&gt;)
{
    &lt;span class=&quot;kwrd&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kwrd&quot;&gt;new&lt;/span&gt; HttpNotFoundResult();
}

_context.Notifications.Remove(userNotification);
_context.SaveChanges();

&lt;span class=&quot;kwrd&quot;&gt;return&lt;/span&gt; RedirectToAction(&lt;span class=&quot;str&quot;&gt;&quot;Manage&quot;&lt;/span&gt;);
</code></pre><p>}<br></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>There are a couple of quick notes here that I should mention. From a security standpoint we’re doing some good things, namely, we’re using a common method to only load into scope the notifications of the currently logged in user. We’re leveraging the fact that the framework provides a mechanism to correctly provide the user’s identity and limiting the user’s request to only allow execution of modifying or deleting records in a “row-level” security kind of way. Our controller is marked with the Authorize attribute, so if we couple this with SSL we’d be in pretty good shape.</p>
<p>Then there’s the bits that aren’t really good practice, but are good enough for the point of this exercise. First, we’ve got this GetUserNotifications method on the AccountController class.&nbsp; What about “AccountController” says anything about “loading the notifications for a specific user”? Nothing, right? This data access, as I’ve mentioned before, should be pushed into a repository that makes use of the DB context through a Dependency Injection mechanism that only creates one instance of the DB context per request. And, the controller should take that repository through DI.&nbsp; This would make things more flexible (why write data access in more than one spot) and testable (we could use mocks to test more easily).</p>
<h2 id="Next_Steps"><a href="#Next_Steps" class="headerlink" title="Next Steps"></a>Next Steps</h2><p>Certainly you wouldn’t want your users deleting data without confirmation (if at all), so in the next installment we’ll have a look at putting a dialog in place to ensure users are invoking the intended action.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2014/07/day-28-doing-more-interesting-things-with-buttons/" data-id="civiom2hc00imbwyyua0b7n0j" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2014/07/day-28-doing-more-interesting-things-with-buttons/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/30DaysMvcBootstrap/">30DaysMvcBootstrap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC5/">MVC5</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-day-27-rendering-data-in-a-bootstrap-table" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/day-27-rendering-data-in-a-bootstrap-table/">Day 27: Rendering Data in a Bootstrap Table</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2014/07/day-27-rendering-data-in-a-bootstrap-table/">
      <time datetime="2014-07-04T03:23:00.000Z" itemprop="datePublished">2014-07-03</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>This is an installment in a 30 day series on Bootstrap and the MVC Framework. To see more, check out <a href="http://jameschambers.com/2014/06/day-0-boothstrapping-mvc-for-the-next-30-days/">Day 0 for an index</a>.</p>
<p>We created a nice tab for our users to be able to manage the different components of their account, hi-jacking the Manage Account feature of the default MVC template. Now we want to render the user’s outstanding notifications in a good looking table in one of those tabs.</p>
<p><strong>Caution</strong>: this is the <strong><em>lipstick on a pig</em></strong> post of the series. Here be dragons…</p>
<h2 id="Rendering_Tables_with_Bootstrap"><a href="#Rendering_Tables_with_Bootstrap" class="headerlink" title="Rendering Tables with Bootstrap"></a>Rendering Tables with Bootstrap</h2><p>The first thing you need to know is that you don’t have to throw away a single thing you’ve learned in your years of HTML ninja skill building. Tables are still not to be used for layout. Tables are for lists of data. And more importantly, Bootstrap doesn’t try to change the semantics or document structure for a table. In fact, to get the Bootstrap look-and-feel in an HTML table, you need to apply but one class.</p>
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">table</span> <span class="attr">class</span><span class="kwrd">="table"</span><span class="kwrd">&gt;</span>
  ...
<span class="kwrd">&lt;/</span><span class="html">table</span><span class="kwrd">&gt;</span></pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

So what else does it offer?&nbsp; A bunch of common things that you might try to do, like “[tighter](http://getbootstrap.com/css/#tables-condensed)” versions of a table, [striped styling](http://getbootstrap.com/css/#tables-striped) or [hover-states](http://getbootstrap.com/css/#tables-hover-rows). You can also use the now familiar [contextual classes](http://getbootstrap.com/css/#tables-contextual-classes) on rows or cells to highlight pertinent information to your users.

All in all, it’s a clean looking table that will suit most needs and fit in with the rest of the site.

[![image](https://jcblogimages.blob.core.windows.net/img/2014/07/image_thumb1.png "image")](https://jcblogimages.blob.core.windows.net/img/2014/07/image4.png)

Another important aspect of the Bootstrap table is the ability to easily make a table responsive. I don’t have the answer as to why this isn’t the default, but it’s easily added with a DIV wrapper that has the table-responsive class. This adds horizontal scroll bars to your tables, when needed, when they are viewed on smaller screens to ensure that the data doesn’t end up in some non-accessible, off-device part of the screen.

[![image](https://jcblogimages.blob.core.windows.net/img/2014/07/image_thumb2.png "image")](https://jcblogimages.blob.core.windows.net/img/2014/07/image5.png)

That wrapper looks like the following:
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="table-responsive"</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">table</span> <span class="attr">class</span><span class="kwrd">="table table-striped "</span><span class="kwrd">&gt;</span>
       <span class="rem">&lt;!-- table rows here --&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">table</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

## Retrieving the Notifications

We’re going to need to get the list of notifications that haven’t yet been dismissed. You may have already created some test data with the efforts from the past few days, and that will work great here. 

Open the AccountController.cs class and navigate down to the Manage action.&nbsp; Just before it, add the following code :
<pre class="csharpcode"><span class="kwrd">private</span> IEnumerable&lt;Notification&gt; GetUserNotifications()
{
    <span class="rem">// get the user ID</span>
    var userId = User.Identity.GetUserId();

    <span class="rem">// load our notifications</span>
    var context = <span class="kwrd">new</span> SiteDataContext();
    var notifications = context.Notifications
        .Where(n =&gt; n.UserId == userId)
        .Where(n =&gt; !n.IsDismissed)
        .Select(n =&gt; n)
        .ToList();
    <span class="kwrd">return</span> notifications;
}</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

All this guy is doing, really, is snapping up the rows for this currently logged in user. 

One thing to mention here is that we’re really now _crying_ for some Dependency Injection. Our NotificationFilter and our AccountController are now both creating instances of our SiteDataContext – now multiple instances per request – and it’s making our code harder to test.

## Adding the Data to Our ViewBag

Both the GET and POST versions of Manage are already relying on ViewBag to get data up to the view, so we’ll follow the same cue and put our notifications in there. In both methods you’ll find the ReturnUrl being assigned to a ViewBag property, so immediately after that, add the following line of code:
<pre class="csharpcode">ViewBag.NotificationList = GetUserNotifications();</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

## Adding a Partial View for the Table

Next, let’s get a partial view added called “_RenderNotifications.cshtml”.&nbsp; The model type for the page will be a IEnumerable&lt;Notification&gt;, and we’ll iterate over the collection of rows to generate the TR and relevant TDs inside each of those. The entire view will look something like this:
<pre class="csharpcode">@using SimpleSite.Models
@model IEnumerable<span class="kwrd">&lt;</span><span class="html">Notification</span><span class="kwrd">&gt;</span>

<span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="table-responsive"</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">table</span> <span class="attr">class</span><span class="kwrd">="table table-striped "</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">tr</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">th</span><span class="kwrd">&gt;</span>Type<span class="kwrd">&lt;/</span><span class="html">th</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">th</span><span class="kwrd">&gt;</span>Notification<span class="kwrd">&lt;/</span><span class="html">th</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">th</span><span class="kwrd">&gt;</span>Actions<span class="kwrd">&lt;/</span><span class="html">th</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;/</span><span class="html">tr</span><span class="kwrd">&gt;</span>
        @foreach (var notification in Model)
        {
            var badgeClass = NotificationType.Email == notification.NotificationType
                ? "label-success"
                : "label-info";
            <span class="kwrd">&lt;</span><span class="html">tr</span><span class="kwrd">&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;&lt;</span><span class="html">span</span> <span class="attr">class</span><span class="kwrd">="label @badgeClass"</span><span class="kwrd">&gt;</span>@notification.NotificationType<span class="kwrd">&lt;/</span><span class="html">span</span><span class="kwrd">&gt;&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;</span>@notification.Title<span class="kwrd">&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;/</span><span class="html">tr</span><span class="kwrd">&gt;</span>
        }
    <span class="kwrd">&lt;/</span><span class="html">table</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre>

<p>There’s a placeholder in there for “Actions”, which we’ll look at tomorrow when we revisit buttons and explore drop-downs.</p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<h2 id="Updating_our_Manage_View"><a href="#Updating_our_Manage_View" class="headerlink" title="Updating our Manage View"></a>Updating our Manage View</h2><p>With the partial view in place and the data being loaded into the ViewBag we’re ready to update our view. Return to the Manage.cshtml file and locate our placeholder for the notifications. Update it to render the partial view, passing in the collection of notifications.</p>
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="tab-pane active"</span> <span class="attr">id</span><span class="kwrd">="notifications"</span><span class="kwrd">&gt;</span>
    @Html.Partial("_RenderNotifications", ViewBag.NotificationList as IEnumerable<span class="kwrd">&lt;</span><span class="html">Notification</span><span class="kwrd">&gt;</span>)
<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre>

<p>That should be it! I found what seems to be a bug in Bootstrap where if you have a table in a tab, and the tab is set to active and you have the fade class, the table doesn’t seem to be visible on page load. It shows up fine after clicking on a tab, but to work around this you’ll notice that I’ve removed the fade class from the tab.</p>
<h2 id="Oh_Noes_21_It_u2019s_Turned_Into_A_Mess_21"><a href="#Oh_Noes_21_It_u2019s_Turned_Into_A_Mess_21" class="headerlink" title="Oh Noes! It’s Turned Into A Mess!"></a>Oh Noes! It’s Turned Into A Mess!</h2><p>Folks, I’m not going to lie; though the Account controller and Manage views may have never have been intended to handle our humble little notifications, I found several things in both the controller and related views that left me uncomfortable with the design. I’m trying to keep this as a “how to get some MVC in your Bootstrap” type series, but all of the following were worth noting as things I’d try to avoid:</p>
<ul>
<li>Nested views with non-obvious dependencies</li>
<li>Multiple methods that do the same work as each other</li>
<li>Magic strings</li>
<li>Methods doing too many things or things that you wouldn’t attribute of them by their name (for example, the “Manage” action which resolves status messages based on optional parameters)</li>
<li>ViewBag use that gets in the way of the view’s maintainability</li>
<li>Views that don’t leverage Bootstrap enough</li>
<li>Way too much reliance on ViewBag, and, therefore,</li>
<li>Absence of reasonable view models</li>
<li>Dogs and cats playing together</li>
</ul>
<p>I will perhaps one day sit down and hash through the AccountController, but needless to say, there’s <em>some</em> amount of work to be done! I, for one, would like to see more best practices in place, a more referencable example of how to do things and sample views that better embrace the Bootstrap visuals (since, after all, it’s included by default in the template).</p>
<p>Now on our end, we’ve done some off-script things as well, namely putting direct database access in a controller (and filter),&nbsp; pushing database models directly up to the view and leaning on those ViewBag properties to shuffle data around. So, yes, kettle, meet teapot.</p>
<p>All of these things are leading up to another set of posts on best practices <img src="https://jcblogimages.blob.core.windows.net/img/2014/07/wlEmoticon-smile.png" alt="Smile">.</p>
<h2 id="Next_Steps"><a href="#Next_Steps" class="headerlink" title="Next Steps"></a>Next Steps</h2><p>Okay, our users can now see the list of notifications that are outstanding, but they have no way to manage them just yet. Tomorrow we’ll get some drop-down button action in play and explore some of the ways we can compose some pushable UI.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2014/07/day-27-rendering-data-in-a-bootstrap-table/" data-id="civiom2hg00isbwyycc19ah0v" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2014/07/day-27-rendering-data-in-a-bootstrap-table/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/30DaysMvcBootstrap/">30DaysMvcBootstrap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC5/">MVC5</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-day-26-bootstrap-tabs-for-managing-accounts" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/day-26-bootstrap-tabs-for-managing-accounts/">Day 26: Bootstrap Tabs for Managing Accounts</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2014/07/day-26-bootstrap-tabs-for-managing-accounts/">
      <time datetime="2014-07-03T05:40:00.000Z" itemprop="datePublished">2014-07-03</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>This is an installment in a 30 day series on Bootstrap and the MVC Framework. To see more, check out <a href="http://jameschambers.com/2014/06/day-0-boothstrapping-mvc-for-the-next-30-days/">Day 0 for an index</a>.</p>
<p>We’ve got this <a href="http://jameschambers.com/2014/07/day-25-personalizing-notifications-bootstrap-tables/">notification thing</a> going on now and we’d like to give users a way to review notifications. There’s a fairly acceptable landing spot on the “Manage Account” view (at /Account/Manage in your browser), at least for the purpose of these exercises, so we’ll flesh things out there.</p>
<p>However, the view is isn’t really set up for notifications (it’s truthfully not the best spot) so we’ll need to give us some UI to make it work.</p>
<h2 id="Understanding_the_Tab_Component"><a href="#Understanding_the_Tab_Component" class="headerlink" title="Understanding the Tab Component"></a>Understanding the Tab Component</h2><p>There are two main elements you’ll need to get the tabs going correctly, a UL tag that will set up as the menu elements, and a DIV to act as a container for the content.</p>
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">ul</span> <span class="attr">class</span><span class="kwrd">="nav nav-tabs"</span> <span class="attr">role</span><span class="kwrd">="tablist"</span> <span class="attr">id</span><span class="kwrd">="accountTab"</span><span class="kwrd">&gt;</span>
  <span class="rem">&lt;!-- content --&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">ul</span><span class="kwrd">&gt;</span>

<span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="tab-content"</span><span class="kwrd">&gt;</span>
  <span class="rem">&lt;!-- content --&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

Visually, you can link those elements as illustrated below:

[![image](https://jcblogimages.blob.core.windows.net/img/2014/07/image_thumb.png "image")](https://jcblogimages.blob.core.windows.net/img/2014/07/image3.png)

Because our site includes the JavaScript library for Bootstrap our tabs will automatically render and behave correctly. The classes help with the visuals, and the JS takes care of the behavior.

The UL will contain LI elements for each tab that you wish to display on the page. For us, that will the notifications, linked accounts and password reset. Those last two are the content that already exists on the page at \Views\Account\Manage.cshtml, and the notifications bits are what we’ll fill in after our tabs are in place.

In addition to those two root elements, you can use a bit of JavaScript to manipulate the tabs if needed. For example, if you wanted a particular tab displayed on page load, you could use the ID as part of a jQuery selector and call the show method as follows:
<pre class="csharpcode">$(<span class="str">'#accountTab a[href="#linkedAccounts"]'</span>).tab(<span class="str">'show'</span>);</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

The DIV for content will in turn hold container elements for the rest of the content you want on the page. The structure will look something like this:
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="tab-content"</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="tab-pane active"</span> <span class="attr">id</span><span class="kwrd">="notifications"</span><span class="kwrd">&gt;</span>
        <span class="rem">&lt;!-- content --&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="tab-pane"</span> <span class="attr">id</span><span class="kwrd">="linkedAccounts"</span><span class="kwrd">&gt;</span>
        <span class="rem">&lt;!-- content --&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="tab-pane"</span> <span class="attr">id</span><span class="kwrd">="passwordReset"</span><span class="kwrd">&gt;</span>
        <span class="rem">&lt;!-- content --&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre>

<p>Each of the tab-pane DIVs could also have a fade class applied, which creates a nice content-switching visual. Let’s use that.</p>
<h2 id="Updating_the_View"><a href="#Updating_the_View" class="headerlink" title="Updating the View"></a>Updating the View</h2><p>If you haven’t done so already, open up the \Views\Account\Manage.cshtml file and start cutting it up! Inside the DIV.row DIV.col-md-12 structure, add the UL for the tab headers, and add a DIV to contain the tab pages including a placeholder for notifications, and the DIVs for linked accounts and password reset. Move the content from those parts of the page in.</p>
<p>The final page code should be similar to the following:</p>
<p><pre class="csharpcode">@using SimpleSite.Models;<br>@using Microsoft.AspNet.Identity;<br>@{<br>    ViewBag.Title = “Manage Account”;<br>}</pre></p>
<p><span class="kwrd">&lt;</span><span class="html">h2</span><span class="kwrd">&gt;</span>@ViewBag.Title.<span class="kwrd">&lt;/</span><span class="html">h2</span><span class="kwrd">&gt;</span></p>
<p><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">=”row”</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">=”col-md-12”</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">p</span> <span class="attr">class</span><span class="kwrd">=”text-success”</span><span class="kwrd">&gt;</span>@ViewBag.StatusMessage<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span></p>
<pre><code>    &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;ul&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;nav nav-tabs&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tablist&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;accountTab&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;li&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;active&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;#notifications&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;data-toggle&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;Notifications&lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;#linkedAccounts&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;data-toggle&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;Linked Accounts&lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;#passwordReset&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;data-toggle&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;Password Reset&lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;ul&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab-content&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab-pane fade active&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;notifications&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;Here&apos;s where we&apos;ll put our notifications.&lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab-pane fade&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;linkedAccounts&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;section&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;externalLogins&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
                @Html.Action(&quot;RemoveAccountList&quot;)
                @Html.Partial(&quot;_ExternalLoginsListPartial&quot;, new ExternalLoginListViewModel { Action = &quot;LinkLogin&quot;, ReturnUrl = ViewBag.ReturnUrl })
            &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;section&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab-pane fade&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;passwordReset&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
            @if (ViewBag.HasLocalPassword)
            {
                @Html.Partial(&quot;_ChangePasswordPartial&quot;)
            }
            else
            {
                @Html.Partial(&quot;_SetPasswordPartial&quot;)
            }
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
</code></pre><p><span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></p>
<p>@section Scripts { @Scripts.Render(“~/bundles/jqueryval”) }</p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<h2 id="Next_Steps"><a href="#Next_Steps" class="headerlink" title="Next Steps"></a>Next Steps</h2><p>All that’s left now is to get our list of user-specific notifications into our view. Tomorrow we’ll get a view model figured out, populate it with the user’s notifications and get it rendering in a Bootstrap-styled table in the view.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2014/07/day-26-bootstrap-tabs-for-managing-accounts/" data-id="civiom2hk00iybwyyqmfeoe4t" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2014/07/day-26-bootstrap-tabs-for-managing-accounts/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/30DaysMvcBootstrap/">30DaysMvcBootstrap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC5/">MVC5</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-day-25-personalizing-notifications-bootstrap-tables" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/day-25-personalizing-notifications-bootstrap-tables/">Day 25: Personalizing Notifications</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2014/07/day-25-personalizing-notifications-bootstrap-tables/">
      <time datetime="2014-07-01T18:45:00.000Z" itemprop="datePublished">2014-07-01</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>This is an installment in a 30 day series on Bootstrap and the MVC Framework. To see more, check out <a href="http://jameschambers.com/2014/06/day-0-boothstrapping-mvc-for-the-next-30-days/">Day 0 for an index</a>.</p>
<p>Back on <a href="http://jameschambers.com/2014/06/day-19-long-running-notifications-using-badges-and-entity-framework-code-first/">Day 19</a> we introduced persistent storage for notifications, allowing us to pop a <a href="http://jameschambers.com/2014/06/day-18-customizing-and-rendering-bootstrap-badges/">custom badge</a> up in the navbar. This was great, but as we left it, it was creating notifications only in the seed method of our DbContext migrations configuration, and the notifications were shown to all users. Not too helpful for dialing in on specific details or messages for specific users.</p>
<p>Today we’re going to get that “everyone’s data” out of the mix, update our notifications so that they belong to a single user and then create a temporary way for us to add new, user-specific notifications to the site.</p>
<h2 id="Clearing_our_DB_and_Seed_Method"><a href="#Clearing_our_DB_and_Seed_Method" class="headerlink" title="Clearing our DB and Seed Method"></a>Clearing our DB and Seed Method</h2><p>Let’s get those records (from our seed method) out of the database. Locate your DB in SQL Server Management Studio and delete the rows. Something this simple is adequate:</p>
<pre class="csharpcode"><span class="kwrd">delete</span> <span class="kwrd">from</span> notifications</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

Now, the only thing is that effort is all in vain if we don’t clean out our seed method. Each time the database configuration class is used to perform or check for migrations it will re-insert those rows.

Locate the Configuration class, which should be in \Migrations directory in the root of your solution. Comment out or delete all the code we added to upsert the notifications.

## Extend our Notifications Class

Let’s next add a couple of properties to our Notification class, located in \Models.
<pre class="csharpcode"><span class="kwrd">public</span> <span class="kwrd">string</span> UserId { get; set; }
<span class="kwrd">public</span> <span class="kwrd">bool</span> IsDismissed { get; set; }</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

Remember that when we modify a class that takes part in our Entity Framework works that we’ll also need to generate a migration and update the database to match our model. Type these commands into the Package Manager Console, updating the namespace appropriately:
<pre class="csharpcode">Add-Migration PersonalNotifications -ConfigurationTypeName SimpleSite.Migrations.Configuration
Update-Database -ConfigurationTypeName SimpleSite.Migrations.Identity.Configuration</pre>

<p>The first command creates a migration for us, and the second updates the database accordingly.</p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<h2 id="Updating_our_ActionFilter"><a href="#Updating_our_ActionFilter" class="headerlink" title="Updating our ActionFilter"></a>Updating our ActionFilter</h2><p>So, if notifications belong only to users, we never want our filter to execute if the current request is for an unauthenticated user. We’ll also want to make sure that we only capture notifications for the user that <em>is</em> logged in, and then, only the notifications that have not yet been seen.&nbsp; </p>
<p>Here’s the updated code for the NotificationFilter (located in \Filters):</p>
<p><pre class="csharpcode"><span class="kwrd">public</span> <span class="kwrd">override</span> <span class="kwrd">void</span> OnActionExecuted(ActionExecutedContext filterContext)<br>{<br>    <span class="kwrd">if</span> (!filterContext.HttpContext.User.Identity.IsAuthenticated) <span class="kwrd">return</span>;</pre></p>
<pre><code>var userId = filterContext.HttpContext.User.Identity.GetUserId();

var context = &lt;span class=&quot;kwrd&quot;&gt;new&lt;/span&gt; SiteDataContext();
var notifications = context.Notifications
    .Where(n =&amp;gt; n.UserId == userId)
    .Where(n =&amp;gt; !n.IsDismissed)
    .GroupBy(n =&amp;gt; n.NotificationType)
    .Select(g =&amp;gt; &lt;span class=&quot;kwrd&quot;&gt;new&lt;/span&gt; NotificationViewModel
    {
        Count = g.Count(),
        NotificationType = g.Key.ToString(),
        BadgeClass = NotificationType.Email == g.Key
            ? &lt;span class=&quot;str&quot;&gt;&quot;success&quot;&lt;/span&gt;
            : &lt;span class=&quot;str&quot;&gt;&quot;info&quot;&lt;/span&gt;
    });

filterContext.Controller.ViewBag.Notifications = notifications;
</code></pre><p>}</p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<h2 id="Scaffolding_a_Temporary_Controller_and_View"><a href="#Scaffolding_a_Temporary_Controller_and_View" class="headerlink" title="Scaffolding a Temporary Controller and View"></a>Scaffolding a Temporary Controller and View</h2><p>The MVC Framework has some great scaffolding capabilities, as we’ve explored in minor detail so far. Today we’re going to use this feature to create our whole controller and the related views for all our CRUD operations. Right-click as you normally do on the controllers folder, and click Add-&gt;Controller. </p>
<p>This time ‘round, use the Scaffold for the “MVC5 Controller with views, using Entity Framework”. Fill out the options as follows:</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image.png" alt="image" title="image"></p>
<p>You are selecting the Notification model, checking off “Generate views” and “Use a layout page”. The controller name should automatically be set to NotificationsController for you. Click Add to finish it out.</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image1.png" alt="image" title="image"></p>
<p>One more thing: you’re going to want an easy way to get your UserId – it’s what we’re using to match the notifications – so add the following to your Create view in Views\Notifications\Create.cshtml:</p>
<p><pre class="csharpcode">@<span class="kwrd">if</span> (User.Identity.IsAuthenticated)<br>{<br>    &lt;p&gt;Your User ID <span class="kwrd">is</span> &lt;b&gt;@User.Identity.GetUserId()&lt;/b&gt;&lt;/p&gt;<br>}</pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>That will output your UserId (which is a Guid) so that you can create notifications for yourself. </p>
<p>Now when you run the site, sign in and navigate to the /Notifications path. This will show you an empty list, but you’ll have a link to create some new records. Add some to the site, using your UserId, and watch the navbar light up.</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image2.png" alt="image" title="image"></p>
<h2 id="Next_Steps"><a href="#Next_Steps" class="headerlink" title="Next Steps"></a>Next Steps</h2><p>Now, I did say this is a temporary solution. By no means would you actually have a situation where you’d have users enter their own notifications, you’d more likely have events happen in the system that require some notification to be required – perhaps the completion of a job or a required update to some business process.&nbsp; That’s why we just used the scaffolding today…the NotificationsController and view are something that you’ll likely eventually just delete…and that’s okay! One of the nice things about scaffolding is that you’re not married to it. So delete it when you’re done with it.</p>
<p>In the real world, however, you would likely want users to be able to see and manage notifications in some way. Tomorrow we’ll look at getting the first of those bits in place.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2014/07/day-25-personalizing-notifications-bootstrap-tables/" data-id="civiom2ho00j4bwyyb5pep90y" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2014/07/day-25-personalizing-notifications-bootstrap-tables/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/30DaysMvcBootstrap/">30DaysMvcBootstrap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC5/">MVC5</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/page/9/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/31/">31</a><a class="extend next" rel="next" href="/page/11/">Next &raquo;</a>
      </nav>
    </section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">recent</h3>
    <div class="widget">
      <ul id="recent-post" class="no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/11/Resizing-Images-Using-Azure-Functions/" class="title">How to Resize Images Uploaded to Blob Storage with Azure Functions</a></p>
              <p class="item-date"><time datetime="2016-11-15T13:04:26.000Z" itemprop="datePublished">2016-11-15</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/11/How-to-organize-types-in-your-scripts/" class="title">How to organize types in your Azure Function scripts</a></p>
              <p class="item-date"><time datetime="2016-11-14T13:00:00.000Z" itemprop="datePublished">2016-11-14</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/11/Five-Days-of-Azure-Functions/" class="title">Five Days of Azure Functions</a></p>
              <p class="item-date"><time datetime="2016-11-11T21:03:50.000Z" itemprop="datePublished">2016-11-11</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/09/Bending-ASP-NET-MVC-Core-To-Your-Will/" class="title">Bending ASP.NET Core MVC To Your Will</a></p>
              <p class="item-date"><time datetime="2016-09-09T17:46:34.000Z" itemprop="datePublished">2016-09-09</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/04/github-authentication-asp-net-core/" class="title">GitHub Authentication with ASP.NET Core</a></p>
              <p class="item-date"><time datetime="2016-04-26T12:12:54.000Z" itemprop="datePublished">2016-04-26</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Buy me a coffee?</h3>
    <div class="widget">
        <a href="https://www.paypal.me/jameschambers/3.5usd" target="_blank"><img src="/content/coffee.png"></a>
    </div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">tag cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/30DaysMvcBootstrap/" style="font-size: 17.86px;">30DaysMvcBootstrap</a> <a href="/tags/8DaysOfTableStorage/" style="font-size: 11.43px;">8DaysOfTableStorage</a> <a href="/tags/ASP-NET/" style="font-size: 15px;">ASP.NET</a> <a href="/tags/ASP-NET-5/" style="font-size: 10.71px;">ASP.NET 5</a> <a href="/tags/ASP-NET-Core/" style="font-size: 12.86px;">ASP.NET Core</a> <a href="/tags/ASP-NET-Core-MVC/" style="font-size: 10px;">ASP.NET Core MVC</a> <a href="/tags/ActionFilters/" style="font-size: 10px;">ActionFilters</a> <a href="/tags/AllReady/" style="font-size: 10px;">AllReady</a> <a href="/tags/Android/" style="font-size: 10.71px;">Android</a> <a href="/tags/AngelaSmith/" style="font-size: 10px;">AngelaSmith</a> <a href="/tags/Asp-Net-MVC/" style="font-size: 20px;">Asp.Net MVC</a> <a href="/tags/Authentication/" style="font-size: 10.71px;">Authentication</a> <a href="/tags/Azure/" style="font-size: 17.14px;">Azure</a> <a href="/tags/Azure-Functions/" style="font-size: 11.43px;">Azure Functions</a> <a href="/tags/Azure-Web-Apps/" style="font-size: 10px;">Azure Web Apps</a> <a href="/tags/Azure-Websites/" style="font-size: 13.57px;">Azure Websites</a> <a href="/tags/BUILD/" style="font-size: 10px;">BUILD</a> <a href="/tags/BitBucket/" style="font-size: 10px;">BitBucket</a> <a href="/tags/Bootstrap/" style="font-size: 15.71px;">Bootstrap</a> <a href="/tags/CTT-NUG/" style="font-size: 10px;">CTT .NUG</a> <a href="/tags/Calgary/" style="font-size: 10px;">Calgary</a> <a href="/tags/Cisco-VPN/" style="font-size: 10px;">Cisco VPN</a> <a href="/tags/ClearMeasure/" style="font-size: 10.71px;">ClearMeasure</a> <a href="/tags/CodeProject/" style="font-size: 11.43px;">CodeProject</a> <a href="/tags/Conferences/" style="font-size: 10.71px;">Conferences</a> <a href="/tags/CouchDb/" style="font-size: 10px;">CouchDb</a> <a href="/tags/DNX/" style="font-size: 10px;">DNX</a> <a href="/tags/Dojo/" style="font-size: 10px;">Dojo</a> <a href="/tags/Email/" style="font-size: 10px;">Email</a> <a href="/tags/Entity-Framework/" style="font-size: 13.57px;">Entity Framework</a> <a href="/tags/Extension-Methods/" style="font-size: 10px;">Extension Methods</a> <a href="/tags/FontAwesome/" style="font-size: 10.71px;">FontAwesome</a> <a href="/tags/GenFu/" style="font-size: 10px;">GenFu</a> <a href="/tags/GetManifestResourceStream/" style="font-size: 10px;">GetManifestResourceStream</a> <a href="/tags/Git/" style="font-size: 11.43px;">Git</a> <a href="/tags/HTML5/" style="font-size: 10px;">HTML5</a> <a href="/tags/HackAThon/" style="font-size: 10px;">HackAThon</a> <a href="/tags/HtmlHelper/" style="font-size: 10px;">HtmlHelper</a> <a href="/tags/IIS/" style="font-size: 10px;">IIS</a> <a href="/tags/JSON/" style="font-size: 10.71px;">JSON</a> <a href="/tags/Keynote/" style="font-size: 10px;">Keynote</a> <a href="/tags/Life-Hack/" style="font-size: 10px;">Life Hack</a> <a href="/tags/Life-Hacking/" style="font-size: 10.71px;">Life Hacking</a> <a href="/tags/Life-Hacks/" style="font-size: 12.86px;">Life Hacks</a> <a href="/tags/Linq/" style="font-size: 10px;">Linq</a> <a href="/tags/MIX11/" style="font-size: 10px;">MIX11</a> <a href="/tags/MVA/" style="font-size: 10.71px;">MVA</a> <a href="/tags/MVC/" style="font-size: 19.29px;">MVC</a> <a href="/tags/MVC5/" style="font-size: 18.57px;">MVC5</a> <a href="/tags/MVC6/" style="font-size: 13.57px;">MVC6</a> <a href="/tags/MVP/" style="font-size: 10px;">MVP</a> <a href="/tags/Make-Code-Not-War/" style="font-size: 10px;">Make Code Not War</a> <a href="/tags/MeasureUp/" style="font-size: 10px;">MeasureUp</a> <a href="/tags/Metro/" style="font-size: 10px;">Metro</a> <a href="/tags/Microsoft/" style="font-size: 10px;">Microsoft</a> <a href="/tags/Microsoft-Band/" style="font-size: 12.14px;">Microsoft Band</a> <a href="/tags/Mobile/" style="font-size: 10px;">Mobile</a> <a href="/tags/Mobile-Services/" style="font-size: 10px;">Mobile Services</a> <a href="/tags/Motivate/" style="font-size: 10px;">Motivate</a> <a href="/tags/MvcScaffolding/" style="font-size: 11.43px;">MvcScaffolding</a> <a href="/tags/Not-Coding-At-All/" style="font-size: 10px;">Not Coding At All</a> <a href="/tags/NuGet/" style="font-size: 15px;">NuGet</a> <a href="/tags/OData/" style="font-size: 10px;">OData</a> <a href="/tags/PayPal/" style="font-size: 10px;">PayPal</a> <a href="/tags/PostSharp/" style="font-size: 10px;">PostSharp</a> <a href="/tags/Practice/" style="font-size: 10.71px;">Practice</a> <a href="/tags/Practice-of-Awesome/" style="font-size: 10px;">Practice of Awesome</a> <a href="/tags/PrairieDevCon/" style="font-size: 16.43px;">PrairieDevCon</a> <a href="/tags/Queues/" style="font-size: 10px;">Queues</a> <a href="/tags/REST/" style="font-size: 10px;">REST</a> <a href="/tags/Radio/" style="font-size: 10px;">Radio</a> <a href="/tags/Razor/" style="font-size: 10.71px;">Razor</a> <a href="/tags/Real-Life/" style="font-size: 10px;">Real Life</a> <a href="/tags/Regina/" style="font-size: 10.71px;">Regina</a> <a href="/tags/Remote-Work/" style="font-size: 11.43px;">Remote Work</a> <a href="/tags/Resolve/" style="font-size: 10px;">Resolve</a> <a href="/tags/Rock-Paper-Scissors/" style="font-size: 10px;">Rock Paper Scissors</a> <a href="/tags/Routing/" style="font-size: 10px;">Routing</a> <a href="/tags/Ruby-on-Rails/" style="font-size: 10px;">Ruby on Rails</a> <a href="/tags/SDEC/" style="font-size: 10px;">SDEC</a> <a href="/tags/SOAP/" style="font-size: 10px;">SOAP</a> <a href="/tags/SQL-Server/" style="font-size: 10px;">SQL Server</a> <a href="/tags/ServiceBus/" style="font-size: 10px;">ServiceBus</a> <a href="/tags/SignalR/" style="font-size: 11.43px;">SignalR</a> <a href="/tags/Speaking/" style="font-size: 11.43px;">Speaking</a> <a href="/tags/TFS/" style="font-size: 10px;">TFS</a> <a href="/tags/Table-Storage/" style="font-size: 10.71px;">Table Storage</a> <a href="/tags/TypeScript/" style="font-size: 10px;">TypeScript</a> <a href="/tags/Unit-Testing/" style="font-size: 10px;">Unit Testing</a> <a href="/tags/Visual-Studio/" style="font-size: 10.71px;">Visual Studio</a> <a href="/tags/Visual-Studio-11/" style="font-size: 11.43px;">Visual Studio 11</a> <a href="/tags/Visual-Studio-2010/" style="font-size: 16.43px;">Visual Studio 2010</a> <a href="/tags/Visual-Studio-2012/" style="font-size: 12.86px;">Visual Studio 2012</a> <a href="/tags/Visual-Studio-2013/" style="font-size: 10.71px;">Visual Studio 2013</a> <a href="/tags/Visual-Studio-2015/" style="font-size: 15.71px;">Visual Studio 2015</a> <a href="/tags/WCF/" style="font-size: 10.71px;">WCF</a> <a href="/tags/Web-API/" style="font-size: 11.43px;">Web API</a> <a href="/tags/Web-Development/" style="font-size: 10px;">Web Development</a> <a href="/tags/Web-Services/" style="font-size: 10.71px;">Web Services</a> <a href="/tags/Windows-8/" style="font-size: 11.43px;">Windows 8</a> <a href="/tags/Windows-Azure/" style="font-size: 10px;">Windows Azure</a> <a href="/tags/Windows-Phone/" style="font-size: 14.29px;">Windows Phone</a> <a href="/tags/Windws-Live-Writer/" style="font-size: 10px;">Windws Live Writer</a> <a href="/tags/Winnipeg/" style="font-size: 10.71px;">Winnipeg</a> <a href="/tags/c/" style="font-size: 13.57px;">c#</a> <a href="/tags/compiling/" style="font-size: 10px;">compiling</a> <a href="/tags/jQuery/" style="font-size: 12.14px;">jQuery</a> <a href="/tags/jQuery-UI/" style="font-size: 10.71px;">jQuery UI</a> <a href="/tags/node/" style="font-size: 10px;">node</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/open-source/" style="font-size: 10.71px;">open source</a> <a href="/tags/reflection/" style="font-size: 10px;">reflection</a> <a href="/tags/seed-data/" style="font-size: 10px;">seed data</a> <a href="/tags/testing/" style="font-size: 10px;">testing</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/">2016</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/">2015</a><span class="archive-list-count">36</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/">2014</a><span class="archive-list-count">42</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/">2013</a><span class="archive-list-count">17</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/">2012</a><span class="archive-list-count">41</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/">2011</a><span class="archive-list-count">36</span></li></ul>
    </div>
  </div>

  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 1999 - 2016 James Chambers<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script>
  var disqus_shortname = 'jameschambers';
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



 <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>




  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>