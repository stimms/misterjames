<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>They Call Me Mister James</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This is the blog of James Chambers, a senior developer on the .NET stack">
<meta property="og:type" content="website">
<meta property="og:title" content="They Call Me Mister James">
<meta property="og:url" content="http://jameschambers.com/page/10/index.html">
<meta property="og:site_name" content="They Call Me Mister James">
<meta property="og:description" content="This is the blog of James Chambers, a senior developer on the .NET stack">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="They Call Me Mister James">
<meta name="twitter:description" content="This is the blog of James Chambers, a senior developer on the .NET stack">
<meta name="twitter:creator" content="@CanadianJames">
<meta name="twitter:site" content="CanadianJames">
  
  
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="content/avatar.png">
  
  
 <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
 <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>


  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" type="text/css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-2868185-6', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  

  
  <script src="//load.sumome.com/" data-sumo-site-id="34f480920bcf5ea13ec1605be65d32e86be89fb7177416fb68c2d2f1939aaa04" async="async"></script>
</head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo" style="background-image: url(/content/logo_round.png)"></i><span class="site-title">They Call Me Mister James</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/.">Home</a>
        
          <a class="main-nav-link" href="/about/bootstrapping-mvc.html">Boostrapping MVC</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">Testimonials</a>
        
          <a class="main-nav-link" href="/about/genfu.html">GenFu</a>
        
        <a class="main-nav-link main-nav-link-highlight" href="https://hireme.jameschambers.com" target="_blank">Hire Me</a>
      </nav>
      
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/content/avatar.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
      
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="http://jameschambers.com"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
        
          <td><a class="main-nav-link" href="/.">Home</a></td>
        
          <td><a class="main-nav-link" href="/about/bootstrapping-mvc.html">Boostrapping MVC</a></td>
        
          <td><a class="main-nav-link" href="/archives">Archives</a></td>
        
          <td><a class="main-nav-link" href="/about">Testimonials</a></td>
        
          <td><a class="main-nav-link" href="/about/genfu.html">GenFu</a></td>
        
        <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://jameschambers.com"></form>
        </td>
      </tr>
    </table>
  </div>
</header>

    <div class="outer">
      
        <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <h2 id="name">James Chambers</h2>
      <h3 id="title">Husband, Father, Mentor, Humanitarian &amp; Software Developer</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Canada</span>
      <a id="follow" href="https://twitter.com/canadianjames">FOLLOW</a>
    </div>

    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
          <td><a href="/CanadianJames" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></td>
          
          <td><a href="http://github.com/MisterJames" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
          
          <td><a href="/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
          
          <td><a href="https://ca.linkedin.com/in/canadianjames" target="_blank" title="linkedin"><i class="fa fa-linkedin"></i></a></td>
          
          <td><a href="https://www.youtube.com/user/CodingMisterJames/" target="_blank" title="youtube"><i class="fa fa-youtube"></i></a></td>
          
        </tr>
      </table>
    </div>
    

    <div class="base-info profile-block">
        <a href="http://aspnetmonsters.com" target="_blank"><img src="/content/monster-james.png"></a>      
    </div>

    <div class="base-info profile-block">
        <a href="https://leanpub.com/bootstrappingmvc" onclick="_gaq.push(['_trackEvent', 'outbound-widget', 'https://leanpub.com/bootstrappingmvc', '\n\n']);">
            <img src="https://s3.amazonaws.com/titlepages.leanpub.com/bootstrappingmvc/medium?1425560219" scale="0">
        </a>
    </div>
        
    
  </div>
</aside>

      
      <section id="main">
      <article id="post-day-27-rendering-data-in-a-bootstrap-table" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/day-27-rendering-data-in-a-bootstrap-table/">Day 27: Rendering Data in a Bootstrap Table</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2014/07/day-27-rendering-data-in-a-bootstrap-table/">
      <time datetime="2014-07-04T03:23:00.000Z" itemprop="datePublished">2014-07-03</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>This is an installment in a 30 day series on Bootstrap and the MVC Framework. To see more, check out <a href="http://jameschambers.com/2014/06/day-0-boothstrapping-mvc-for-the-next-30-days/">Day 0 for an index</a>.</p>
<p>We created a nice tab for our users to be able to manage the different components of their account, hi-jacking the Manage Account feature of the default MVC template. Now we want to render the user’s outstanding notifications in a good looking table in one of those tabs.</p>
<p><strong>Caution</strong>: this is the <strong><em>lipstick on a pig</em></strong> post of the series. Here be dragons…</p>
<h2 id="Rendering_Tables_with_Bootstrap"><a href="#Rendering_Tables_with_Bootstrap" class="headerlink" title="Rendering Tables with Bootstrap"></a>Rendering Tables with Bootstrap</h2><p>The first thing you need to know is that you don’t have to throw away a single thing you’ve learned in your years of HTML ninja skill building. Tables are still not to be used for layout. Tables are for lists of data. And more importantly, Bootstrap doesn’t try to change the semantics or document structure for a table. In fact, to get the Bootstrap look-and-feel in an HTML table, you need to apply but one class.</p>
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">table</span> <span class="attr">class</span><span class="kwrd">="table"</span><span class="kwrd">&gt;</span>
  ...
<span class="kwrd">&lt;/</span><span class="html">table</span><span class="kwrd">&gt;</span></pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

So what else does it offer?&nbsp; A bunch of common things that you might try to do, like “[tighter](http://getbootstrap.com/css/#tables-condensed)” versions of a table, [striped styling](http://getbootstrap.com/css/#tables-striped) or [hover-states](http://getbootstrap.com/css/#tables-hover-rows). You can also use the now familiar [contextual classes](http://getbootstrap.com/css/#tables-contextual-classes) on rows or cells to highlight pertinent information to your users.

All in all, it’s a clean looking table that will suit most needs and fit in with the rest of the site.

[![image](https://jcblogimages.blob.core.windows.net/img/2014/07/image_thumb1.png "image")](https://jcblogimages.blob.core.windows.net/img/2014/07/image4.png)

Another important aspect of the Bootstrap table is the ability to easily make a table responsive. I don’t have the answer as to why this isn’t the default, but it’s easily added with a DIV wrapper that has the table-responsive class. This adds horizontal scroll bars to your tables, when needed, when they are viewed on smaller screens to ensure that the data doesn’t end up in some non-accessible, off-device part of the screen.

[![image](https://jcblogimages.blob.core.windows.net/img/2014/07/image_thumb2.png "image")](https://jcblogimages.blob.core.windows.net/img/2014/07/image5.png)

That wrapper looks like the following:
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="table-responsive"</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">table</span> <span class="attr">class</span><span class="kwrd">="table table-striped "</span><span class="kwrd">&gt;</span>
       <span class="rem">&lt;!-- table rows here --&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">table</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

## Retrieving the Notifications

We’re going to need to get the list of notifications that haven’t yet been dismissed. You may have already created some test data with the efforts from the past few days, and that will work great here. 

Open the AccountController.cs class and navigate down to the Manage action.&nbsp; Just before it, add the following code :
<pre class="csharpcode"><span class="kwrd">private</span> IEnumerable&lt;Notification&gt; GetUserNotifications()
{
    <span class="rem">// get the user ID</span>
    var userId = User.Identity.GetUserId();

    <span class="rem">// load our notifications</span>
    var context = <span class="kwrd">new</span> SiteDataContext();
    var notifications = context.Notifications
        .Where(n =&gt; n.UserId == userId)
        .Where(n =&gt; !n.IsDismissed)
        .Select(n =&gt; n)
        .ToList();
    <span class="kwrd">return</span> notifications;
}</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

All this guy is doing, really, is snapping up the rows for this currently logged in user. 

One thing to mention here is that we’re really now _crying_ for some Dependency Injection. Our NotificationFilter and our AccountController are now both creating instances of our SiteDataContext – now multiple instances per request – and it’s making our code harder to test.

## Adding the Data to Our ViewBag

Both the GET and POST versions of Manage are already relying on ViewBag to get data up to the view, so we’ll follow the same cue and put our notifications in there. In both methods you’ll find the ReturnUrl being assigned to a ViewBag property, so immediately after that, add the following line of code:
<pre class="csharpcode">ViewBag.NotificationList = GetUserNotifications();</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

## Adding a Partial View for the Table

Next, let’s get a partial view added called “_RenderNotifications.cshtml”.&nbsp; The model type for the page will be a IEnumerable&lt;Notification&gt;, and we’ll iterate over the collection of rows to generate the TR and relevant TDs inside each of those. The entire view will look something like this:
<pre class="csharpcode">@using SimpleSite.Models
@model IEnumerable<span class="kwrd">&lt;</span><span class="html">Notification</span><span class="kwrd">&gt;</span>

<span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="table-responsive"</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">table</span> <span class="attr">class</span><span class="kwrd">="table table-striped "</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">tr</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">th</span><span class="kwrd">&gt;</span>Type<span class="kwrd">&lt;/</span><span class="html">th</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">th</span><span class="kwrd">&gt;</span>Notification<span class="kwrd">&lt;/</span><span class="html">th</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">th</span><span class="kwrd">&gt;</span>Actions<span class="kwrd">&lt;/</span><span class="html">th</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;/</span><span class="html">tr</span><span class="kwrd">&gt;</span>
        @foreach (var notification in Model)
        {
            var badgeClass = NotificationType.Email == notification.NotificationType
                ? "label-success"
                : "label-info";
            <span class="kwrd">&lt;</span><span class="html">tr</span><span class="kwrd">&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;&lt;</span><span class="html">span</span> <span class="attr">class</span><span class="kwrd">="label @badgeClass"</span><span class="kwrd">&gt;</span>@notification.NotificationType<span class="kwrd">&lt;/</span><span class="html">span</span><span class="kwrd">&gt;&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;</span>@notification.Title<span class="kwrd">&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;/</span><span class="html">tr</span><span class="kwrd">&gt;</span>
        }
    <span class="kwrd">&lt;/</span><span class="html">table</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre>

<p>There’s a placeholder in there for “Actions”, which we’ll look at tomorrow when we revisit buttons and explore drop-downs.</p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<h2 id="Updating_our_Manage_View"><a href="#Updating_our_Manage_View" class="headerlink" title="Updating our Manage View"></a>Updating our Manage View</h2><p>With the partial view in place and the data being loaded into the ViewBag we’re ready to update our view. Return to the Manage.cshtml file and locate our placeholder for the notifications. Update it to render the partial view, passing in the collection of notifications.</p>
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="tab-pane active"</span> <span class="attr">id</span><span class="kwrd">="notifications"</span><span class="kwrd">&gt;</span>
    @Html.Partial("_RenderNotifications", ViewBag.NotificationList as IEnumerable<span class="kwrd">&lt;</span><span class="html">Notification</span><span class="kwrd">&gt;</span>)
<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre>

<p>That should be it! I found what seems to be a bug in Bootstrap where if you have a table in a tab, and the tab is set to active and you have the fade class, the table doesn’t seem to be visible on page load. It shows up fine after clicking on a tab, but to work around this you’ll notice that I’ve removed the fade class from the tab.</p>
<h2 id="Oh_Noes_21_It_u2019s_Turned_Into_A_Mess_21"><a href="#Oh_Noes_21_It_u2019s_Turned_Into_A_Mess_21" class="headerlink" title="Oh Noes! It’s Turned Into A Mess!"></a>Oh Noes! It’s Turned Into A Mess!</h2><p>Folks, I’m not going to lie; though the Account controller and Manage views may have never have been intended to handle our humble little notifications, I found several things in both the controller and related views that left me uncomfortable with the design. I’m trying to keep this as a “how to get some MVC in your Bootstrap” type series, but all of the following were worth noting as things I’d try to avoid:</p>
<ul>
<li>Nested views with non-obvious dependencies</li>
<li>Multiple methods that do the same work as each other</li>
<li>Magic strings</li>
<li>Methods doing too many things or things that you wouldn’t attribute of them by their name (for example, the “Manage” action which resolves status messages based on optional parameters)</li>
<li>ViewBag use that gets in the way of the view’s maintainability</li>
<li>Views that don’t leverage Bootstrap enough</li>
<li>Way too much reliance on ViewBag, and, therefore,</li>
<li>Absence of reasonable view models</li>
<li>Dogs and cats playing together</li>
</ul>
<p>I will perhaps one day sit down and hash through the AccountController, but needless to say, there’s <em>some</em> amount of work to be done! I, for one, would like to see more best practices in place, a more referencable example of how to do things and sample views that better embrace the Bootstrap visuals (since, after all, it’s included by default in the template).</p>
<p>Now on our end, we’ve done some off-script things as well, namely putting direct database access in a controller (and filter),&nbsp; pushing database models directly up to the view and leaning on those ViewBag properties to shuffle data around. So, yes, kettle, meet teapot.</p>
<p>All of these things are leading up to another set of posts on best practices <img src="https://jcblogimages.blob.core.windows.net/img/2014/07/wlEmoticon-smile.png" alt="Smile">.</p>
<h2 id="Next_Steps"><a href="#Next_Steps" class="headerlink" title="Next Steps"></a>Next Steps</h2><p>Okay, our users can now see the list of notifications that are outstanding, but they have no way to manage them just yet. Tomorrow we’ll get some drop-down button action in play and explore some of the ways we can compose some pushable UI.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2014/07/day-27-rendering-data-in-a-bootstrap-table/" data-id="cit1f3snp00is1cyy9w52n1aq" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2014/07/day-27-rendering-data-in-a-bootstrap-table/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/30DaysMvcBootstrap/">30DaysMvcBootstrap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC5/">MVC5</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-day-26-bootstrap-tabs-for-managing-accounts" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/day-26-bootstrap-tabs-for-managing-accounts/">Day 26: Bootstrap Tabs for Managing Accounts</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2014/07/day-26-bootstrap-tabs-for-managing-accounts/">
      <time datetime="2014-07-03T05:40:00.000Z" itemprop="datePublished">2014-07-03</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>This is an installment in a 30 day series on Bootstrap and the MVC Framework. To see more, check out <a href="http://jameschambers.com/2014/06/day-0-boothstrapping-mvc-for-the-next-30-days/">Day 0 for an index</a>.</p>
<p>We’ve got this <a href="http://jameschambers.com/2014/07/day-25-personalizing-notifications-bootstrap-tables/">notification thing</a> going on now and we’d like to give users a way to review notifications. There’s a fairly acceptable landing spot on the “Manage Account” view (at /Account/Manage in your browser), at least for the purpose of these exercises, so we’ll flesh things out there.</p>
<p>However, the view is isn’t really set up for notifications (it’s truthfully not the best spot) so we’ll need to give us some UI to make it work.</p>
<h2 id="Understanding_the_Tab_Component"><a href="#Understanding_the_Tab_Component" class="headerlink" title="Understanding the Tab Component"></a>Understanding the Tab Component</h2><p>There are two main elements you’ll need to get the tabs going correctly, a UL tag that will set up as the menu elements, and a DIV to act as a container for the content.</p>
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">ul</span> <span class="attr">class</span><span class="kwrd">="nav nav-tabs"</span> <span class="attr">role</span><span class="kwrd">="tablist"</span> <span class="attr">id</span><span class="kwrd">="accountTab"</span><span class="kwrd">&gt;</span>
  <span class="rem">&lt;!-- content --&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">ul</span><span class="kwrd">&gt;</span>

<span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="tab-content"</span><span class="kwrd">&gt;</span>
  <span class="rem">&lt;!-- content --&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

Visually, you can link those elements as illustrated below:

[![image](https://jcblogimages.blob.core.windows.net/img/2014/07/image_thumb.png "image")](https://jcblogimages.blob.core.windows.net/img/2014/07/image3.png)

Because our site includes the JavaScript library for Bootstrap our tabs will automatically render and behave correctly. The classes help with the visuals, and the JS takes care of the behavior.

The UL will contain LI elements for each tab that you wish to display on the page. For us, that will the notifications, linked accounts and password reset. Those last two are the content that already exists on the page at \Views\Account\Manage.cshtml, and the notifications bits are what we’ll fill in after our tabs are in place.

In addition to those two root elements, you can use a bit of JavaScript to manipulate the tabs if needed. For example, if you wanted a particular tab displayed on page load, you could use the ID as part of a jQuery selector and call the show method as follows:
<pre class="csharpcode">$(<span class="str">'#accountTab a[href="#linkedAccounts"]'</span>).tab(<span class="str">'show'</span>);</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

The DIV for content will in turn hold container elements for the rest of the content you want on the page. The structure will look something like this:
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="tab-content"</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="tab-pane active"</span> <span class="attr">id</span><span class="kwrd">="notifications"</span><span class="kwrd">&gt;</span>
        <span class="rem">&lt;!-- content --&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="tab-pane"</span> <span class="attr">id</span><span class="kwrd">="linkedAccounts"</span><span class="kwrd">&gt;</span>
        <span class="rem">&lt;!-- content --&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">="tab-pane"</span> <span class="attr">id</span><span class="kwrd">="passwordReset"</span><span class="kwrd">&gt;</span>
        <span class="rem">&lt;!-- content --&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></pre>

<p>Each of the tab-pane DIVs could also have a fade class applied, which creates a nice content-switching visual. Let’s use that.</p>
<h2 id="Updating_the_View"><a href="#Updating_the_View" class="headerlink" title="Updating the View"></a>Updating the View</h2><p>If you haven’t done so already, open up the \Views\Account\Manage.cshtml file and start cutting it up! Inside the DIV.row DIV.col-md-12 structure, add the UL for the tab headers, and add a DIV to contain the tab pages including a placeholder for notifications, and the DIVs for linked accounts and password reset. Move the content from those parts of the page in.</p>
<p>The final page code should be similar to the following:</p>
<p><pre class="csharpcode">@using SimpleSite.Models;<br>@using Microsoft.AspNet.Identity;<br>@{<br>    ViewBag.Title = “Manage Account”;<br>}</pre></p>
<p><span class="kwrd">&lt;</span><span class="html">h2</span><span class="kwrd">&gt;</span>@ViewBag.Title.<span class="kwrd">&lt;/</span><span class="html">h2</span><span class="kwrd">&gt;</span></p>
<p><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">=”row”</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">=”col-md-12”</span><span class="kwrd">&gt;</span><br>        <span class="kwrd">&lt;</span><span class="html">p</span> <span class="attr">class</span><span class="kwrd">=”text-success”</span><span class="kwrd">&gt;</span>@ViewBag.StatusMessage<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span></p>
<pre><code>    &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;ul&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;nav nav-tabs&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tablist&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;accountTab&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;li&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;active&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;#notifications&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;data-toggle&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;Notifications&lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;#linkedAccounts&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;data-toggle&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;Linked Accounts&lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;#passwordReset&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;data-toggle&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;Password Reset&lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;ul&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab-content&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab-pane fade active&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;notifications&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;Here&apos;s where we&apos;ll put our notifications.&lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab-pane fade&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;linkedAccounts&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;section&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;externalLogins&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
                @Html.Action(&quot;RemoveAccountList&quot;)
                @Html.Partial(&quot;_ExternalLoginsListPartial&quot;, new ExternalLoginListViewModel { Action = &quot;LinkLogin&quot;, ReturnUrl = ViewBag.ReturnUrl })
            &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;section&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;tab-pane fade&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;=&quot;passwordReset&quot;&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
            @if (ViewBag.HasLocalPassword)
            {
                @Html.Partial(&quot;_ChangePasswordPartial&quot;)
            }
            else
            {
                @Html.Partial(&quot;_SetPasswordPartial&quot;)
            }
        &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;kwrd&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;html&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;kwrd&quot;&gt;&amp;gt;&lt;/span&gt;
</code></pre><p><span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></p>
<p>@section Scripts { @Scripts.Render(“~/bundles/jqueryval”) }</p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<h2 id="Next_Steps"><a href="#Next_Steps" class="headerlink" title="Next Steps"></a>Next Steps</h2><p>All that’s left now is to get our list of user-specific notifications into our view. Tomorrow we’ll get a view model figured out, populate it with the user’s notifications and get it rendering in a Bootstrap-styled table in the view.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2014/07/day-26-bootstrap-tabs-for-managing-accounts/" data-id="cit1f3sns00iy1cyypbxfy1ve" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2014/07/day-26-bootstrap-tabs-for-managing-accounts/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/30DaysMvcBootstrap/">30DaysMvcBootstrap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC5/">MVC5</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-day-25-personalizing-notifications-bootstrap-tables" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/day-25-personalizing-notifications-bootstrap-tables/">Day 25: Personalizing Notifications</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2014/07/day-25-personalizing-notifications-bootstrap-tables/">
      <time datetime="2014-07-01T18:45:00.000Z" itemprop="datePublished">2014-07-01</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>This is an installment in a 30 day series on Bootstrap and the MVC Framework. To see more, check out <a href="http://jameschambers.com/2014/06/day-0-boothstrapping-mvc-for-the-next-30-days/">Day 0 for an index</a>.</p>
<p>Back on <a href="http://jameschambers.com/2014/06/day-19-long-running-notifications-using-badges-and-entity-framework-code-first/">Day 19</a> we introduced persistent storage for notifications, allowing us to pop a <a href="http://jameschambers.com/2014/06/day-18-customizing-and-rendering-bootstrap-badges/">custom badge</a> up in the navbar. This was great, but as we left it, it was creating notifications only in the seed method of our DbContext migrations configuration, and the notifications were shown to all users. Not too helpful for dialing in on specific details or messages for specific users.</p>
<p>Today we’re going to get that “everyone’s data” out of the mix, update our notifications so that they belong to a single user and then create a temporary way for us to add new, user-specific notifications to the site.</p>
<h2 id="Clearing_our_DB_and_Seed_Method"><a href="#Clearing_our_DB_and_Seed_Method" class="headerlink" title="Clearing our DB and Seed Method"></a>Clearing our DB and Seed Method</h2><p>Let’s get those records (from our seed method) out of the database. Locate your DB in SQL Server Management Studio and delete the rows. Something this simple is adequate:</p>
<pre class="csharpcode"><span class="kwrd">delete</span> <span class="kwrd">from</span> notifications</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

Now, the only thing is that effort is all in vain if we don’t clean out our seed method. Each time the database configuration class is used to perform or check for migrations it will re-insert those rows.

Locate the Configuration class, which should be in \Migrations directory in the root of your solution. Comment out or delete all the code we added to upsert the notifications.

## Extend our Notifications Class

Let’s next add a couple of properties to our Notification class, located in \Models.
<pre class="csharpcode"><span class="kwrd">public</span> <span class="kwrd">string</span> UserId { get; set; }
<span class="kwrd">public</span> <span class="kwrd">bool</span> IsDismissed { get; set; }</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

Remember that when we modify a class that takes part in our Entity Framework works that we’ll also need to generate a migration and update the database to match our model. Type these commands into the Package Manager Console, updating the namespace appropriately:
<pre class="csharpcode">Add-Migration PersonalNotifications -ConfigurationTypeName SimpleSite.Migrations.Configuration
Update-Database -ConfigurationTypeName SimpleSite.Migrations.Identity.Configuration</pre>

<p>The first command creates a migration for us, and the second updates the database accordingly.</p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<h2 id="Updating_our_ActionFilter"><a href="#Updating_our_ActionFilter" class="headerlink" title="Updating our ActionFilter"></a>Updating our ActionFilter</h2><p>So, if notifications belong only to users, we never want our filter to execute if the current request is for an unauthenticated user. We’ll also want to make sure that we only capture notifications for the user that <em>is</em> logged in, and then, only the notifications that have not yet been seen.&nbsp; </p>
<p>Here’s the updated code for the NotificationFilter (located in \Filters):</p>
<p><pre class="csharpcode"><span class="kwrd">public</span> <span class="kwrd">override</span> <span class="kwrd">void</span> OnActionExecuted(ActionExecutedContext filterContext)<br>{<br>    <span class="kwrd">if</span> (!filterContext.HttpContext.User.Identity.IsAuthenticated) <span class="kwrd">return</span>;</pre></p>
<pre><code>var userId = filterContext.HttpContext.User.Identity.GetUserId();

var context = &lt;span class=&quot;kwrd&quot;&gt;new&lt;/span&gt; SiteDataContext();
var notifications = context.Notifications
    .Where(n =&amp;gt; n.UserId == userId)
    .Where(n =&amp;gt; !n.IsDismissed)
    .GroupBy(n =&amp;gt; n.NotificationType)
    .Select(g =&amp;gt; &lt;span class=&quot;kwrd&quot;&gt;new&lt;/span&gt; NotificationViewModel
    {
        Count = g.Count(),
        NotificationType = g.Key.ToString(),
        BadgeClass = NotificationType.Email == g.Key
            ? &lt;span class=&quot;str&quot;&gt;&quot;success&quot;&lt;/span&gt;
            : &lt;span class=&quot;str&quot;&gt;&quot;info&quot;&lt;/span&gt;
    });

filterContext.Controller.ViewBag.Notifications = notifications;
</code></pre><p>}</p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<h2 id="Scaffolding_a_Temporary_Controller_and_View"><a href="#Scaffolding_a_Temporary_Controller_and_View" class="headerlink" title="Scaffolding a Temporary Controller and View"></a>Scaffolding a Temporary Controller and View</h2><p>The MVC Framework has some great scaffolding capabilities, as we’ve explored in minor detail so far. Today we’re going to use this feature to create our whole controller and the related views for all our CRUD operations. Right-click as you normally do on the controllers folder, and click Add-&gt;Controller. </p>
<p>This time ‘round, use the Scaffold for the “MVC5 Controller with views, using Entity Framework”. Fill out the options as follows:</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image.png" alt="image" title="image"></p>
<p>You are selecting the Notification model, checking off “Generate views” and “Use a layout page”. The controller name should automatically be set to NotificationsController for you. Click Add to finish it out.</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image1.png" alt="image" title="image"></p>
<p>One more thing: you’re going to want an easy way to get your UserId – it’s what we’re using to match the notifications – so add the following to your Create view in Views\Notifications\Create.cshtml:</p>
<p><pre class="csharpcode">@<span class="kwrd">if</span> (User.Identity.IsAuthenticated)<br>{<br>    &lt;p&gt;Your User ID <span class="kwrd">is</span> &lt;b&gt;@User.Identity.GetUserId()&lt;/b&gt;&lt;/p&gt;<br>}</pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>That will output your UserId (which is a Guid) so that you can create notifications for yourself. </p>
<p>Now when you run the site, sign in and navigate to the /Notifications path. This will show you an empty list, but you’ll have a link to create some new records. Add some to the site, using your UserId, and watch the navbar light up.</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/07/image2.png" alt="image" title="image"></p>
<h2 id="Next_Steps"><a href="#Next_Steps" class="headerlink" title="Next Steps"></a>Next Steps</h2><p>Now, I did say this is a temporary solution. By no means would you actually have a situation where you’d have users enter their own notifications, you’d more likely have events happen in the system that require some notification to be required – perhaps the completion of a job or a required update to some business process.&nbsp; That’s why we just used the scaffolding today…the NotificationsController and view are something that you’ll likely eventually just delete…and that’s okay! One of the nice things about scaffolding is that you’re not married to it. So delete it when you’re done with it.</p>
<p>In the real world, however, you would likely want users to be able to see and manage notifications in some way. Tomorrow we’ll look at getting the first of those bits in place.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2014/07/day-25-personalizing-notifications-bootstrap-tables/" data-id="cit1f3snx00j41cyyn90zqxjj" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2014/07/day-25-personalizing-notifications-bootstrap-tables/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/30DaysMvcBootstrap/">30DaysMvcBootstrap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC5/">MVC5</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-day-24-storing-user-profile-information" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/day-24-storing-user-profile-information/">Day 24: Storing User Profile Information</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2014/06/day-24-storing-user-profile-information/">
      <time datetime="2014-06-30T15:42:00.000Z" itemprop="datePublished">2014-06-30</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>This is an installment in a 30 day series on Bootstrap and the MVC Framework. To see more, check out <a href="http://jameschambers.com/2014/06/day-0-boothstrapping-mvc-for-the-next-30-days/">Day 0 for an index</a>.</p>
<p>Session is an attractive and oft-used mechanism for storing user profile data. It’s freely available and has been around forever. But session state and logged-in user identity, while they may seem closely related, do not operate on the same lifecycle and sensitive data, personal data, could get “leaked out”.</p>
<p>And hey…this post assumes you’ve been following along with the series and you have already signed in at least once with a registered user.</p>
<h2 id="A_Better_Place_to_Store_User_Profile_Data"><a href="#A_Better_Place_to_Store_User_Profile_Data" class="headerlink" title="A Better Place to Store User Profile Data"></a>A Better Place to Store User Profile Data</h2><p>In <a href="http://jameschambers.com/2014/06/day-23-choosing-your-own-look-and-feel/">yesterday’s article</a> we penned in the user’s choice of Bootstrap Theme and stored their selection in the Session object. Brock Allen wrote a great post a couple years back on why this kind of thing isn’t a great approach. The things that concern us most are that:</p>
<ul>
<li>By default, session isn’t durable and doesn’t scale  </li><li>Even if we move to a more durable session management approach, there’s no persistence of session data and yet we’re making network hops  </li><li>Session isn’t tied to users signing in or out </li>
</ul>
<p>So, today, we’re going to fix that Session access with a permanent, more reliable and secure approach.</p>
<h2 id="Extending_the_User_Profile_Data"><a href="#Extending_the_User_Profile_Data" class="headerlink" title="Extending the User Profile Data"></a>Extending the User Profile Data</h2><p>Since you’ve already <a href="http://jameschambers.com/2014/06/day-22-sprucing-up-identity-for-logged-in-users/">created an account</a>, you technically have some profile information already stored in your site’s database. We’re going to leverage the identity infrastructure of our project and extend the class that keeps track of our data, adding in the user’s selected theme. In your Solution Explorer, locate the ApplicationUser class under Models. The easiest way is usually just through the search box at the top:</p>
<p><a href="https://jcblogimages.blob.core.windows.net/img/2014/06/image42.png" target="_blank" rel="external"><img src="https://jcblogimages.blob.core.windows.net/img/2014/06/image_thumb21.png" alt="image" title="image"></a></p>
<p>Add the following property to your ApplicationUser class:</p>
<p><pre class="csharpcode"><span class="kwrd">public</span> <span class="kwrd">string</span> CssTheme { get; set; }</pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>Something to keep in mind: we’re going to be modifying a class that participates in Entity Framework persistence, as managed by the Asp.Net Identity libraries. This is handy, but not free. Because we’re changing essentially the schema of a table, we’ll also need to enable and create a migration from the Package Manager Console:</p>
<p><pre class="csharpcode">Enable-Migrations -ContextTypeName SimpleSite.Models.ApplicationDbContext -MigrationsDirectory Migrations\Identity<br>Add-Migration CssTheme -ConfigurationTypeName SimpleSite.Migrations.Identity.Configuration</pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>Note that we’ve got a pre-existing migration on our site, <strong>so we need to now be more specific</strong> and explicitly name the Configuration type. Also, in enabling the migrations, I added the MigrationsDirectory folder for the DbContext, so that our identity-related migrations would be in a sub-folder. </p>
<p>The Entity Framework created the appropriate classes for me to track DbContext-specific settings and the migration that I needed to update the database, but those are just the classes, nothing’s changed in the DB yet. That all needs to be followed by an update to our database like so:</p>
<p><pre class="csharpcode">Update-Database -ConfigurationTypeName SimpleSite.Migrations.Identity.Configuration</pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>We can now store the data we need to, we just need a way to be able to stuff it in there.</p>
<h2 id="Updating_our_Controller"><a href="#Updating_our_Controller" class="headerlink" title="Updating our Controller"></a>Updating our Controller</h2><p>Since we’re now targeting a user managed from the Identity libraries we’re going to wipe out the code that writes to session and instead use the relevant classes to locate the user profile and update it. Head over to ProfileController.cs (in Helpers) and replace the call to Session with the following:</p>
<p><pre class="csharpcode">var userStore = <span class="kwrd">new</span> UserStore&lt;ApplicationUser&gt;(<span class="kwrd">new</span> ApplicationDbContext());<br>var manager = <span class="kwrd">new</span> UserManager&lt;ApplicationUser&gt;(userStore);<br>var user = manager.FindById(User.Identity.GetUserId());<br>user.CssTheme = themename;<br>manager.Update(user);</pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>We resolve the user through a UserManager, and the manager needs a UserStore to locate it’s data. We can then set the CssTheme and update the user through the manager. ApplicationUser and ApplicationDbContext are just the names of the types that were automatically created for you through the project template.</p>
<p>It’s only 5 lines of code to access and update a property, but you can see how there must be a better solution to all this than having to write this code all the time. Some day I bet a post will pop up on that…</p>
<h2 id="Updating_our_Layout"><a href="#Updating_our_Layout" class="headerlink" title="Updating our Layout"></a>Updating our Layout</h2><p>Open up _Layout.cshtml (in Shared\Views) and update the code that resolves the correct style bundle. We’re going to use a similar approach to what we did in the controller to find the user and property, and we’ll handle the null case a little differently than we were previously as well by setting the default in advance. </p>
<p><pre class="csharpcode">@{<br>    var theme = Bootstrap.Theme.Stock;<br>    <span class="kwrd">if</span> (User.Identity.IsAuthenticated)<br>    {<br>        var userStore = <span class="kwrd">new</span> UserStore&lt;ApplicationUser&gt;(<span class="kwrd">new</span> ApplicationDbContext());<br>        var manager = <span class="kwrd">new</span> UserManager&lt;ApplicationUser&gt;(userStore);<br>        var user = manager.FindById(User.Identity.GetUserId());<br>        theme = user.CssTheme ?? theme;<br>    }<br>    @Styles.Render(Bootstrap.Bundle(theme))<br>}</pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>Our other line of code – to actually render the bundle – will remain the same, as you can see at the bottom.</p>
<h2 id="Wait_2C_What_Did_We_Actually_Do_Again_3F"><a href="#Wait_2C_What_Did_We_Actually_Do_Again_3F" class="headerlink" title="Wait, What Did We Actually Do Again?"></a>Wait, What Did We Actually Do Again?</h2><p>I know, I know, it’s hard to put time into something when it seems that nothing really changed. Our functionality is identical and users still have the same options as they did before.</p>
<p><a href="https://jcblogimages.blob.core.windows.net/img/2014/06/image43.png" target="_blank" rel="external"><img src="https://jcblogimages.blob.core.windows.net/img/2014/06/image_thumb22.png" alt="image" title="image"></a></p>
<p>But technically our solution is a little more sound.&nbsp; Here’s what we did again as a bit of a recap:</p>
<ul>
<li>We added a CssTheme property to our ApplicationUser class</li>
<li>We enabled migrations on our ApplicationDbContext, using a specify folder for our identity migrations</li>
<li>We added a migration to accommodate our new CssTheme property</li>
<li>We updated our controller to use the Identity objects instead of session</li>
<li>We refactored our _Layout to get the theme of choice from the user’s profile information</li>
</ul>
<h2 id="Next_Steps"><a href="#Next_Steps" class="headerlink" title="Next Steps"></a>Next Steps</h2><p>For brownie points here, one could likely go to the “manage” bits (under Controllers\AccountController and Views\Account) and allow the user to make a theme selection from there. It’s likely a better home than continuously being available from the home page.</p>
<p>Hang on a sec, though…if we’ve got a place to store information about <em>specific</em> users now, why don’t we revisit our code that puts up those lovely notification icons in the navbar?</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2014/06/day-24-storing-user-profile-information/" data-id="cit1f3so100ja1cyytt977zwn" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2014/06/day-24-storing-user-profile-information/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/30DaysMvcBootstrap/">30DaysMvcBootstrap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC5/">MVC5</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-day-23-choosing-your-own-look-and-feel" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/day-23-choosing-your-own-look-and-feel/">Day 23: Choosing Your Own Look-And-Feel</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2014/06/day-23-choosing-your-own-look-and-feel/">
      <time datetime="2014-06-29T17:28:00.000Z" itemprop="datePublished">2014-06-29</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>This is an installment in a 30 day series on Bootstrap and the MVC Framework. To see more, check out <a href="http://jameschambers.com/2014/06/day-0-boothstrapping-mvc-for-the-next-30-days/">Day 0 for an index</a>.</p>
<p>Here’s the thing: everybody’s site is going to look the same if everybody’s site uses Bootstrap, right? Well, if we did that to users, we’d sure be missing the point as developers, and for two key reasons: 1) With the LESS and SASS source it’s easy to customize, and 2) Because it’s easy to customize, there’s already people creating all kinds of alternate themes for Bootstrap.</p>
<p>So, we aren’t headed down a slippery slope here, we just need to make a little effort to give our users some unique looking sites.&nbsp; Other posts will show you how to replace the Bootstrap theme, but this one will show you how to let your users choose from a list you’ve pre-built.</p>
<h2 id="Download_a_Free_Substitute"><a href="#Download_a_Free_Substitute" class="headerlink" title="Download a Free Substitute"></a>Download a Free Substitute</h2><p>There are some great, free alternatives located at <a href="http://bootswatch.com/" target="_blank" rel="external">Bootswatch.com</a>. So, start there and pick one or two to download, I chose Amelia and Darkly. We need to create a folder structure to organize our themes, and move the CSS into those folders. Mine ended up working like this:</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/06/image40.png" alt="image" title="image"></p>
<p>Note that I also pushed a copy of the stock CSS for bootstrap into this structure. This allows us to simplify our code for theme switching, allowing users to pick the base theme if they like.</p>
<p><strong>Shameless plug</strong>: If you’re looking for professionally designed themes to replace your palette, you can help out this blogger (me!) by purchasing one over at <a href="https://wrapbootstrap.com/?ref=BootstrapOnMvc" target="_blank" rel="external">{wrap}bootstrap</a>. They have a selection of great looking Bootstrap themes. A very affordable alternative to taking the time to create your own theme.</p>
<h2 id="Creating_a_Helper_Class"><a href="#Creating_a_Helper_Class" class="headerlink" title="Creating a Helper Class"></a>Creating a Helper Class</h2><p>Next, we create a class called Bootstrap.cs (I put mine in \Helpers) so that we can programmatically work with the themes. This class is responsible for presenting the list of supported themes and resolving the path to them when we try to load the bundles.</p>
<pre class="csharpcode"><span class="kwrd">public</span> <span class="kwrd">class</span> Bootstrap
{
    <span class="kwrd">public</span> <span class="kwrd">const</span> <span class="kwrd">string</span> BundleBase = <span class="str">"~/Content/css/"</span>;

    <span class="kwrd">public</span> <span class="kwrd">class</span> Theme
    {
        <span class="kwrd">public</span> <span class="kwrd">const</span> <span class="kwrd">string</span> Stock = <span class="str">"Stock"</span>;
        <span class="kwrd">public</span> <span class="kwrd">const</span> <span class="kwrd">string</span> Amelia = <span class="str">"Amelia"</span>;
        <span class="kwrd">public</span> <span class="kwrd">const</span> <span class="kwrd">string</span> Darkly = <span class="str">"Darkly"</span>;
    }

    <span class="kwrd">public</span> <span class="kwrd">static</span> HashSet&lt;<span class="kwrd">string</span>&gt; Themes = <span class="kwrd">new</span> HashSet&lt;<span class="kwrd">string</span>&gt;
    {
        Theme.Stock,
        Theme.Amelia,
        Theme.Darkly
    };

    <span class="kwrd">public</span> <span class="kwrd">static</span> <span class="kwrd">string</span> Bundle(<span class="kwrd">string</span> themename)
    {
        <span class="kwrd">return</span> BundleBase + themename;
    }
}</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

This is a simple class, but it prevents us from duplicating code all over the place or unnecessary spelling mistakes.

The other nice thing is that if you choose to add another theme to your project, you will just have to modify this one file and the rest will fall into place.&nbsp; For that to happen, we’ll need to modify our startup to generate all the appropriate bundles.

## Updating Our Startup Bits

Head into BundleConfig.cs (inside of \App_Startup) and replace the code that creates the Bootstrap bundle with the following:
<pre class="csharpcode"><span class="kwrd">foreach</span> (var theme <span class="kwrd">in</span> Bootstrap.Themes)
{
    var stylePath = <span class="kwrd">string</span>.Format(<span class="str">"~/Content/Themes/{0}/bootstrap.css"</span>, theme);

    bundles.Add(<span class="kwrd">new</span> StyleBundle(Bootstrap.Bundle(theme)).Include(
                stylePath,
                <span class="str">"~/Content/bootstrap.custom.css"</span>,
                <span class="str">"~/Content/site.css"</span>));
}</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

We’re simply looping over that handle collection we created so that we could generate a bundle for every installed theme.&nbsp; We always want all the themes – startup is only run at as the application starts, so we need them all there – as different users may wish to select different themes.

## Making Our Layout “Themeable”

What we really need to do here is just a quick update to figure out the user’s current theme, and then figure out what the correct bundle to use is.
<pre class="csharpcode">@{
    var theme = Session[<span class="str">"CssTheme"</span>] <span class="kwrd">as</span> <span class="kwrd">string</span> ?? Bootstrap.Theme.Stock;
}
@Styles.Render(Bootstrap.Bundle(theme))</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

I’m using Session for now, but I’ll explain why in a bit that is bad idea. ![Smile](https://jcblogimages.blob.core.windows.net/img/2014/06/wlEmoticon-smile3.png)

Note that, at this point, you could set that theme default – right now set to Bootstrap.Theme.Stock – to whichever theme you like and run your app. The mechanics of building the bundle and the class to resolve it are all in place.

## Letting the User Choose a Theme

Once again we’re going to revisit the _LoginPartial.cshtml file (in Views\Shared). In this round, we’re going to update the text that shows the logged in user’s email address (which, by default, is also their username). The LI for the username is now going to be a dropdown box in the navbar.
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">li</span> <span class="attr">class</span><span class="kwrd">="dropdown"</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">="#"</span> <span class="attr">class</span><span class="kwrd">="dropdown-toggle"</span> <span class="attr">data-toggle</span><span class="kwrd">="dropdown"</span><span class="kwrd">&gt;</span>Hello @username! <span class="kwrd">&lt;</span><span class="html">span</span> <span class="attr">class</span><span class="kwrd">="caret"</span><span class="kwrd">&gt;&lt;/</span><span class="html">span</span><span class="kwrd">&gt;&lt;/</span><span class="html">a</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">ul</span> <span class="attr">class</span><span class="kwrd">="dropdown-menu"</span> <span class="attr">role</span><span class="kwrd">="menu"</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;</span>
            @Html.ActionLink("Manage Account", "Manage", "Account", routeValues: null, htmlAttributes: new { title = "Manage" })
        <span class="kwrd">&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">li</span> <span class="attr">class</span><span class="kwrd">="divider"</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span>
        @foreach (var theme in Bootstrap.Themes)
        {
            <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">="@Url.Action("</span><span class="attr">ChangeTheme</span><span class="kwrd">", "</span><span class="attr">Profile</span><span class="kwrd">", new { themename = theme})"</span><span class="kwrd">&gt;</span>@theme<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span>
        }
    <span class="kwrd">&lt;/</span><span class="html">ul</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span>
</pre>

<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>
I’ve taken that LI that was there – all it had was the user name, which was a link to Manage Account – and replaced it will all of the above code. We put in a divider and iterate over the list of known themes.&nbsp; Each will be a link to a “ChangeTheme” action on the “Profile” controller.

## Adding our New Profile Controller

Throw ProfileController.cs in your \Controllers directory with the following, lone action in the class:
<pre class="csharpcode"><span class="kwrd">public</span> ActionResult ChangeTheme(<span class="kwrd">string</span> themename)
{
    Session[<span class="str">"CssTheme"</span>] = themename;
    <span class="kwrd">if</span> (Request.UrlReferrer != <span class="kwrd">null</span>)
    {
        var returnUrl = Request.UrlReferrer.ToString();
        <span class="kwrd">return</span> <span class="kwrd">new</span> RedirectResult(returnUrl);
    }
    <span class="kwrd">return</span> RedirectToAction(<span class="str">"Index"</span>, <span class="str">"Home"</span>);
}</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>If we have a referring URL we can push the user back to the same page, otherwise we ship them home. The preference of theme is set in the Session.</p>
<p>And there you have it: users can now pick their own theme on your site:</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/06/image41.png" alt="image" title="image"></p>
<h2 id="Next_Steps"><a href="#Next_Steps" class="headerlink" title="Next Steps"></a>Next Steps</h2><p>This data doesn’t really belong in the user’s session…whenever the app pool is recycled or the website or IIS is restarted or their session expires they will lose this choice. Even worse, session and Identity aren’t on the same lifecycle, so when they log out the session persists and they’ll still see the theme they chose when they logged in.</p>
<p>So, where should it be stored? Tune in next time as we answer this question and more. <img src="https://jcblogimages.blob.core.windows.net/img/2014/06/wlEmoticon-smilewithtongueout.png" alt="Smile with tongue out"></p>
<p>Happy coding! <img src="https://jcblogimages.blob.core.windows.net/img/2014/06/wlEmoticon-smile3.png" alt="Smile"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2014/06/day-23-choosing-your-own-look-and-feel/" data-id="cit1f3so500jg1cyynmiaald9" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2014/06/day-23-choosing-your-own-look-and-feel/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/30DaysMvcBootstrap/">30DaysMvcBootstrap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC5/">MVC5</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-day-22-sprucing-up-identity-for-logged-in-users" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/day-22-sprucing-up-identity-for-logged-in-users/">Day 22: Sprucing up Identity for Logged In Users</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2014/06/day-22-sprucing-up-identity-for-logged-in-users/">
      <time datetime="2014-06-28T08:37:00.000Z" itemprop="datePublished">2014-06-28</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Code-Dive/">Code Dive</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>This is an installment in a 30 day series on Bootstrap and the MVC Framework. To see more, check out <a href="http://jameschambers.com/2014/06/day-0-boothstrapping-mvc-for-the-next-30-days/">Day 0 for an index</a>.</p>
<p>Typically you wouldn’t want the entirety of the internet adding and editing records at will without some form of authentication and authorization so that you can keep track of who’s editing your data, or so that your users can keep track of their own.</p>
<p>So, let’s continue with our project and build out some identity capabilities.</p>
<h2 id="Okay_2C_I_u2019m_Kidding-_Just_Press_F5_21"><a href="#Okay_2C_I_u2019m_Kidding-_Just_Press_F5_21" class="headerlink" title="Okay, I’m Kidding. Just Press F5!"></a>Okay, I’m Kidding. Just Press F5!</h2><p>Great work, you’re all done!</p>
<p>As most folks are well aware, the default templates for Asp.Net applications now ship with a sample account administration implementation (reasonably good ones, at that). Users are able to register and log in using pre-built models, controllers and views. You can easily extend the template with 3rd party login capabilities, allowing folks with Microsoft, Facebook or Google accounts (and, and, and…) to log into your site as well. We’ve now got substantial improvements to identity management overall, with things like two-factor authentication, reductions in the leaky abstractions we’ve lived with, better testability, more flexibility in storage options, and more.</p>
<p>If you’re not familiar with these bits, it’s worth having a look, <strong>but this is a topic already well covered</strong>. Believe me, these are worth the reads:</p>
<ul>
<li>The Asp.Net Identity <a href="http://www.asp.net/identity" target="_blank" rel="external">web site</a></li>
<li>A <a href="http://www.asp.net/identity/overview/getting-started/introduction-to-aspnet-identity" target="_blank" rel="external">background article on Identity</a> by the Asp.Net team</li>
<li>Two-Factor <a href="http://www.asp.net/identity/overview/features-api/two-factor-authentication-using-sms-and-email-with-aspnet-identity" target="_blank" rel="external">authentication</a> with SMS</li>
<li>Using <a href="http://www.asp.net/mvc/tutorials/mvc-5/create-an-aspnet-mvc-5-app-with-facebook-and-google-oauth2-and-openid-sign-on" target="_blank" rel="external">third-party authentication providers</a> on your site (Facebook, Twitter, Google, LinkedIn) </li>
</ul>
<p>But we’re here to do Bootstrappy things, right? So let’s spruce up that top bar a little for our logged in users with some MVC bits we build (HTML helpers) and some Bootstrap bits (image classes) that will take our site up a level.</p>
<h2 id="Bootstrap_Image_Classes"><a href="#Bootstrap_Image_Classes" class="headerlink" title="Bootstrap Image Classes"></a>Bootstrap Image Classes</h2><p>The CSS library gives us a few easy-to-use helpers to make our images look consistent. Here’s a sample from the <a href="http://getbootstrap.com/css/#images" target="_blank" rel="external">Bootstrap site</a>:</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/06/image38.png" alt="image" title="image"></p>
<p>The classes are as follows:</p>
<ul>
<li>img-rounded – provides rounded corners to your rectangular images</li>
<li>img-circle – turns any image into a circle</li>
<li>img-thumbnail – makes your image look like a little Polaroid of itself </li>
</ul>
<h2 id="Making_Members_Feel_Welcome"><a href="#Making_Members_Feel_Welcome" class="headerlink" title="Making Members Feel Welcome"></a>Making Members Feel Welcome</h2><p>Today we’re just going to add a little touch to the navbar that our logged in users will see, keying in off of the default implementation of the Identity providers.&nbsp; We’ll head in that direction by extending our HtmlHelper that generates Gravatar images, as we need to add a property for a CSS class to give us a nice round face on the page.&nbsp; But first, we’ll have to add the following line of code to the GravatarOptions class:</p>
<pre class="csharpcode"><span class="kwrd">public</span> <span class="kwrd">string</span> CssClass { get; set; }</pre>

<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>
We’ll need to add that to the tag, so let’s revist the GravatarImage, likely located in the Helpers folder, to check for a value and add it to the tag if present. The full method should now look like this:
<pre class="csharpcode"><span class="kwrd">public</span> <span class="kwrd">static</span> HtmlString GravatarImage(<span class="kwrd">this</span> HtmlHelper htmlHelper, <span class="kwrd">string</span> emailAddress, GravatarOptions options = <span class="kwrd">null</span>)
{
    <span class="kwrd">if</span> (options == <span class="kwrd">null</span>)
        options = GravatarOptions.GetDefaults();

    var imgTag = <span class="kwrd">new</span> TagBuilder(<span class="str">"img"</span>);

    emailAddress = <span class="kwrd">string</span>.IsNullOrEmpty(emailAddress) ? <span class="kwrd">string</span>.Empty : emailAddress.Trim().ToLower();

    <span class="rem">// &lt;-- adding support for CSS</span>
    <span class="kwrd">if</span> (!<span class="kwrd">string</span>.IsNullOrEmpty(options.CssClass))
    {
        imgTag.AddCssClass(options.CssClass);
    }
    <span class="rem">// adding support for CSS  --&gt;</span>

    imgTag.Attributes.Add(<span class="str">"src"</span>,
        <span class="kwrd">string</span>.Format(<span class="str">"http://www.gravatar.com/avatar/{0}?s={1}{2}{3}"</span>,
            GetMd5Hash(emailAddress),
            options.Size,
            <span class="str">"&amp;d="</span> + options.DefaultImageType,
            <span class="str">"&amp;r="</span> + options.RatingLevel
            )
        );

    <span class="kwrd">return</span> <span class="kwrd">new</span> HtmlString(imgTag.ToString(TagRenderMode.SelfClosing));
}</pre>

Unfortunately there isn’t quite the exact Bootstrap class we need to make our image place and size well in the navbar, so we’ll need to open up our bootstrap.custom.css file and add the following structural class:
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p><pre class="csharpcode">.navbar-image {<br>  float: left;<br>  padding: 10px 5px;<br>}</pre></p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>Finally, we’ll pop over to our _LoginPartial.cshtml (in Views\Shared) and modify the block of code displayed for logged in users.&nbsp; Because I’m reusing the user’s name a couple of times (which is also their email address) I’m storing it in a variable first, and using that throughout the block. I also add a DIV as a container for our image, using the class that we just created. Last, I make a call to our GravatarImage helper, passing in the username (email!), an appropriate size for the toolbar (30px), and the Bootstrap class that gives us the shape we’re looking for (img-circle).</p>
<p><pre class="csharpcode">var username = User.Identity.GetUserName();<br>using (Html.BeginForm(“LogOff”, “Account”, FormMethod.Post, new { id = “logoutForm”, @class = “navbar-right” }))<br>{</pre></p>
<p>@Html.AntiForgeryToken()</p>
<p><span class="kwrd">&lt;</span><span class="html">div</span> <span class="attr">class</span><span class="kwrd">=”navbar-image”</span><span class="kwrd">&gt;</span><br>    @Html.GravatarImage(username, new GravatarOptions { Size = 30, CssClass = “img-circle” })<br><span class="kwrd">&lt;/</span><span class="html">div</span><span class="kwrd">&gt;</span></p>
<p><span class="kwrd">&lt;</span><span class="html">ul</span> <span class="attr">class</span><span class="kwrd">=”nav navbar-nav navbar-right”</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;</span><br>        @Html.ActionLink(“Hello “ + username + “!”, “Manage”, “Account”, routeValues: null, htmlAttributes: new { title = “Manage” })<br>    <span class="kwrd">&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br>    <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">=”javascript:document.getElementById(‘logoutForm’).submit()”</span><span class="kwrd">&gt;</span>Log off<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span><br><span class="kwrd">&lt;/</span><span class="html">ul</span><span class="kwrd">&gt;</span><br>}</p>
<style type="text/css">.csharpcode, .csharpcode pre
{
    font-size: small;
    color: black;
    font-family: consolas, "Courier New", courier, monospace;
    background-color: #ffffff;
    /*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
    background-color: #f4f4f4;
    width: 100%;
    margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>And now we’re rockin’ head shots in our navbar!</p>
<p><img src="https://jcblogimages.blob.core.windows.net/img/2014/06/image39.png" alt="image" title="image"></p>
<h2 id="Next_Steps"><a href="#Next_Steps" class="headerlink" title="Next Steps"></a>Next Steps</h2><p>Perhaps you’ve modified your user profiles so that the username doesn’t have to be an email address. You could easily modify this example to read from a different property and generate the same type of effect.</p>
<p>What is sparkle without shine? Let’s give our users the ability to choose their own look-and-feel.&nbsp; I mean, it worked for GeoCities, right?</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jameschambers.com/2014/06/day-22-sprucing-up-identity-for-logged-in-users/" data-id="cit1f3so900jm1cyygv10433o" class="article-share-link">Share</a>
      
        <a href="http://jameschambers.com/2014/06/day-22-sprucing-up-identity-for-logged-in-users/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/30DaysMvcBootstrap/">30DaysMvcBootstrap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC/">MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVC5/">MVC5</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/page/9/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/31/">31</a><a class="extend next" rel="next" href="/page/11/">Next &raquo;</a>
      </nav>
    </section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">recent</h3>
    <div class="widget">
      <ul id="recent-post" class="no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/09/Bending-ASP-NET-MVC-Core-To-Your-Will/" class="title">Bending ASP.NET Core MVC To Your Will</a></p>
              <p class="item-date"><time datetime="2016-09-09T17:46:34.000Z" itemprop="datePublished">2016-09-09</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/04/github-authentication-asp-net-core/" class="title">GitHub Authentication with ASP.NET Core</a></p>
              <p class="item-date"><time datetime="2016-04-26T12:12:54.000Z" itemprop="datePublished">2016-04-26</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/03/If-You-Want-to-Get-Into-OSS-Consider-This-Project/" class="title">If You Want to Get Into OSS, Consider This Project</a></p>
              <p class="item-date"><time datetime="2016-03-13T00:24:44.000Z" itemprop="datePublished">2016-03-12</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/03/these-people-are-monsters/" class="title">These People are Monsters! Here&#39;s Some Great Videos Covering ASP.NET Core and Core MVC</a></p>
              <p class="item-date"><time datetime="2016-03-11T02:48:38.000Z" itemprop="datePublished">2016-03-10</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-title"><a href="/2016/02/building-your-project-should-be-pretty-quick/" class="title">Tips for Speeding Up Visual Studio</a></p>
              <p class="item-date"><time datetime="2016-02-12T04:12:54.000Z" itemprop="datePublished">2016-02-11</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Buy me a coffee?</h3>
    <div class="widget">
        <a href="https://www.paypal.me/jameschambers/3.5usd" target="_blank"><img src="/content/coffee.png"></a>
    </div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">tag cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/30DaysMvcBootstrap/" style="font-size: 17.86px;">30DaysMvcBootstrap</a> <a href="/tags/8DaysOfTableStorage/" style="font-size: 11.43px;">8DaysOfTableStorage</a> <a href="/tags/ASP-NET/" style="font-size: 15px;">ASP.NET</a> <a href="/tags/ASP-NET-5/" style="font-size: 10.71px;">ASP.NET 5</a> <a href="/tags/ASP-NET-Core/" style="font-size: 12.86px;">ASP.NET Core</a> <a href="/tags/ASP-NET-Core-MVC/" style="font-size: 10px;">ASP.NET Core MVC</a> <a href="/tags/ActionFilters/" style="font-size: 10px;">ActionFilters</a> <a href="/tags/AllReady/" style="font-size: 10px;">AllReady</a> <a href="/tags/Android/" style="font-size: 10.71px;">Android</a> <a href="/tags/AngelaSmith/" style="font-size: 10px;">AngelaSmith</a> <a href="/tags/Asp-Net-MVC/" style="font-size: 20px;">Asp.Net MVC</a> <a href="/tags/Authentication/" style="font-size: 10.71px;">Authentication</a> <a href="/tags/Azure/" style="font-size: 17.14px;">Azure</a> <a href="/tags/Azure-Web-Apps/" style="font-size: 10px;">Azure Web Apps</a> <a href="/tags/Azure-Websites/" style="font-size: 13.57px;">Azure Websites</a> <a href="/tags/BUILD/" style="font-size: 10px;">BUILD</a> <a href="/tags/BitBucket/" style="font-size: 10px;">BitBucket</a> <a href="/tags/Bootstrap/" style="font-size: 15.71px;">Bootstrap</a> <a href="/tags/CTT-NUG/" style="font-size: 10px;">CTT .NUG</a> <a href="/tags/Calgary/" style="font-size: 10px;">Calgary</a> <a href="/tags/Cisco-VPN/" style="font-size: 10px;">Cisco VPN</a> <a href="/tags/ClearMeasure/" style="font-size: 10.71px;">ClearMeasure</a> <a href="/tags/CodeProject/" style="font-size: 11.43px;">CodeProject</a> <a href="/tags/Conferences/" style="font-size: 10.71px;">Conferences</a> <a href="/tags/CouchDb/" style="font-size: 10px;">CouchDb</a> <a href="/tags/DNX/" style="font-size: 10px;">DNX</a> <a href="/tags/Dojo/" style="font-size: 10px;">Dojo</a> <a href="/tags/Email/" style="font-size: 10px;">Email</a> <a href="/tags/Entity-Framework/" style="font-size: 13.57px;">Entity Framework</a> <a href="/tags/Extension-Methods/" style="font-size: 10px;">Extension Methods</a> <a href="/tags/FontAwesome/" style="font-size: 10.71px;">FontAwesome</a> <a href="/tags/GenFu/" style="font-size: 10px;">GenFu</a> <a href="/tags/GetManifestResourceStream/" style="font-size: 10px;">GetManifestResourceStream</a> <a href="/tags/Git/" style="font-size: 11.43px;">Git</a> <a href="/tags/HTML5/" style="font-size: 10px;">HTML5</a> <a href="/tags/HackAThon/" style="font-size: 10px;">HackAThon</a> <a href="/tags/HtmlHelper/" style="font-size: 10px;">HtmlHelper</a> <a href="/tags/IIS/" style="font-size: 10px;">IIS</a> <a href="/tags/JSON/" style="font-size: 10.71px;">JSON</a> <a href="/tags/Keynote/" style="font-size: 10px;">Keynote</a> <a href="/tags/Life-Hack/" style="font-size: 10px;">Life Hack</a> <a href="/tags/Life-Hacking/" style="font-size: 10.71px;">Life Hacking</a> <a href="/tags/Life-Hacks/" style="font-size: 12.86px;">Life Hacks</a> <a href="/tags/Linq/" style="font-size: 10px;">Linq</a> <a href="/tags/MIX11/" style="font-size: 10px;">MIX11</a> <a href="/tags/MVA/" style="font-size: 10.71px;">MVA</a> <a href="/tags/MVC/" style="font-size: 19.29px;">MVC</a> <a href="/tags/MVC5/" style="font-size: 18.57px;">MVC5</a> <a href="/tags/MVC6/" style="font-size: 13.57px;">MVC6</a> <a href="/tags/MVP/" style="font-size: 10px;">MVP</a> <a href="/tags/Make-Code-Not-War/" style="font-size: 10px;">Make Code Not War</a> <a href="/tags/MeasureUp/" style="font-size: 10px;">MeasureUp</a> <a href="/tags/Metro/" style="font-size: 10px;">Metro</a> <a href="/tags/Microsoft/" style="font-size: 10px;">Microsoft</a> <a href="/tags/Microsoft-Band/" style="font-size: 12.14px;">Microsoft Band</a> <a href="/tags/Mobile/" style="font-size: 10px;">Mobile</a> <a href="/tags/Mobile-Services/" style="font-size: 10px;">Mobile Services</a> <a href="/tags/Motivate/" style="font-size: 10px;">Motivate</a> <a href="/tags/MvcScaffolding/" style="font-size: 11.43px;">MvcScaffolding</a> <a href="/tags/Not-Coding-At-All/" style="font-size: 10px;">Not Coding At All</a> <a href="/tags/NuGet/" style="font-size: 15px;">NuGet</a> <a href="/tags/OData/" style="font-size: 10px;">OData</a> <a href="/tags/PayPal/" style="font-size: 10px;">PayPal</a> <a href="/tags/PostSharp/" style="font-size: 10px;">PostSharp</a> <a href="/tags/Practice/" style="font-size: 10.71px;">Practice</a> <a href="/tags/Practice-of-Awesome/" style="font-size: 10px;">Practice of Awesome</a> <a href="/tags/PrairieDevCon/" style="font-size: 16.43px;">PrairieDevCon</a> <a href="/tags/Queues/" style="font-size: 10px;">Queues</a> <a href="/tags/REST/" style="font-size: 10px;">REST</a> <a href="/tags/Radio/" style="font-size: 10px;">Radio</a> <a href="/tags/Razor/" style="font-size: 10.71px;">Razor</a> <a href="/tags/Real-Life/" style="font-size: 10px;">Real Life</a> <a href="/tags/Regina/" style="font-size: 10.71px;">Regina</a> <a href="/tags/Remote-Work/" style="font-size: 11.43px;">Remote Work</a> <a href="/tags/Resolve/" style="font-size: 10px;">Resolve</a> <a href="/tags/Rock-Paper-Scissors/" style="font-size: 10px;">Rock Paper Scissors</a> <a href="/tags/Routing/" style="font-size: 10px;">Routing</a> <a href="/tags/Ruby-on-Rails/" style="font-size: 10px;">Ruby on Rails</a> <a href="/tags/SDEC/" style="font-size: 10px;">SDEC</a> <a href="/tags/SOAP/" style="font-size: 10px;">SOAP</a> <a href="/tags/SQL-Server/" style="font-size: 10px;">SQL Server</a> <a href="/tags/ServiceBus/" style="font-size: 10px;">ServiceBus</a> <a href="/tags/SignalR/" style="font-size: 11.43px;">SignalR</a> <a href="/tags/Speaking/" style="font-size: 11.43px;">Speaking</a> <a href="/tags/TFS/" style="font-size: 10px;">TFS</a> <a href="/tags/Table-Storage/" style="font-size: 10.71px;">Table Storage</a> <a href="/tags/TypeScript/" style="font-size: 10px;">TypeScript</a> <a href="/tags/Unit-Testing/" style="font-size: 10px;">Unit Testing</a> <a href="/tags/Visual-Studio/" style="font-size: 10.71px;">Visual Studio</a> <a href="/tags/Visual-Studio-11/" style="font-size: 11.43px;">Visual Studio 11</a> <a href="/tags/Visual-Studio-2010/" style="font-size: 16.43px;">Visual Studio 2010</a> <a href="/tags/Visual-Studio-2012/" style="font-size: 12.86px;">Visual Studio 2012</a> <a href="/tags/Visual-Studio-2013/" style="font-size: 10.71px;">Visual Studio 2013</a> <a href="/tags/Visual-Studio-2015/" style="font-size: 15.71px;">Visual Studio 2015</a> <a href="/tags/WCF/" style="font-size: 10.71px;">WCF</a> <a href="/tags/Web-API/" style="font-size: 11.43px;">Web API</a> <a href="/tags/Web-Development/" style="font-size: 10px;">Web Development</a> <a href="/tags/Web-Services/" style="font-size: 10.71px;">Web Services</a> <a href="/tags/Windows-8/" style="font-size: 11.43px;">Windows 8</a> <a href="/tags/Windows-Azure/" style="font-size: 10px;">Windows Azure</a> <a href="/tags/Windows-Phone/" style="font-size: 14.29px;">Windows Phone</a> <a href="/tags/Windws-Live-Writer/" style="font-size: 10px;">Windws Live Writer</a> <a href="/tags/Winnipeg/" style="font-size: 10.71px;">Winnipeg</a> <a href="/tags/c/" style="font-size: 11.43px;">c#</a> <a href="/tags/compiling/" style="font-size: 10px;">compiling</a> <a href="/tags/jQuery/" style="font-size: 12.14px;">jQuery</a> <a href="/tags/jQuery-UI/" style="font-size: 10.71px;">jQuery UI</a> <a href="/tags/node/" style="font-size: 10px;">node</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/open-source/" style="font-size: 10.71px;">open source</a> <a href="/tags/reflection/" style="font-size: 10px;">reflection</a> <a href="/tags/seed-data/" style="font-size: 10px;">seed data</a> <a href="/tags/testing/" style="font-size: 10px;">testing</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/">2016</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/">2015</a><span class="archive-list-count">36</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/">2014</a><span class="archive-list-count">42</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/">2013</a><span class="archive-list-count">17</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/">2012</a><span class="archive-list-count">41</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/">2011</a><span class="archive-list-count">36</span></li></ul>
    </div>
  </div>

  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 1999 - 2016 James Chambers<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script>
  var disqus_shortname = 'jameschambers';
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



 <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>




  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>